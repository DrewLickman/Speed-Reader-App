var nk=Object.defineProperty;var b1=g=>{throw TypeError(g)};var sk=(g,t,e)=>t in g?nk(g,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):g[t]=e;var K=(g,t,e)=>sk(g,typeof t!="symbol"?t+"":t,e),Vv=(g,t,e)=>t.has(g)||b1("Cannot "+e);var o=(g,t,e)=>(Vv(g,t,"read from private field"),e?e.call(g):t.get(g)),b=(g,t,e)=>t.has(g)?b1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,e),w=(g,t,e,n)=>(Vv(g,t,"write to private field"),n?n.call(g,e):t.set(g,e),e),x=(g,t,e)=>(Vv(g,t,"access private method"),e);var fn=(g,t,e,n)=>({set _(r){w(g,t,r,e)},get _(){return o(g,t,n)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function lx(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var Gv={exports:{}},Yd={},Xv={exports:{}},Xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1;function ik(){if(x1)return Xt;x1=1;var g=Symbol.for("react.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.iterator;function v(O){return O===null||typeof O!="object"?null:(O=y&&O[y]||O["@@iterator"],typeof O=="function"?O:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,E={};function k(O,H,lt){this.props=O,this.context=H,this.refs=E,this.updater=lt||S}k.prototype.isReactComponent={},k.prototype.setState=function(O,H){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,H,"setState")},k.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function T(){}T.prototype=k.prototype;function L(O,H,lt){this.props=O,this.context=H,this.refs=E,this.updater=lt||S}var P=L.prototype=new T;P.constructor=L,C(P,k.prototype),P.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,I={current:null},U={key:!0,ref:!0,__self:!0,__source:!0};function $(O,H,lt){var Tt,bt={},Mt=null,Pt=null;if(H!=null)for(Tt in H.ref!==void 0&&(Pt=H.ref),H.key!==void 0&&(Mt=""+H.key),H)D.call(H,Tt)&&!U.hasOwnProperty(Tt)&&(bt[Tt]=H[Tt]);var Et=arguments.length-2;if(Et===1)bt.children=lt;else if(1<Et){for(var ae=Array(Et),We=0;We<Et;We++)ae[We]=arguments[We+2];bt.children=ae}if(O&&O.defaultProps)for(Tt in Et=O.defaultProps,Et)bt[Tt]===void 0&&(bt[Tt]=Et[Tt]);return{$$typeof:g,type:O,key:Mt,ref:Pt,props:bt,_owner:I.current}}function G(O,H){return{$$typeof:g,type:O.type,key:H,ref:O.ref,props:O.props,_owner:O._owner}}function nt(O){return typeof O=="object"&&O!==null&&O.$$typeof===g}function et(O){var H={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(lt){return H[lt]})}var Ct=/\/+/g;function _t(O,H){return typeof O=="object"&&O!==null&&O.key!=null?et(""+O.key):H.toString(36)}function wt(O,H,lt,Tt,bt){var Mt=typeof O;(Mt==="undefined"||Mt==="boolean")&&(O=null);var Pt=!1;if(O===null)Pt=!0;else switch(Mt){case"string":case"number":Pt=!0;break;case"object":switch(O.$$typeof){case g:case t:Pt=!0}}if(Pt)return Pt=O,bt=bt(Pt),O=Tt===""?"."+_t(Pt,0):Tt,M(bt)?(lt="",O!=null&&(lt=O.replace(Ct,"$&/")+"/"),wt(bt,H,lt,"",function(We){return We})):bt!=null&&(nt(bt)&&(bt=G(bt,lt+(!bt.key||Pt&&Pt.key===bt.key?"":(""+bt.key).replace(Ct,"$&/")+"/")+O)),H.push(bt)),1;if(Pt=0,Tt=Tt===""?".":Tt+":",M(O))for(var Et=0;Et<O.length;Et++){Mt=O[Et];var ae=Tt+_t(Mt,Et);Pt+=wt(Mt,H,lt,ae,bt)}else if(ae=v(O),typeof ae=="function")for(O=ae.call(O),Et=0;!(Mt=O.next()).done;)Mt=Mt.value,ae=Tt+_t(Mt,Et++),Pt+=wt(Mt,H,lt,ae,bt);else if(Mt==="object")throw H=String(O),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Pt}function kt(O,H,lt){if(O==null)return O;var Tt=[],bt=0;return wt(O,Tt,"","",function(Mt){return H.call(lt,Mt,bt++)}),Tt}function ot(O){if(O._status===-1){var H=O._result;H=H(),H.then(function(lt){(O._status===0||O._status===-1)&&(O._status=1,O._result=lt)},function(lt){(O._status===0||O._status===-1)&&(O._status=2,O._result=lt)}),O._status===-1&&(O._status=0,O._result=H)}if(O._status===1)return O._result.default;throw O._result}var st={current:null},V={transition:null},dt={ReactCurrentDispatcher:st,ReactCurrentBatchConfig:V,ReactCurrentOwner:I};function Z(){throw Error("act(...) is not supported in production builds of React.")}return Xt.Children={map:kt,forEach:function(O,H,lt){kt(O,function(){H.apply(this,arguments)},lt)},count:function(O){var H=0;return kt(O,function(){H++}),H},toArray:function(O){return kt(O,function(H){return H})||[]},only:function(O){if(!nt(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Xt.Component=k,Xt.Fragment=e,Xt.Profiler=r,Xt.PureComponent=L,Xt.StrictMode=n,Xt.Suspense=h,Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dt,Xt.act=Z,Xt.cloneElement=function(O,H,lt){if(O==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+O+".");var Tt=C({},O.props),bt=O.key,Mt=O.ref,Pt=O._owner;if(H!=null){if(H.ref!==void 0&&(Mt=H.ref,Pt=I.current),H.key!==void 0&&(bt=""+H.key),O.type&&O.type.defaultProps)var Et=O.type.defaultProps;for(ae in H)D.call(H,ae)&&!U.hasOwnProperty(ae)&&(Tt[ae]=H[ae]===void 0&&Et!==void 0?Et[ae]:H[ae])}var ae=arguments.length-2;if(ae===1)Tt.children=lt;else if(1<ae){Et=Array(ae);for(var We=0;We<ae;We++)Et[We]=arguments[We+2];Tt.children=Et}return{$$typeof:g,type:O.type,key:bt,ref:Mt,props:Tt,_owner:Pt}},Xt.createContext=function(O){return O={$$typeof:l,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},O.Provider={$$typeof:a,_context:O},O.Consumer=O},Xt.createElement=$,Xt.createFactory=function(O){var H=$.bind(null,O);return H.type=O,H},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(O){return{$$typeof:u,render:O}},Xt.isValidElement=nt,Xt.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:ot}},Xt.memo=function(O,H){return{$$typeof:f,type:O,compare:H===void 0?null:H}},Xt.startTransition=function(O){var H=V.transition;V.transition={};try{O()}finally{V.transition=H}},Xt.unstable_act=Z,Xt.useCallback=function(O,H){return st.current.useCallback(O,H)},Xt.useContext=function(O){return st.current.useContext(O)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(O){return st.current.useDeferredValue(O)},Xt.useEffect=function(O,H){return st.current.useEffect(O,H)},Xt.useId=function(){return st.current.useId()},Xt.useImperativeHandle=function(O,H,lt){return st.current.useImperativeHandle(O,H,lt)},Xt.useInsertionEffect=function(O,H){return st.current.useInsertionEffect(O,H)},Xt.useLayoutEffect=function(O,H){return st.current.useLayoutEffect(O,H)},Xt.useMemo=function(O,H){return st.current.useMemo(O,H)},Xt.useReducer=function(O,H,lt){return st.current.useReducer(O,H,lt)},Xt.useRef=function(O){return st.current.useRef(O)},Xt.useState=function(O){return st.current.useState(O)},Xt.useSyncExternalStore=function(O,H,lt){return st.current.useSyncExternalStore(O,H,lt)},Xt.useTransition=function(){return st.current.useTransition()},Xt.version="18.3.1",Xt}var E1;function OA(){return E1||(E1=1,Xv.exports=ik()),Xv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C1;function rk(){if(C1)return Yd;C1=1;var g=OA(),t=Symbol.for("react.element"),e=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,h,f){var p,y={},v=null,S=null;f!==void 0&&(v=""+f),h.key!==void 0&&(v=""+h.key),h.ref!==void 0&&(S=h.ref);for(p in h)n.call(h,p)&&!a.hasOwnProperty(p)&&(y[p]=h[p]);if(u&&u.defaultProps)for(p in h=u.defaultProps,h)y[p]===void 0&&(y[p]=h[p]);return{$$typeof:t,type:u,key:v,ref:S,props:y,_owner:r.current}}return Yd.Fragment=e,Yd.jsx=l,Yd.jsxs=l,Yd}var _1;function ok(){return _1||(_1=1,Gv.exports=rk()),Gv.exports}var tt=ok(),Jt=OA();const ak=lx(Jt);var Dm={},qv={exports:{}},Ss={},Yv={exports:{}},Kv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k1;function lk(){return k1||(k1=1,(function(g){function t(V,dt){var Z=V.length;V.push(dt);t:for(;0<Z;){var O=Z-1>>>1,H=V[O];if(0<r(H,dt))V[O]=dt,V[Z]=H,Z=O;else break t}}function e(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var dt=V[0],Z=V.pop();if(Z!==dt){V[0]=Z;t:for(var O=0,H=V.length,lt=H>>>1;O<lt;){var Tt=2*(O+1)-1,bt=V[Tt],Mt=Tt+1,Pt=V[Mt];if(0>r(bt,Z))Mt<H&&0>r(Pt,bt)?(V[O]=Pt,V[Mt]=Z,O=Mt):(V[O]=bt,V[Tt]=Z,O=Tt);else if(Mt<H&&0>r(Pt,Z))V[O]=Pt,V[Mt]=Z,O=Mt;else break t}}return dt}function r(V,dt){var Z=V.sortIndex-dt.sortIndex;return Z!==0?Z:V.id-dt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;g.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();g.unstable_now=function(){return l.now()-u}}var h=[],f=[],p=1,y=null,v=3,S=!1,C=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(V){for(var dt=e(f);dt!==null;){if(dt.callback===null)n(f);else if(dt.startTime<=V)n(f),dt.sortIndex=dt.expirationTime,t(h,dt);else break;dt=e(f)}}function M(V){if(E=!1,P(V),!C)if(e(h)!==null)C=!0,ot(D);else{var dt=e(f);dt!==null&&st(M,dt.startTime-V)}}function D(V,dt){C=!1,E&&(E=!1,T($),$=-1),S=!0;var Z=v;try{for(P(dt),y=e(h);y!==null&&(!(y.expirationTime>dt)||V&&!et());){var O=y.callback;if(typeof O=="function"){y.callback=null,v=y.priorityLevel;var H=O(y.expirationTime<=dt);dt=g.unstable_now(),typeof H=="function"?y.callback=H:y===e(h)&&n(h),P(dt)}else n(h);y=e(h)}if(y!==null)var lt=!0;else{var Tt=e(f);Tt!==null&&st(M,Tt.startTime-dt),lt=!1}return lt}finally{y=null,v=Z,S=!1}}var I=!1,U=null,$=-1,G=5,nt=-1;function et(){return!(g.unstable_now()-nt<G)}function Ct(){if(U!==null){var V=g.unstable_now();nt=V;var dt=!0;try{dt=U(!0,V)}finally{dt?_t():(I=!1,U=null)}}else I=!1}var _t;if(typeof L=="function")_t=function(){L(Ct)};else if(typeof MessageChannel<"u"){var wt=new MessageChannel,kt=wt.port2;wt.port1.onmessage=Ct,_t=function(){kt.postMessage(null)}}else _t=function(){k(Ct,0)};function ot(V){U=V,I||(I=!0,_t())}function st(V,dt){$=k(function(){V(g.unstable_now())},dt)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(V){V.callback=null},g.unstable_continueExecution=function(){C||S||(C=!0,ot(D))},g.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<V?Math.floor(1e3/V):5},g.unstable_getCurrentPriorityLevel=function(){return v},g.unstable_getFirstCallbackNode=function(){return e(h)},g.unstable_next=function(V){switch(v){case 1:case 2:case 3:var dt=3;break;default:dt=v}var Z=v;v=dt;try{return V()}finally{v=Z}},g.unstable_pauseExecution=function(){},g.unstable_requestPaint=function(){},g.unstable_runWithPriority=function(V,dt){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Z=v;v=V;try{return dt()}finally{v=Z}},g.unstable_scheduleCallback=function(V,dt,Z){var O=g.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?O+Z:O):Z=O,V){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Z+H,V={id:p++,callback:dt,priorityLevel:V,startTime:Z,expirationTime:H,sortIndex:-1},Z>O?(V.sortIndex=Z,t(f,V),e(h)===null&&V===e(f)&&(E?(T($),$=-1):E=!0,st(M,Z-O))):(V.sortIndex=H,t(h,V),C||S||(C=!0,ot(D))),V},g.unstable_shouldYield=et,g.unstable_wrapCallback=function(V){var dt=v;return function(){var Z=v;v=dt;try{return V.apply(this,arguments)}finally{v=Z}}}})(Kv)),Kv}var T1;function ck(){return T1||(T1=1,Yv.exports=lk()),Yv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P1;function uk(){if(P1)return Ss;P1=1;var g=OA(),t=ck();function e(s){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)i+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,r={};function a(s,i){l(s,i),l(s+"Capture",i)}function l(s,i){for(r[s]=i,s=0;s<i.length;s++)n.add(i[s])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},y={};function v(s){return h.call(y,s)?!0:h.call(p,s)?!1:f.test(s)?y[s]=!0:(p[s]=!0,!1)}function S(s,i,c,d){if(c!==null&&c.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return d?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function C(s,i,c,d){if(i===null||typeof i>"u"||S(s,i,c,d))return!0;if(d)return!1;if(c!==null)switch(c.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function E(s,i,c,d,m,A,_){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=c,this.propertyName=s,this.type=i,this.sanitizeURL=A,this.removeEmptyString=_}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new E(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var i=s[0];k[i]=new E(i,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new E(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new E(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new E(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new E(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new E(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new E(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new E(s,5,!1,s.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function L(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var i=s.replace(T,L);k[i]=new E(i,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var i=s.replace(T,L);k[i]=new E(i,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var i=s.replace(T,L);k[i]=new E(i,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new E(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new E("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new E(s,1,!1,s.toLowerCase(),null,!0,!0)});function P(s,i,c,d){var m=k.hasOwnProperty(i)?k[i]:null;(m!==null?m.type!==0:d||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(C(i,c,m,d)&&(c=null),d||m===null?v(i)&&(c===null?s.removeAttribute(i):s.setAttribute(i,""+c)):m.mustUseProperty?s[m.propertyName]=c===null?m.type===3?!1:"":c:(i=m.attributeName,d=m.attributeNamespace,c===null?s.removeAttribute(i):(m=m.type,c=m===3||m===4&&c===!0?"":""+c,d?s.setAttributeNS(d,i,c):s.setAttribute(i,c))))}var M=g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),I=Symbol.for("react.portal"),U=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),G=Symbol.for("react.profiler"),nt=Symbol.for("react.provider"),et=Symbol.for("react.context"),Ct=Symbol.for("react.forward_ref"),_t=Symbol.for("react.suspense"),wt=Symbol.for("react.suspense_list"),kt=Symbol.for("react.memo"),ot=Symbol.for("react.lazy"),st=Symbol.for("react.offscreen"),V=Symbol.iterator;function dt(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var Z=Object.assign,O;function H(s){if(O===void 0)try{throw Error()}catch(c){var i=c.stack.trim().match(/\n( *(at )?)/);O=i&&i[1]||""}return`
`+O+s}var lt=!1;function Tt(s,i){if(!s||lt)return"";lt=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(j){var d=j}Reflect.construct(s,[],i)}else{try{i.call()}catch(j){d=j}s.call(i.prototype)}else{try{throw Error()}catch(j){d=j}s()}}catch(j){if(j&&d&&typeof j.stack=="string"){for(var m=j.stack.split(`
`),A=d.stack.split(`
`),_=m.length-1,R=A.length-1;1<=_&&0<=R&&m[_]!==A[R];)R--;for(;1<=_&&0<=R;_--,R--)if(m[_]!==A[R]){if(_!==1||R!==1)do if(_--,R--,0>R||m[_]!==A[R]){var N=`
`+m[_].replace(" at new "," at ");return s.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",s.displayName)),N}while(1<=_&&0<=R);break}}}finally{lt=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?H(s):""}function bt(s){switch(s.tag){case 5:return H(s.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return s=Tt(s.type,!1),s;case 11:return s=Tt(s.type.render,!1),s;case 1:return s=Tt(s.type,!0),s;default:return""}}function Mt(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case U:return"Fragment";case I:return"Portal";case G:return"Profiler";case $:return"StrictMode";case _t:return"Suspense";case wt:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case et:return(s.displayName||"Context")+".Consumer";case nt:return(s._context.displayName||"Context")+".Provider";case Ct:var i=s.render;return s=s.displayName,s||(s=i.displayName||i.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case kt:return i=s.displayName||null,i!==null?i:Mt(s.type)||"Memo";case ot:i=s._payload,s=s._init;try{return Mt(s(i))}catch{}}return null}function Pt(s){var i=s.type;switch(s.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=i.render,s=s.displayName||s.name||"",i.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mt(i);case 8:return i===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Et(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ae(s){var i=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function We(s){var i=ae(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,i),d=""+s[i];if(!s.hasOwnProperty(i)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,A=c.set;return Object.defineProperty(s,i,{configurable:!0,get:function(){return m.call(this)},set:function(_){d=""+_,A.call(this,_)}}),Object.defineProperty(s,i,{enumerable:c.enumerable}),{getValue:function(){return d},setValue:function(_){d=""+_},stopTracking:function(){s._valueTracker=null,delete s[i]}}}}function es(s){s._valueTracker||(s._valueTracker=We(s))}function Li(s){if(!s)return!1;var i=s._valueTracker;if(!i)return!0;var c=i.getValue(),d="";return s&&(d=ae(s)?s.checked?"true":"false":s.value),s=d,s!==c?(i.setValue(s),!0):!1}function Ir(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Bo(s,i){var c=i.checked;return Z({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function Ls(s,i){var c=i.defaultValue==null?"":i.defaultValue,d=i.checked!=null?i.checked:i.defaultChecked;c=Et(i.value!=null?i.value:c),s._wrapperState={initialChecked:d,initialValue:c,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function rd(s,i){i=i.checked,i!=null&&P(s,"checked",i,!1)}function Uo(s,i){rd(s,i);var c=Et(i.value),d=i.type;if(c!=null)d==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(d==="submit"||d==="reset"){s.removeAttribute("value");return}i.hasOwnProperty("value")?Fr(s,i.type,c):i.hasOwnProperty("defaultValue")&&Fr(s,i.type,Et(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(s.defaultChecked=!!i.defaultChecked)}function zo(s,i,c){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var d=i.type;if(!(d!=="submit"&&d!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+s._wrapperState.initialValue,c||i===s.value||(s.value=i),s.defaultValue=i}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function Fr(s,i,c){(i!=="number"||Ir(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var Ms=Array.isArray;function jo(s,i,c,d){if(s=s.options,i){i={};for(var m=0;m<c.length;m++)i["$"+c[m]]=!0;for(c=0;c<s.length;c++)m=i.hasOwnProperty("$"+s[c].value),s[c].selected!==m&&(s[c].selected=m),m&&d&&(s[c].defaultSelected=!0)}else{for(c=""+Et(c),i=null,m=0;m<s.length;m++){if(s[m].value===c){s[m].selected=!0,d&&(s[m].defaultSelected=!0);return}i!==null||s[m].disabled||(i=s[m])}i!==null&&(i.selected=!0)}}function od(s,i){if(i.dangerouslySetInnerHTML!=null)throw Error(e(91));return Z({},i,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Cg(s,i){var c=i.value;if(c==null){if(c=i.children,i=i.defaultValue,c!=null){if(i!=null)throw Error(e(92));if(Ms(c)){if(1<c.length)throw Error(e(93));c=c[0]}i=c}i==null&&(i=""),c=i}s._wrapperState={initialValue:Et(c)}}function ad(s,i){var c=Et(i.value),d=Et(i.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),i.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),d!=null&&(s.defaultValue=""+d)}function ld(s){var i=s.textContent;i===s._wrapperState.initialValue&&i!==""&&i!==null&&(s.value=i)}function _g(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function cd(s,i){return s==null||s==="http://www.w3.org/1999/xhtml"?_g(i):s==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Mi,ud=(function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,c,d,m){MSApp.execUnsafeLocalFunction(function(){return s(i,c,d,m)})}:s})(function(s,i){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=i;else{for(Mi=Mi||document.createElement("div"),Mi.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=Mi.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;i.firstChild;)s.appendChild(i.firstChild)}});function Ho(s,i){if(i){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=i;return}}s.textContent=i}var il={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kg=["Webkit","ms","Moz","O"];Object.keys(il).forEach(function(s){kg.forEach(function(i){i=i+s.charAt(0).toUpperCase()+s.substring(1),il[i]=il[s]})});function hd(s,i,c){return i==null||typeof i=="boolean"||i===""?"":c||typeof i!="number"||i===0||il.hasOwnProperty(s)&&il[s]?(""+i).trim():i+"px"}function Tg(s,i){s=s.style;for(var c in i)if(i.hasOwnProperty(c)){var d=c.indexOf("--")===0,m=hd(c,i[c],d);c==="float"&&(c="cssFloat"),d?s.setProperty(c,m):s[c]=m}}var c0=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Y(s,i){if(i){if(c0[s]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(e(137,s));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(e(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(e(61))}if(i.style!=null&&typeof i.style!="object")throw Error(e(62))}}function W(s,i){if(s.indexOf("-")===-1)return typeof i.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gt=null;function Nt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Vt=null,xt=null,Gt=null;function Ce(s){if(s=Nd(s)){if(typeof Vt!="function")throw Error(e(280));var i=s.stateNode;i&&(i=qg(i),Vt(s.stateNode,s.type,i))}}function _e(s){xt?Gt?Gt.push(s):Gt=[s]:xt=s}function se(){if(xt){var s=xt,i=Gt;if(Gt=xt=null,Ce(s),i)for(s=0;s<i.length;s++)Ce(i[s])}}function At(s,i){return s(i)}function Ft(){}var Yt=!1;function Ot(s,i,c){if(Yt)return s(i,c);Yt=!0;try{return At(s,i,c)}finally{Yt=!1,(xt!==null||Gt!==null)&&(Ft(),se())}}function le(s,i){var c=s.stateNode;if(c===null)return null;var d=qg(c);if(d===null)return null;c=d[i];t:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break t;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(e(231,i,typeof c));return c}var Ln=!1;if(u)try{var ps={};Object.defineProperty(ps,"passive",{get:function(){Ln=!0}}),window.addEventListener("test",ps,ps),window.removeEventListener("test",ps,ps)}catch{Ln=!1}function Ds(s,i,c,d,m,A,_,R,N){var j=Array.prototype.slice.call(arguments,3);try{i.apply(c,j)}catch(q){this.onError(q)}}var gs=!1,Gc=null,rl=!1,ol=null,$n={onError:function(s){gs=!0,Gc=s}};function u0(s,i,c,d,m,A,_,R,N){gs=!1,Gc=null,Ds.apply($n,arguments)}function h0(s,i,c,d,m,A,_,R,N){if(u0.apply(this,arguments),gs){if(gs){var j=Gc;gs=!1,Gc=null}else throw Error(e(198));rl||(rl=!0,ol=j)}}function he(s){var i=s,c=s;if(s.alternate)for(;i.return;)i=i.return;else{s=i;do i=s,(i.flags&4098)!==0&&(c=i.return),s=i.return;while(s)}return i.tag===3?c:null}function $o(s){if(s.tag===13){var i=s.memoizedState;if(i===null&&(s=s.alternate,s!==null&&(i=s.memoizedState)),i!==null)return i.dehydrated}return null}function Xc(s){if(he(s)!==s)throw Error(e(188))}function nr(s){var i=s.alternate;if(!i){if(i=he(s),i===null)throw Error(e(188));return i!==s?null:s}for(var c=s,d=i;;){var m=c.return;if(m===null)break;var A=m.alternate;if(A===null){if(d=m.return,d!==null){c=d;continue}break}if(m.child===A.child){for(A=m.child;A;){if(A===c)return Xc(m),s;if(A===d)return Xc(m),i;A=A.sibling}throw Error(e(188))}if(c.return!==d.return)c=m,d=A;else{for(var _=!1,R=m.child;R;){if(R===c){_=!0,c=m,d=A;break}if(R===d){_=!0,d=m,c=A;break}R=R.sibling}if(!_){for(R=A.child;R;){if(R===c){_=!0,c=A,d=m;break}if(R===d){_=!0,d=A,c=m;break}R=R.sibling}if(!_)throw Error(e(189))}}if(c.alternate!==d)throw Error(e(190))}if(c.tag!==3)throw Error(e(188));return c.stateNode.current===c?s:i}function dd(s){return s=nr(s),s!==null?Di(s):null}function Di(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var i=Di(s);if(i!==null)return i;s=s.sibling}return null}var fd=t.unstable_scheduleCallback,pd=t.unstable_cancelCallback,ns=t.unstable_shouldYield,qc=t.unstable_requestPaint,Ne=t.unstable_now,Or=t.unstable_getCurrentPriorityLevel,al=t.unstable_ImmediatePriority,gd=t.unstable_UserBlockingPriority,it=t.unstable_NormalPriority,ut=t.unstable_LowPriority,ie=t.unstable_IdlePriority,Ze=null,Je=null;function rn(s){if(Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(Ze,s,void 0,(s.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:AC,An=Math.log,Pg=Math.LN2;function AC(s){return s>>>=0,s===0?32:31-(An(s)/Pg|0)|0}var Rg=64,Lg=4194304;function md(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Mg(s,i){var c=s.pendingLanes;if(c===0)return 0;var d=0,m=s.suspendedLanes,A=s.pingedLanes,_=c&268435455;if(_!==0){var R=_&~m;R!==0?d=md(R):(A&=_,A!==0&&(d=md(A)))}else _=c&~m,_!==0?d=md(_):A!==0&&(d=md(A));if(d===0)return 0;if(i!==0&&i!==d&&(i&m)===0&&(m=d&-d,A=i&-i,m>=A||m===16&&(A&4194240)!==0))return i;if((d&4)!==0&&(d|=c&16),i=s.entangledLanes,i!==0)for(s=s.entanglements,i&=d;0<i;)c=31-tn(i),m=1<<c,d|=s[c],i&=~m;return d}function SC(s,i){switch(s){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bC(s,i){for(var c=s.suspendedLanes,d=s.pingedLanes,m=s.expirationTimes,A=s.pendingLanes;0<A;){var _=31-tn(A),R=1<<_,N=m[_];N===-1?((R&c)===0||(R&d)!==0)&&(m[_]=SC(R,i)):N<=i&&(s.expiredLanes|=R),A&=~R}}function d0(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function JA(){var s=Rg;return Rg<<=1,(Rg&4194240)===0&&(Rg=64),s}function f0(s){for(var i=[],c=0;31>c;c++)i.push(s);return i}function yd(s,i,c){s.pendingLanes|=i,i!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,i=31-tn(i),s[i]=c}function xC(s,i){var c=s.pendingLanes&~i;s.pendingLanes=i,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=i,s.mutableReadLanes&=i,s.entangledLanes&=i,i=s.entanglements;var d=s.eventTimes;for(s=s.expirationTimes;0<c;){var m=31-tn(c),A=1<<m;i[m]=0,d[m]=-1,s[m]=-1,c&=~A}}function p0(s,i){var c=s.entangledLanes|=i;for(s=s.entanglements;c;){var d=31-tn(c),m=1<<d;m&i|s[d]&i&&(s[d]|=i),c&=~m}}var de=0;function tS(s){return s&=-s,1<s?4<s?(s&268435455)!==0?16:536870912:4:1}var eS,g0,nS,sS,iS,m0=!1,Dg=[],Wo=null,Vo=null,Go=null,vd=new Map,wd=new Map,Xo=[],EC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function rS(s,i){switch(s){case"focusin":case"focusout":Wo=null;break;case"dragenter":case"dragleave":Vo=null;break;case"mouseover":case"mouseout":Go=null;break;case"pointerover":case"pointerout":vd.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":wd.delete(i.pointerId)}}function Ad(s,i,c,d,m,A){return s===null||s.nativeEvent!==A?(s={blockedOn:i,domEventName:c,eventSystemFlags:d,nativeEvent:A,targetContainers:[m]},i!==null&&(i=Nd(i),i!==null&&g0(i)),s):(s.eventSystemFlags|=d,i=s.targetContainers,m!==null&&i.indexOf(m)===-1&&i.push(m),s)}function CC(s,i,c,d,m){switch(i){case"focusin":return Wo=Ad(Wo,s,i,c,d,m),!0;case"dragenter":return Vo=Ad(Vo,s,i,c,d,m),!0;case"mouseover":return Go=Ad(Go,s,i,c,d,m),!0;case"pointerover":var A=m.pointerId;return vd.set(A,Ad(vd.get(A)||null,s,i,c,d,m)),!0;case"gotpointercapture":return A=m.pointerId,wd.set(A,Ad(wd.get(A)||null,s,i,c,d,m)),!0}return!1}function oS(s){var i=ll(s.target);if(i!==null){var c=he(i);if(c!==null){if(i=c.tag,i===13){if(i=$o(c),i!==null){s.blockedOn=i,iS(s.priority,function(){nS(c)});return}}else if(i===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ng(s){if(s.blockedOn!==null)return!1;for(var i=s.targetContainers;0<i.length;){var c=v0(s.domEventName,s.eventSystemFlags,i[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var d=new c.constructor(c.type,c);gt=d,c.target.dispatchEvent(d),gt=null}else return i=Nd(c),i!==null&&g0(i),s.blockedOn=c,!1;i.shift()}return!0}function aS(s,i,c){Ng(s)&&c.delete(i)}function _C(){m0=!1,Wo!==null&&Ng(Wo)&&(Wo=null),Vo!==null&&Ng(Vo)&&(Vo=null),Go!==null&&Ng(Go)&&(Go=null),vd.forEach(aS),wd.forEach(aS)}function Sd(s,i){s.blockedOn===i&&(s.blockedOn=null,m0||(m0=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,_C)))}function bd(s){function i(m){return Sd(m,s)}if(0<Dg.length){Sd(Dg[0],s);for(var c=1;c<Dg.length;c++){var d=Dg[c];d.blockedOn===s&&(d.blockedOn=null)}}for(Wo!==null&&Sd(Wo,s),Vo!==null&&Sd(Vo,s),Go!==null&&Sd(Go,s),vd.forEach(i),wd.forEach(i),c=0;c<Xo.length;c++)d=Xo[c],d.blockedOn===s&&(d.blockedOn=null);for(;0<Xo.length&&(c=Xo[0],c.blockedOn===null);)oS(c),c.blockedOn===null&&Xo.shift()}var Yc=M.ReactCurrentBatchConfig,Ig=!0;function kC(s,i,c,d){var m=de,A=Yc.transition;Yc.transition=null;try{de=1,y0(s,i,c,d)}finally{de=m,Yc.transition=A}}function TC(s,i,c,d){var m=de,A=Yc.transition;Yc.transition=null;try{de=4,y0(s,i,c,d)}finally{de=m,Yc.transition=A}}function y0(s,i,c,d){if(Ig){var m=v0(s,i,c,d);if(m===null)I0(s,i,d,Fg,c),rS(s,d);else if(CC(m,s,i,c,d))d.stopPropagation();else if(rS(s,d),i&4&&-1<EC.indexOf(s)){for(;m!==null;){var A=Nd(m);if(A!==null&&eS(A),A=v0(s,i,c,d),A===null&&I0(s,i,d,Fg,c),A===m)break;m=A}m!==null&&d.stopPropagation()}else I0(s,i,d,null,c)}}var Fg=null;function v0(s,i,c,d){if(Fg=null,s=Nt(d),s=ll(s),s!==null)if(i=he(s),i===null)s=null;else if(c=i.tag,c===13){if(s=$o(i),s!==null)return s;s=null}else if(c===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;s=null}else i!==s&&(s=null);return Fg=s,null}function lS(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Or()){case al:return 1;case gd:return 4;case it:case ut:return 16;case ie:return 536870912;default:return 16}default:return 16}}var qo=null,w0=null,Og=null;function cS(){if(Og)return Og;var s,i=w0,c=i.length,d,m="value"in qo?qo.value:qo.textContent,A=m.length;for(s=0;s<c&&i[s]===m[s];s++);var _=c-s;for(d=1;d<=_&&i[c-d]===m[A-d];d++);return Og=m.slice(s,1<d?1-d:void 0)}function Bg(s){var i=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&i===13&&(s=13)):s=i,s===10&&(s=13),32<=s||s===13?s:0}function Ug(){return!0}function uS(){return!1}function Ns(s){function i(c,d,m,A,_){this._reactName=c,this._targetInst=m,this.type=d,this.nativeEvent=A,this.target=_,this.currentTarget=null;for(var R in s)s.hasOwnProperty(R)&&(c=s[R],this[R]=c?c(A):A[R]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Ug:uS,this.isPropagationStopped=uS,this}return Z(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=Ug)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=Ug)},persist:function(){},isPersistent:Ug}),i}var Kc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},A0=Ns(Kc),xd=Z({},Kc,{view:0,detail:0}),PC=Ns(xd),S0,b0,Ed,zg=Z({},xd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:E0,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Ed&&(Ed&&s.type==="mousemove"?(S0=s.screenX-Ed.screenX,b0=s.screenY-Ed.screenY):b0=S0=0,Ed=s),S0)},movementY:function(s){return"movementY"in s?s.movementY:b0}}),hS=Ns(zg),RC=Z({},zg,{dataTransfer:0}),LC=Ns(RC),MC=Z({},xd,{relatedTarget:0}),x0=Ns(MC),DC=Z({},Kc,{animationName:0,elapsedTime:0,pseudoElement:0}),NC=Ns(DC),IC=Z({},Kc,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),FC=Ns(IC),OC=Z({},Kc,{data:0}),dS=Ns(OC),BC={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jC(s){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(s):(s=zC[s])?!!i[s]:!1}function E0(){return jC}var HC=Z({},xd,{key:function(s){if(s.key){var i=BC[s.key]||s.key;if(i!=="Unidentified")return i}return s.type==="keypress"?(s=Bg(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?UC[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:E0,charCode:function(s){return s.type==="keypress"?Bg(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Bg(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),$C=Ns(HC),WC=Z({},zg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fS=Ns(WC),VC=Z({},xd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:E0}),GC=Ns(VC),XC=Z({},Kc,{propertyName:0,elapsedTime:0,pseudoElement:0}),qC=Ns(XC),YC=Z({},zg,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),KC=Ns(YC),QC=[9,13,27,32],C0=u&&"CompositionEvent"in window,Cd=null;u&&"documentMode"in document&&(Cd=document.documentMode);var ZC=u&&"TextEvent"in window&&!Cd,pS=u&&(!C0||Cd&&8<Cd&&11>=Cd),gS=" ",mS=!1;function yS(s,i){switch(s){case"keyup":return QC.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vS(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Qc=!1;function JC(s,i){switch(s){case"compositionend":return vS(i);case"keypress":return i.which!==32?null:(mS=!0,gS);case"textInput":return s=i.data,s===gS&&mS?null:s;default:return null}}function t_(s,i){if(Qc)return s==="compositionend"||!C0&&yS(s,i)?(s=cS(),Og=w0=qo=null,Qc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return pS&&i.locale!=="ko"?null:i.data;default:return null}}var e_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wS(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i==="input"?!!e_[s.type]:i==="textarea"}function AS(s,i,c,d){_e(d),i=Vg(i,"onChange"),0<i.length&&(c=new A0("onChange","change",null,c,d),s.push({event:c,listeners:i}))}var _d=null,kd=null;function n_(s){BS(s,0)}function jg(s){var i=nu(s);if(Li(i))return s}function s_(s,i){if(s==="change")return i}var SS=!1;if(u){var _0;if(u){var k0="oninput"in document;if(!k0){var bS=document.createElement("div");bS.setAttribute("oninput","return;"),k0=typeof bS.oninput=="function"}_0=k0}else _0=!1;SS=_0&&(!document.documentMode||9<document.documentMode)}function xS(){_d&&(_d.detachEvent("onpropertychange",ES),kd=_d=null)}function ES(s){if(s.propertyName==="value"&&jg(kd)){var i=[];AS(i,kd,s,Nt(s)),Ot(n_,i)}}function i_(s,i,c){s==="focusin"?(xS(),_d=i,kd=c,_d.attachEvent("onpropertychange",ES)):s==="focusout"&&xS()}function r_(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return jg(kd)}function o_(s,i){if(s==="click")return jg(i)}function a_(s,i){if(s==="input"||s==="change")return jg(i)}function l_(s,i){return s===i&&(s!==0||1/s===1/i)||s!==s&&i!==i}var Ni=typeof Object.is=="function"?Object.is:l_;function Td(s,i){if(Ni(s,i))return!0;if(typeof s!="object"||s===null||typeof i!="object"||i===null)return!1;var c=Object.keys(s),d=Object.keys(i);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var m=c[d];if(!h.call(i,m)||!Ni(s[m],i[m]))return!1}return!0}function CS(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function _S(s,i){var c=CS(s);s=0;for(var d;c;){if(c.nodeType===3){if(d=s+c.textContent.length,s<=i&&d>=i)return{node:c,offset:i-s};s=d}t:{for(;c;){if(c.nextSibling){c=c.nextSibling;break t}c=c.parentNode}c=void 0}c=CS(c)}}function kS(s,i){return s&&i?s===i?!0:s&&s.nodeType===3?!1:i&&i.nodeType===3?kS(s,i.parentNode):"contains"in s?s.contains(i):s.compareDocumentPosition?!!(s.compareDocumentPosition(i)&16):!1:!1}function TS(){for(var s=window,i=Ir();i instanceof s.HTMLIFrameElement;){try{var c=typeof i.contentWindow.location.href=="string"}catch{c=!1}if(c)s=i.contentWindow;else break;i=Ir(s.document)}return i}function T0(s){var i=s&&s.nodeName&&s.nodeName.toLowerCase();return i&&(i==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||i==="textarea"||s.contentEditable==="true")}function c_(s){var i=TS(),c=s.focusedElem,d=s.selectionRange;if(i!==c&&c&&c.ownerDocument&&kS(c.ownerDocument.documentElement,c)){if(d!==null&&T0(c)){if(i=d.start,s=d.end,s===void 0&&(s=i),"selectionStart"in c)c.selectionStart=i,c.selectionEnd=Math.min(s,c.value.length);else if(s=(i=c.ownerDocument||document)&&i.defaultView||window,s.getSelection){s=s.getSelection();var m=c.textContent.length,A=Math.min(d.start,m);d=d.end===void 0?A:Math.min(d.end,m),!s.extend&&A>d&&(m=d,d=A,A=m),m=_S(c,A);var _=_S(c,d);m&&_&&(s.rangeCount!==1||s.anchorNode!==m.node||s.anchorOffset!==m.offset||s.focusNode!==_.node||s.focusOffset!==_.offset)&&(i=i.createRange(),i.setStart(m.node,m.offset),s.removeAllRanges(),A>d?(s.addRange(i),s.extend(_.node,_.offset)):(i.setEnd(_.node,_.offset),s.addRange(i)))}}for(i=[],s=c;s=s.parentNode;)s.nodeType===1&&i.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<i.length;c++)s=i[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var u_=u&&"documentMode"in document&&11>=document.documentMode,Zc=null,P0=null,Pd=null,R0=!1;function PS(s,i,c){var d=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;R0||Zc==null||Zc!==Ir(d)||(d=Zc,"selectionStart"in d&&T0(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Pd&&Td(Pd,d)||(Pd=d,d=Vg(P0,"onSelect"),0<d.length&&(i=new A0("onSelect","select",null,i,c),s.push({event:i,listeners:d}),i.target=Zc)))}function Hg(s,i){var c={};return c[s.toLowerCase()]=i.toLowerCase(),c["Webkit"+s]="webkit"+i,c["Moz"+s]="moz"+i,c}var Jc={animationend:Hg("Animation","AnimationEnd"),animationiteration:Hg("Animation","AnimationIteration"),animationstart:Hg("Animation","AnimationStart"),transitionend:Hg("Transition","TransitionEnd")},L0={},RS={};u&&(RS=document.createElement("div").style,"AnimationEvent"in window||(delete Jc.animationend.animation,delete Jc.animationiteration.animation,delete Jc.animationstart.animation),"TransitionEvent"in window||delete Jc.transitionend.transition);function $g(s){if(L0[s])return L0[s];if(!Jc[s])return s;var i=Jc[s],c;for(c in i)if(i.hasOwnProperty(c)&&c in RS)return L0[s]=i[c];return s}var LS=$g("animationend"),MS=$g("animationiteration"),DS=$g("animationstart"),NS=$g("transitionend"),IS=new Map,FS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yo(s,i){IS.set(s,i),a(i,[s])}for(var M0=0;M0<FS.length;M0++){var D0=FS[M0],h_=D0.toLowerCase(),d_=D0[0].toUpperCase()+D0.slice(1);Yo(h_,"on"+d_)}Yo(LS,"onAnimationEnd"),Yo(MS,"onAnimationIteration"),Yo(DS,"onAnimationStart"),Yo("dblclick","onDoubleClick"),Yo("focusin","onFocus"),Yo("focusout","onBlur"),Yo(NS,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rd));function OS(s,i,c){var d=s.type||"unknown-event";s.currentTarget=c,h0(d,i,void 0,s),s.currentTarget=null}function BS(s,i){i=(i&4)!==0;for(var c=0;c<s.length;c++){var d=s[c],m=d.event;d=d.listeners;t:{var A=void 0;if(i)for(var _=d.length-1;0<=_;_--){var R=d[_],N=R.instance,j=R.currentTarget;if(R=R.listener,N!==A&&m.isPropagationStopped())break t;OS(m,R,j),A=N}else for(_=0;_<d.length;_++){if(R=d[_],N=R.instance,j=R.currentTarget,R=R.listener,N!==A&&m.isPropagationStopped())break t;OS(m,R,j),A=N}}}if(rl)throw s=ol,rl=!1,ol=null,s}function Le(s,i){var c=i[j0];c===void 0&&(c=i[j0]=new Set);var d=s+"__bubble";c.has(d)||(US(i,s,2,!1),c.add(d))}function N0(s,i,c){var d=0;i&&(d|=4),US(c,s,d,i)}var Wg="_reactListening"+Math.random().toString(36).slice(2);function Ld(s){if(!s[Wg]){s[Wg]=!0,n.forEach(function(c){c!=="selectionchange"&&(f_.has(c)||N0(c,!1,s),N0(c,!0,s))});var i=s.nodeType===9?s:s.ownerDocument;i===null||i[Wg]||(i[Wg]=!0,N0("selectionchange",!1,i))}}function US(s,i,c,d){switch(lS(i)){case 1:var m=kC;break;case 4:m=TC;break;default:m=y0}c=m.bind(null,i,c,s),m=void 0,!Ln||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(m=!0),d?m!==void 0?s.addEventListener(i,c,{capture:!0,passive:m}):s.addEventListener(i,c,!0):m!==void 0?s.addEventListener(i,c,{passive:m}):s.addEventListener(i,c,!1)}function I0(s,i,c,d,m){var A=d;if((i&1)===0&&(i&2)===0&&d!==null)t:for(;;){if(d===null)return;var _=d.tag;if(_===3||_===4){var R=d.stateNode.containerInfo;if(R===m||R.nodeType===8&&R.parentNode===m)break;if(_===4)for(_=d.return;_!==null;){var N=_.tag;if((N===3||N===4)&&(N=_.stateNode.containerInfo,N===m||N.nodeType===8&&N.parentNode===m))return;_=_.return}for(;R!==null;){if(_=ll(R),_===null)return;if(N=_.tag,N===5||N===6){d=A=_;continue t}R=R.parentNode}}d=d.return}Ot(function(){var j=A,q=Nt(c),Q=[];t:{var X=IS.get(s);if(X!==void 0){var ct=A0,mt=s;switch(s){case"keypress":if(Bg(c)===0)break t;case"keydown":case"keyup":ct=$C;break;case"focusin":mt="focus",ct=x0;break;case"focusout":mt="blur",ct=x0;break;case"beforeblur":case"afterblur":ct=x0;break;case"click":if(c.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ct=hS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ct=LC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ct=GC;break;case LS:case MS:case DS:ct=NC;break;case NS:ct=qC;break;case"scroll":ct=PC;break;case"wheel":ct=KC;break;case"copy":case"cut":case"paste":ct=FC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ct=fS}var yt=(i&4)!==0,en=!yt&&s==="scroll",B=yt?X!==null?X+"Capture":null:X;yt=[];for(var F=j,z;F!==null;){z=F;var J=z.stateNode;if(z.tag===5&&J!==null&&(z=J,B!==null&&(J=le(F,B),J!=null&&yt.push(Md(F,J,z)))),en)break;F=F.return}0<yt.length&&(X=new ct(X,mt,null,c,q),Q.push({event:X,listeners:yt}))}}if((i&7)===0){t:{if(X=s==="mouseover"||s==="pointerover",ct=s==="mouseout"||s==="pointerout",X&&c!==gt&&(mt=c.relatedTarget||c.fromElement)&&(ll(mt)||mt[Br]))break t;if((ct||X)&&(X=q.window===q?q:(X=q.ownerDocument)?X.defaultView||X.parentWindow:window,ct?(mt=c.relatedTarget||c.toElement,ct=j,mt=mt?ll(mt):null,mt!==null&&(en=he(mt),mt!==en||mt.tag!==5&&mt.tag!==6)&&(mt=null)):(ct=null,mt=j),ct!==mt)){if(yt=hS,J="onMouseLeave",B="onMouseEnter",F="mouse",(s==="pointerout"||s==="pointerover")&&(yt=fS,J="onPointerLeave",B="onPointerEnter",F="pointer"),en=ct==null?X:nu(ct),z=mt==null?X:nu(mt),X=new yt(J,F+"leave",ct,c,q),X.target=en,X.relatedTarget=z,J=null,ll(q)===j&&(yt=new yt(B,F+"enter",mt,c,q),yt.target=z,yt.relatedTarget=en,J=yt),en=J,ct&&mt)e:{for(yt=ct,B=mt,F=0,z=yt;z;z=tu(z))F++;for(z=0,J=B;J;J=tu(J))z++;for(;0<F-z;)yt=tu(yt),F--;for(;0<z-F;)B=tu(B),z--;for(;F--;){if(yt===B||B!==null&&yt===B.alternate)break e;yt=tu(yt),B=tu(B)}yt=null}else yt=null;ct!==null&&zS(Q,X,ct,yt,!1),mt!==null&&en!==null&&zS(Q,en,mt,yt,!0)}}t:{if(X=j?nu(j):window,ct=X.nodeName&&X.nodeName.toLowerCase(),ct==="select"||ct==="input"&&X.type==="file")var St=s_;else if(wS(X))if(SS)St=a_;else{St=r_;var Rt=i_}else(ct=X.nodeName)&&ct.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(St=o_);if(St&&(St=St(s,j))){AS(Q,St,c,q);break t}Rt&&Rt(s,X,j),s==="focusout"&&(Rt=X._wrapperState)&&Rt.controlled&&X.type==="number"&&Fr(X,"number",X.value)}switch(Rt=j?nu(j):window,s){case"focusin":(wS(Rt)||Rt.contentEditable==="true")&&(Zc=Rt,P0=j,Pd=null);break;case"focusout":Pd=P0=Zc=null;break;case"mousedown":R0=!0;break;case"contextmenu":case"mouseup":case"dragend":R0=!1,PS(Q,c,q);break;case"selectionchange":if(u_)break;case"keydown":case"keyup":PS(Q,c,q)}var Lt;if(C0)t:{switch(s){case"compositionstart":var It="onCompositionStart";break t;case"compositionend":It="onCompositionEnd";break t;case"compositionupdate":It="onCompositionUpdate";break t}It=void 0}else Qc?yS(s,c)&&(It="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(It="onCompositionStart");It&&(pS&&c.locale!=="ko"&&(Qc||It!=="onCompositionStart"?It==="onCompositionEnd"&&Qc&&(Lt=cS()):(qo=q,w0="value"in qo?qo.value:qo.textContent,Qc=!0)),Rt=Vg(j,It),0<Rt.length&&(It=new dS(It,s,null,c,q),Q.push({event:It,listeners:Rt}),Lt?It.data=Lt:(Lt=vS(c),Lt!==null&&(It.data=Lt)))),(Lt=ZC?JC(s,c):t_(s,c))&&(j=Vg(j,"onBeforeInput"),0<j.length&&(q=new dS("onBeforeInput","beforeinput",null,c,q),Q.push({event:q,listeners:j}),q.data=Lt))}BS(Q,i)})}function Md(s,i,c){return{instance:s,listener:i,currentTarget:c}}function Vg(s,i){for(var c=i+"Capture",d=[];s!==null;){var m=s,A=m.stateNode;m.tag===5&&A!==null&&(m=A,A=le(s,c),A!=null&&d.unshift(Md(s,A,m)),A=le(s,i),A!=null&&d.push(Md(s,A,m))),s=s.return}return d}function tu(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function zS(s,i,c,d,m){for(var A=i._reactName,_=[];c!==null&&c!==d;){var R=c,N=R.alternate,j=R.stateNode;if(N!==null&&N===d)break;R.tag===5&&j!==null&&(R=j,m?(N=le(c,A),N!=null&&_.unshift(Md(c,N,R))):m||(N=le(c,A),N!=null&&_.push(Md(c,N,R)))),c=c.return}_.length!==0&&s.push({event:i,listeners:_})}var p_=/\r\n?/g,g_=/\u0000|\uFFFD/g;function jS(s){return(typeof s=="string"?s:""+s).replace(p_,`
`).replace(g_,"")}function Gg(s,i,c){if(i=jS(i),jS(s)!==i&&c)throw Error(e(425))}function Xg(){}var F0=null,O0=null;function B0(s,i){return s==="textarea"||s==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var U0=typeof setTimeout=="function"?setTimeout:void 0,m_=typeof clearTimeout=="function"?clearTimeout:void 0,HS=typeof Promise=="function"?Promise:void 0,y_=typeof queueMicrotask=="function"?queueMicrotask:typeof HS<"u"?function(s){return HS.resolve(null).then(s).catch(v_)}:U0;function v_(s){setTimeout(function(){throw s})}function z0(s,i){var c=i,d=0;do{var m=c.nextSibling;if(s.removeChild(c),m&&m.nodeType===8)if(c=m.data,c==="/$"){if(d===0){s.removeChild(m),bd(i);return}d--}else c!=="$"&&c!=="$?"&&c!=="$!"||d++;c=m}while(c);bd(i)}function Ko(s){for(;s!=null;s=s.nextSibling){var i=s.nodeType;if(i===1||i===3)break;if(i===8){if(i=s.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return s}function $S(s){s=s.previousSibling;for(var i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(i===0)return s;i--}else c==="/$"&&i++}s=s.previousSibling}return null}var eu=Math.random().toString(36).slice(2),sr="__reactFiber$"+eu,Dd="__reactProps$"+eu,Br="__reactContainer$"+eu,j0="__reactEvents$"+eu,w_="__reactListeners$"+eu,A_="__reactHandles$"+eu;function ll(s){var i=s[sr];if(i)return i;for(var c=s.parentNode;c;){if(i=c[Br]||c[sr]){if(c=i.alternate,i.child!==null||c!==null&&c.child!==null)for(s=$S(s);s!==null;){if(c=s[sr])return c;s=$S(s)}return i}s=c,c=s.parentNode}return null}function Nd(s){return s=s[sr]||s[Br],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function nu(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(e(33))}function qg(s){return s[Dd]||null}var H0=[],su=-1;function Qo(s){return{current:s}}function Me(s){0>su||(s.current=H0[su],H0[su]=null,su--)}function ke(s,i){su++,H0[su]=s.current,s.current=i}var Zo={},Wn=Qo(Zo),ms=Qo(!1),cl=Zo;function iu(s,i){var c=s.type.contextTypes;if(!c)return Zo;var d=s.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===i)return d.__reactInternalMemoizedMaskedChildContext;var m={},A;for(A in c)m[A]=i[A];return d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=i,s.__reactInternalMemoizedMaskedChildContext=m),m}function ys(s){return s=s.childContextTypes,s!=null}function Yg(){Me(ms),Me(Wn)}function WS(s,i,c){if(Wn.current!==Zo)throw Error(e(168));ke(Wn,i),ke(ms,c)}function VS(s,i,c){var d=s.stateNode;if(i=i.childContextTypes,typeof d.getChildContext!="function")return c;d=d.getChildContext();for(var m in d)if(!(m in i))throw Error(e(108,Pt(s)||"Unknown",m));return Z({},c,d)}function Kg(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Zo,cl=Wn.current,ke(Wn,s),ke(ms,ms.current),!0}function GS(s,i,c){var d=s.stateNode;if(!d)throw Error(e(169));c?(s=VS(s,i,cl),d.__reactInternalMemoizedMergedChildContext=s,Me(ms),Me(Wn),ke(Wn,s)):Me(ms),ke(ms,c)}var Ur=null,Qg=!1,$0=!1;function XS(s){Ur===null?Ur=[s]:Ur.push(s)}function S_(s){Qg=!0,XS(s)}function Jo(){if(!$0&&Ur!==null){$0=!0;var s=0,i=de;try{var c=Ur;for(de=1;s<c.length;s++){var d=c[s];do d=d(!0);while(d!==null)}Ur=null,Qg=!1}catch(m){throw Ur!==null&&(Ur=Ur.slice(s+1)),fd(al,Jo),m}finally{de=i,$0=!1}}return null}var ru=[],ou=0,Zg=null,Jg=0,li=[],ci=0,ul=null,zr=1,jr="";function hl(s,i){ru[ou++]=Jg,ru[ou++]=Zg,Zg=s,Jg=i}function qS(s,i,c){li[ci++]=zr,li[ci++]=jr,li[ci++]=ul,ul=s;var d=zr;s=jr;var m=32-tn(d)-1;d&=~(1<<m),c+=1;var A=32-tn(i)+m;if(30<A){var _=m-m%5;A=(d&(1<<_)-1).toString(32),d>>=_,m-=_,zr=1<<32-tn(i)+m|c<<m|d,jr=A+s}else zr=1<<A|c<<m|d,jr=s}function W0(s){s.return!==null&&(hl(s,1),qS(s,1,0))}function V0(s){for(;s===Zg;)Zg=ru[--ou],ru[ou]=null,Jg=ru[--ou],ru[ou]=null;for(;s===ul;)ul=li[--ci],li[ci]=null,jr=li[--ci],li[ci]=null,zr=li[--ci],li[ci]=null}var Is=null,Fs=null,Ie=!1,Ii=null;function YS(s,i){var c=fi(5,null,null,0);c.elementType="DELETED",c.stateNode=i,c.return=s,i=s.deletions,i===null?(s.deletions=[c],s.flags|=16):i.push(c)}function KS(s,i){switch(s.tag){case 5:var c=s.type;return i=i.nodeType!==1||c.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(s.stateNode=i,Is=s,Fs=Ko(i.firstChild),!0):!1;case 6:return i=s.pendingProps===""||i.nodeType!==3?null:i,i!==null?(s.stateNode=i,Is=s,Fs=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(c=ul!==null?{id:zr,overflow:jr}:null,s.memoizedState={dehydrated:i,treeContext:c,retryLane:1073741824},c=fi(18,null,null,0),c.stateNode=i,c.return=s,s.child=c,Is=s,Fs=null,!0):!1;default:return!1}}function G0(s){return(s.mode&1)!==0&&(s.flags&128)===0}function X0(s){if(Ie){var i=Fs;if(i){var c=i;if(!KS(s,i)){if(G0(s))throw Error(e(418));i=Ko(c.nextSibling);var d=Is;i&&KS(s,i)?YS(d,c):(s.flags=s.flags&-4097|2,Ie=!1,Is=s)}}else{if(G0(s))throw Error(e(418));s.flags=s.flags&-4097|2,Ie=!1,Is=s}}}function QS(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Is=s}function tm(s){if(s!==Is)return!1;if(!Ie)return QS(s),Ie=!0,!1;var i;if((i=s.tag!==3)&&!(i=s.tag!==5)&&(i=s.type,i=i!=="head"&&i!=="body"&&!B0(s.type,s.memoizedProps)),i&&(i=Fs)){if(G0(s))throw ZS(),Error(e(418));for(;i;)YS(s,i),i=Ko(i.nextSibling)}if(QS(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(e(317));t:{for(s=s.nextSibling,i=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(i===0){Fs=Ko(s.nextSibling);break t}i--}else c!=="$"&&c!=="$!"&&c!=="$?"||i++}s=s.nextSibling}Fs=null}}else Fs=Is?Ko(s.stateNode.nextSibling):null;return!0}function ZS(){for(var s=Fs;s;)s=Ko(s.nextSibling)}function au(){Fs=Is=null,Ie=!1}function q0(s){Ii===null?Ii=[s]:Ii.push(s)}var b_=M.ReactCurrentBatchConfig;function Id(s,i,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(e(309));var d=c.stateNode}if(!d)throw Error(e(147,s));var m=d,A=""+s;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===A?i.ref:(i=function(_){var R=m.refs;_===null?delete R[A]:R[A]=_},i._stringRef=A,i)}if(typeof s!="string")throw Error(e(284));if(!c._owner)throw Error(e(290,s))}return s}function em(s,i){throw s=Object.prototype.toString.call(i),Error(e(31,s==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":s))}function JS(s){var i=s._init;return i(s._payload)}function tb(s){function i(B,F){if(s){var z=B.deletions;z===null?(B.deletions=[F],B.flags|=16):z.push(F)}}function c(B,F){if(!s)return null;for(;F!==null;)i(B,F),F=F.sibling;return null}function d(B,F){for(B=new Map;F!==null;)F.key!==null?B.set(F.key,F):B.set(F.index,F),F=F.sibling;return B}function m(B,F){return B=aa(B,F),B.index=0,B.sibling=null,B}function A(B,F,z){return B.index=z,s?(z=B.alternate,z!==null?(z=z.index,z<F?(B.flags|=2,F):z):(B.flags|=2,F)):(B.flags|=1048576,F)}function _(B){return s&&B.alternate===null&&(B.flags|=2),B}function R(B,F,z,J){return F===null||F.tag!==6?(F=Uv(z,B.mode,J),F.return=B,F):(F=m(F,z),F.return=B,F)}function N(B,F,z,J){var St=z.type;return St===U?q(B,F,z.props.children,J,z.key):F!==null&&(F.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===ot&&JS(St)===F.type)?(J=m(F,z.props),J.ref=Id(B,F,z),J.return=B,J):(J=Cm(z.type,z.key,z.props,null,B.mode,J),J.ref=Id(B,F,z),J.return=B,J)}function j(B,F,z,J){return F===null||F.tag!==4||F.stateNode.containerInfo!==z.containerInfo||F.stateNode.implementation!==z.implementation?(F=zv(z,B.mode,J),F.return=B,F):(F=m(F,z.children||[]),F.return=B,F)}function q(B,F,z,J,St){return F===null||F.tag!==7?(F=wl(z,B.mode,J,St),F.return=B,F):(F=m(F,z),F.return=B,F)}function Q(B,F,z){if(typeof F=="string"&&F!==""||typeof F=="number")return F=Uv(""+F,B.mode,z),F.return=B,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case D:return z=Cm(F.type,F.key,F.props,null,B.mode,z),z.ref=Id(B,null,F),z.return=B,z;case I:return F=zv(F,B.mode,z),F.return=B,F;case ot:var J=F._init;return Q(B,J(F._payload),z)}if(Ms(F)||dt(F))return F=wl(F,B.mode,z,null),F.return=B,F;em(B,F)}return null}function X(B,F,z,J){var St=F!==null?F.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return St!==null?null:R(B,F,""+z,J);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case D:return z.key===St?N(B,F,z,J):null;case I:return z.key===St?j(B,F,z,J):null;case ot:return St=z._init,X(B,F,St(z._payload),J)}if(Ms(z)||dt(z))return St!==null?null:q(B,F,z,J,null);em(B,z)}return null}function ct(B,F,z,J,St){if(typeof J=="string"&&J!==""||typeof J=="number")return B=B.get(z)||null,R(F,B,""+J,St);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case D:return B=B.get(J.key===null?z:J.key)||null,N(F,B,J,St);case I:return B=B.get(J.key===null?z:J.key)||null,j(F,B,J,St);case ot:var Rt=J._init;return ct(B,F,z,Rt(J._payload),St)}if(Ms(J)||dt(J))return B=B.get(z)||null,q(F,B,J,St,null);em(F,J)}return null}function mt(B,F,z,J){for(var St=null,Rt=null,Lt=F,It=F=0,xn=null;Lt!==null&&It<z.length;It++){Lt.index>It?(xn=Lt,Lt=null):xn=Lt.sibling;var re=X(B,Lt,z[It],J);if(re===null){Lt===null&&(Lt=xn);break}s&&Lt&&re.alternate===null&&i(B,Lt),F=A(re,F,It),Rt===null?St=re:Rt.sibling=re,Rt=re,Lt=xn}if(It===z.length)return c(B,Lt),Ie&&hl(B,It),St;if(Lt===null){for(;It<z.length;It++)Lt=Q(B,z[It],J),Lt!==null&&(F=A(Lt,F,It),Rt===null?St=Lt:Rt.sibling=Lt,Rt=Lt);return Ie&&hl(B,It),St}for(Lt=d(B,Lt);It<z.length;It++)xn=ct(Lt,B,It,z[It],J),xn!==null&&(s&&xn.alternate!==null&&Lt.delete(xn.key===null?It:xn.key),F=A(xn,F,It),Rt===null?St=xn:Rt.sibling=xn,Rt=xn);return s&&Lt.forEach(function(la){return i(B,la)}),Ie&&hl(B,It),St}function yt(B,F,z,J){var St=dt(z);if(typeof St!="function")throw Error(e(150));if(z=St.call(z),z==null)throw Error(e(151));for(var Rt=St=null,Lt=F,It=F=0,xn=null,re=z.next();Lt!==null&&!re.done;It++,re=z.next()){Lt.index>It?(xn=Lt,Lt=null):xn=Lt.sibling;var la=X(B,Lt,re.value,J);if(la===null){Lt===null&&(Lt=xn);break}s&&Lt&&la.alternate===null&&i(B,Lt),F=A(la,F,It),Rt===null?St=la:Rt.sibling=la,Rt=la,Lt=xn}if(re.done)return c(B,Lt),Ie&&hl(B,It),St;if(Lt===null){for(;!re.done;It++,re=z.next())re=Q(B,re.value,J),re!==null&&(F=A(re,F,It),Rt===null?St=re:Rt.sibling=re,Rt=re);return Ie&&hl(B,It),St}for(Lt=d(B,Lt);!re.done;It++,re=z.next())re=ct(Lt,B,It,re.value,J),re!==null&&(s&&re.alternate!==null&&Lt.delete(re.key===null?It:re.key),F=A(re,F,It),Rt===null?St=re:Rt.sibling=re,Rt=re);return s&&Lt.forEach(function(ek){return i(B,ek)}),Ie&&hl(B,It),St}function en(B,F,z,J){if(typeof z=="object"&&z!==null&&z.type===U&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case D:t:{for(var St=z.key,Rt=F;Rt!==null;){if(Rt.key===St){if(St=z.type,St===U){if(Rt.tag===7){c(B,Rt.sibling),F=m(Rt,z.props.children),F.return=B,B=F;break t}}else if(Rt.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===ot&&JS(St)===Rt.type){c(B,Rt.sibling),F=m(Rt,z.props),F.ref=Id(B,Rt,z),F.return=B,B=F;break t}c(B,Rt);break}else i(B,Rt);Rt=Rt.sibling}z.type===U?(F=wl(z.props.children,B.mode,J,z.key),F.return=B,B=F):(J=Cm(z.type,z.key,z.props,null,B.mode,J),J.ref=Id(B,F,z),J.return=B,B=J)}return _(B);case I:t:{for(Rt=z.key;F!==null;){if(F.key===Rt)if(F.tag===4&&F.stateNode.containerInfo===z.containerInfo&&F.stateNode.implementation===z.implementation){c(B,F.sibling),F=m(F,z.children||[]),F.return=B,B=F;break t}else{c(B,F);break}else i(B,F);F=F.sibling}F=zv(z,B.mode,J),F.return=B,B=F}return _(B);case ot:return Rt=z._init,en(B,F,Rt(z._payload),J)}if(Ms(z))return mt(B,F,z,J);if(dt(z))return yt(B,F,z,J);em(B,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,F!==null&&F.tag===6?(c(B,F.sibling),F=m(F,z),F.return=B,B=F):(c(B,F),F=Uv(z,B.mode,J),F.return=B,B=F),_(B)):c(B,F)}return en}var lu=tb(!0),eb=tb(!1),nm=Qo(null),sm=null,cu=null,Y0=null;function K0(){Y0=cu=sm=null}function Q0(s){var i=nm.current;Me(nm),s._currentValue=i}function Z0(s,i,c){for(;s!==null;){var d=s.alternate;if((s.childLanes&i)!==i?(s.childLanes|=i,d!==null&&(d.childLanes|=i)):d!==null&&(d.childLanes&i)!==i&&(d.childLanes|=i),s===c)break;s=s.return}}function uu(s,i){sm=s,Y0=cu=null,s=s.dependencies,s!==null&&s.firstContext!==null&&((s.lanes&i)!==0&&(vs=!0),s.firstContext=null)}function ui(s){var i=s._currentValue;if(Y0!==s)if(s={context:s,memoizedValue:i,next:null},cu===null){if(sm===null)throw Error(e(308));cu=s,sm.dependencies={lanes:0,firstContext:s}}else cu=cu.next=s;return i}var dl=null;function J0(s){dl===null?dl=[s]:dl.push(s)}function nb(s,i,c,d){var m=i.interleaved;return m===null?(c.next=c,J0(i)):(c.next=m.next,m.next=c),i.interleaved=c,Hr(s,d)}function Hr(s,i){s.lanes|=i;var c=s.alternate;for(c!==null&&(c.lanes|=i),c=s,s=s.return;s!==null;)s.childLanes|=i,c=s.alternate,c!==null&&(c.childLanes|=i),c=s,s=s.return;return c.tag===3?c.stateNode:null}var ta=!1;function tv(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sb(s,i){s=s.updateQueue,i.updateQueue===s&&(i.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function $r(s,i){return{eventTime:s,lane:i,tag:0,payload:null,callback:null,next:null}}function ea(s,i,c){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(te&2)!==0){var m=d.pending;return m===null?i.next=i:(i.next=m.next,m.next=i),d.pending=i,Hr(s,c)}return m=d.interleaved,m===null?(i.next=i,J0(d)):(i.next=m.next,m.next=i),d.interleaved=i,Hr(s,c)}function im(s,i,c){if(i=i.updateQueue,i!==null&&(i=i.shared,(c&4194240)!==0)){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,p0(s,c)}}function ib(s,i){var c=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,c===d)){var m=null,A=null;if(c=c.firstBaseUpdate,c!==null){do{var _={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};A===null?m=A=_:A=A.next=_,c=c.next}while(c!==null);A===null?m=A=i:A=A.next=i}else m=A=i;c={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:A,shared:d.shared,effects:d.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=i:s.next=i,c.lastBaseUpdate=i}function rm(s,i,c,d){var m=s.updateQueue;ta=!1;var A=m.firstBaseUpdate,_=m.lastBaseUpdate,R=m.shared.pending;if(R!==null){m.shared.pending=null;var N=R,j=N.next;N.next=null,_===null?A=j:_.next=j,_=N;var q=s.alternate;q!==null&&(q=q.updateQueue,R=q.lastBaseUpdate,R!==_&&(R===null?q.firstBaseUpdate=j:R.next=j,q.lastBaseUpdate=N))}if(A!==null){var Q=m.baseState;_=0,q=j=N=null,R=A;do{var X=R.lane,ct=R.eventTime;if((d&X)===X){q!==null&&(q=q.next={eventTime:ct,lane:0,tag:R.tag,payload:R.payload,callback:R.callback,next:null});t:{var mt=s,yt=R;switch(X=i,ct=c,yt.tag){case 1:if(mt=yt.payload,typeof mt=="function"){Q=mt.call(ct,Q,X);break t}Q=mt;break t;case 3:mt.flags=mt.flags&-65537|128;case 0:if(mt=yt.payload,X=typeof mt=="function"?mt.call(ct,Q,X):mt,X==null)break t;Q=Z({},Q,X);break t;case 2:ta=!0}}R.callback!==null&&R.lane!==0&&(s.flags|=64,X=m.effects,X===null?m.effects=[R]:X.push(R))}else ct={eventTime:ct,lane:X,tag:R.tag,payload:R.payload,callback:R.callback,next:null},q===null?(j=q=ct,N=Q):q=q.next=ct,_|=X;if(R=R.next,R===null){if(R=m.shared.pending,R===null)break;X=R,R=X.next,X.next=null,m.lastBaseUpdate=X,m.shared.pending=null}}while(!0);if(q===null&&(N=Q),m.baseState=N,m.firstBaseUpdate=j,m.lastBaseUpdate=q,i=m.shared.interleaved,i!==null){m=i;do _|=m.lane,m=m.next;while(m!==i)}else A===null&&(m.shared.lanes=0);gl|=_,s.lanes=_,s.memoizedState=Q}}function rb(s,i,c){if(s=i.effects,i.effects=null,s!==null)for(i=0;i<s.length;i++){var d=s[i],m=d.callback;if(m!==null){if(d.callback=null,d=c,typeof m!="function")throw Error(e(191,m));m.call(d)}}}var Fd={},ir=Qo(Fd),Od=Qo(Fd),Bd=Qo(Fd);function fl(s){if(s===Fd)throw Error(e(174));return s}function ev(s,i){switch(ke(Bd,i),ke(Od,s),ke(ir,Fd),s=i.nodeType,s){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:cd(null,"");break;default:s=s===8?i.parentNode:i,i=s.namespaceURI||null,s=s.tagName,i=cd(i,s)}Me(ir),ke(ir,i)}function hu(){Me(ir),Me(Od),Me(Bd)}function ob(s){fl(Bd.current);var i=fl(ir.current),c=cd(i,s.type);i!==c&&(ke(Od,s),ke(ir,c))}function nv(s){Od.current===s&&(Me(ir),Me(Od))}var Ue=Qo(0);function om(s){for(var i=s;i!==null;){if(i.tag===13){var c=i.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var sv=[];function iv(){for(var s=0;s<sv.length;s++)sv[s]._workInProgressVersionPrimary=null;sv.length=0}var am=M.ReactCurrentDispatcher,rv=M.ReactCurrentBatchConfig,pl=0,ze=null,hn=null,Sn=null,lm=!1,Ud=!1,zd=0,x_=0;function Vn(){throw Error(e(321))}function ov(s,i){if(i===null)return!1;for(var c=0;c<i.length&&c<s.length;c++)if(!Ni(s[c],i[c]))return!1;return!0}function av(s,i,c,d,m,A){if(pl=A,ze=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,am.current=s===null||s.memoizedState===null?k_:T_,s=c(d,m),Ud){A=0;do{if(Ud=!1,zd=0,25<=A)throw Error(e(301));A+=1,Sn=hn=null,i.updateQueue=null,am.current=P_,s=c(d,m)}while(Ud)}if(am.current=hm,i=hn!==null&&hn.next!==null,pl=0,Sn=hn=ze=null,lm=!1,i)throw Error(e(300));return s}function lv(){var s=zd!==0;return zd=0,s}function rr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?ze.memoizedState=Sn=s:Sn=Sn.next=s,Sn}function hi(){if(hn===null){var s=ze.alternate;s=s!==null?s.memoizedState:null}else s=hn.next;var i=Sn===null?ze.memoizedState:Sn.next;if(i!==null)Sn=i,hn=s;else{if(s===null)throw Error(e(310));hn=s,s={memoizedState:hn.memoizedState,baseState:hn.baseState,baseQueue:hn.baseQueue,queue:hn.queue,next:null},Sn===null?ze.memoizedState=Sn=s:Sn=Sn.next=s}return Sn}function jd(s,i){return typeof i=="function"?i(s):i}function cv(s){var i=hi(),c=i.queue;if(c===null)throw Error(e(311));c.lastRenderedReducer=s;var d=hn,m=d.baseQueue,A=c.pending;if(A!==null){if(m!==null){var _=m.next;m.next=A.next,A.next=_}d.baseQueue=m=A,c.pending=null}if(m!==null){A=m.next,d=d.baseState;var R=_=null,N=null,j=A;do{var q=j.lane;if((pl&q)===q)N!==null&&(N=N.next={lane:0,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null}),d=j.hasEagerState?j.eagerState:s(d,j.action);else{var Q={lane:q,action:j.action,hasEagerState:j.hasEagerState,eagerState:j.eagerState,next:null};N===null?(R=N=Q,_=d):N=N.next=Q,ze.lanes|=q,gl|=q}j=j.next}while(j!==null&&j!==A);N===null?_=d:N.next=R,Ni(d,i.memoizedState)||(vs=!0),i.memoizedState=d,i.baseState=_,i.baseQueue=N,c.lastRenderedState=d}if(s=c.interleaved,s!==null){m=s;do A=m.lane,ze.lanes|=A,gl|=A,m=m.next;while(m!==s)}else m===null&&(c.lanes=0);return[i.memoizedState,c.dispatch]}function uv(s){var i=hi(),c=i.queue;if(c===null)throw Error(e(311));c.lastRenderedReducer=s;var d=c.dispatch,m=c.pending,A=i.memoizedState;if(m!==null){c.pending=null;var _=m=m.next;do A=s(A,_.action),_=_.next;while(_!==m);Ni(A,i.memoizedState)||(vs=!0),i.memoizedState=A,i.baseQueue===null&&(i.baseState=A),c.lastRenderedState=A}return[A,d]}function ab(){}function lb(s,i){var c=ze,d=hi(),m=i(),A=!Ni(d.memoizedState,m);if(A&&(d.memoizedState=m,vs=!0),d=d.queue,hv(hb.bind(null,c,d,s),[s]),d.getSnapshot!==i||A||Sn!==null&&Sn.memoizedState.tag&1){if(c.flags|=2048,Hd(9,ub.bind(null,c,d,m,i),void 0,null),bn===null)throw Error(e(349));(pl&30)!==0||cb(c,i,m)}return m}function cb(s,i,c){s.flags|=16384,s={getSnapshot:i,value:c},i=ze.updateQueue,i===null?(i={lastEffect:null,stores:null},ze.updateQueue=i,i.stores=[s]):(c=i.stores,c===null?i.stores=[s]:c.push(s))}function ub(s,i,c,d){i.value=c,i.getSnapshot=d,db(i)&&fb(s)}function hb(s,i,c){return c(function(){db(i)&&fb(s)})}function db(s){var i=s.getSnapshot;s=s.value;try{var c=i();return!Ni(s,c)}catch{return!0}}function fb(s){var i=Hr(s,1);i!==null&&Ui(i,s,1,-1)}function pb(s){var i=rr();return typeof s=="function"&&(s=s()),i.memoizedState=i.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jd,lastRenderedState:s},i.queue=s,s=s.dispatch=__.bind(null,ze,s),[i.memoizedState,s]}function Hd(s,i,c,d){return s={tag:s,create:i,destroy:c,deps:d,next:null},i=ze.updateQueue,i===null?(i={lastEffect:null,stores:null},ze.updateQueue=i,i.lastEffect=s.next=s):(c=i.lastEffect,c===null?i.lastEffect=s.next=s:(d=c.next,c.next=s,s.next=d,i.lastEffect=s)),s}function gb(){return hi().memoizedState}function cm(s,i,c,d){var m=rr();ze.flags|=s,m.memoizedState=Hd(1|i,c,void 0,d===void 0?null:d)}function um(s,i,c,d){var m=hi();d=d===void 0?null:d;var A=void 0;if(hn!==null){var _=hn.memoizedState;if(A=_.destroy,d!==null&&ov(d,_.deps)){m.memoizedState=Hd(i,c,A,d);return}}ze.flags|=s,m.memoizedState=Hd(1|i,c,A,d)}function mb(s,i){return cm(8390656,8,s,i)}function hv(s,i){return um(2048,8,s,i)}function yb(s,i){return um(4,2,s,i)}function vb(s,i){return um(4,4,s,i)}function wb(s,i){if(typeof i=="function")return s=s(),i(s),function(){i(null)};if(i!=null)return s=s(),i.current=s,function(){i.current=null}}function Ab(s,i,c){return c=c!=null?c.concat([s]):null,um(4,4,wb.bind(null,i,s),c)}function dv(){}function Sb(s,i){var c=hi();i=i===void 0?null:i;var d=c.memoizedState;return d!==null&&i!==null&&ov(i,d[1])?d[0]:(c.memoizedState=[s,i],s)}function bb(s,i){var c=hi();i=i===void 0?null:i;var d=c.memoizedState;return d!==null&&i!==null&&ov(i,d[1])?d[0]:(s=s(),c.memoizedState=[s,i],s)}function xb(s,i,c){return(pl&21)===0?(s.baseState&&(s.baseState=!1,vs=!0),s.memoizedState=c):(Ni(c,i)||(c=JA(),ze.lanes|=c,gl|=c,s.baseState=!0),i)}function E_(s,i){var c=de;de=c!==0&&4>c?c:4,s(!0);var d=rv.transition;rv.transition={};try{s(!1),i()}finally{de=c,rv.transition=d}}function Eb(){return hi().memoizedState}function C_(s,i,c){var d=ra(s);if(c={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null},Cb(s))_b(i,c);else if(c=nb(s,i,c,d),c!==null){var m=is();Ui(c,s,d,m),kb(c,i,d)}}function __(s,i,c){var d=ra(s),m={lane:d,action:c,hasEagerState:!1,eagerState:null,next:null};if(Cb(s))_b(i,m);else{var A=s.alternate;if(s.lanes===0&&(A===null||A.lanes===0)&&(A=i.lastRenderedReducer,A!==null))try{var _=i.lastRenderedState,R=A(_,c);if(m.hasEagerState=!0,m.eagerState=R,Ni(R,_)){var N=i.interleaved;N===null?(m.next=m,J0(i)):(m.next=N.next,N.next=m),i.interleaved=m;return}}catch{}finally{}c=nb(s,i,m,d),c!==null&&(m=is(),Ui(c,s,d,m),kb(c,i,d))}}function Cb(s){var i=s.alternate;return s===ze||i!==null&&i===ze}function _b(s,i){Ud=lm=!0;var c=s.pending;c===null?i.next=i:(i.next=c.next,c.next=i),s.pending=i}function kb(s,i,c){if((c&4194240)!==0){var d=i.lanes;d&=s.pendingLanes,c|=d,i.lanes=c,p0(s,c)}}var hm={readContext:ui,useCallback:Vn,useContext:Vn,useEffect:Vn,useImperativeHandle:Vn,useInsertionEffect:Vn,useLayoutEffect:Vn,useMemo:Vn,useReducer:Vn,useRef:Vn,useState:Vn,useDebugValue:Vn,useDeferredValue:Vn,useTransition:Vn,useMutableSource:Vn,useSyncExternalStore:Vn,useId:Vn,unstable_isNewReconciler:!1},k_={readContext:ui,useCallback:function(s,i){return rr().memoizedState=[s,i===void 0?null:i],s},useContext:ui,useEffect:mb,useImperativeHandle:function(s,i,c){return c=c!=null?c.concat([s]):null,cm(4194308,4,wb.bind(null,i,s),c)},useLayoutEffect:function(s,i){return cm(4194308,4,s,i)},useInsertionEffect:function(s,i){return cm(4,2,s,i)},useMemo:function(s,i){var c=rr();return i=i===void 0?null:i,s=s(),c.memoizedState=[s,i],s},useReducer:function(s,i,c){var d=rr();return i=c!==void 0?c(i):i,d.memoizedState=d.baseState=i,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:i},d.queue=s,s=s.dispatch=C_.bind(null,ze,s),[d.memoizedState,s]},useRef:function(s){var i=rr();return s={current:s},i.memoizedState=s},useState:pb,useDebugValue:dv,useDeferredValue:function(s){return rr().memoizedState=s},useTransition:function(){var s=pb(!1),i=s[0];return s=E_.bind(null,s[1]),rr().memoizedState=s,[i,s]},useMutableSource:function(){},useSyncExternalStore:function(s,i,c){var d=ze,m=rr();if(Ie){if(c===void 0)throw Error(e(407));c=c()}else{if(c=i(),bn===null)throw Error(e(349));(pl&30)!==0||cb(d,i,c)}m.memoizedState=c;var A={value:c,getSnapshot:i};return m.queue=A,mb(hb.bind(null,d,A,s),[s]),d.flags|=2048,Hd(9,ub.bind(null,d,A,c,i),void 0,null),c},useId:function(){var s=rr(),i=bn.identifierPrefix;if(Ie){var c=jr,d=zr;c=(d&~(1<<32-tn(d)-1)).toString(32)+c,i=":"+i+"R"+c,c=zd++,0<c&&(i+="H"+c.toString(32)),i+=":"}else c=x_++,i=":"+i+"r"+c.toString(32)+":";return s.memoizedState=i},unstable_isNewReconciler:!1},T_={readContext:ui,useCallback:Sb,useContext:ui,useEffect:hv,useImperativeHandle:Ab,useInsertionEffect:yb,useLayoutEffect:vb,useMemo:bb,useReducer:cv,useRef:gb,useState:function(){return cv(jd)},useDebugValue:dv,useDeferredValue:function(s){var i=hi();return xb(i,hn.memoizedState,s)},useTransition:function(){var s=cv(jd)[0],i=hi().memoizedState;return[s,i]},useMutableSource:ab,useSyncExternalStore:lb,useId:Eb,unstable_isNewReconciler:!1},P_={readContext:ui,useCallback:Sb,useContext:ui,useEffect:hv,useImperativeHandle:Ab,useInsertionEffect:yb,useLayoutEffect:vb,useMemo:bb,useReducer:uv,useRef:gb,useState:function(){return uv(jd)},useDebugValue:dv,useDeferredValue:function(s){var i=hi();return hn===null?i.memoizedState=s:xb(i,hn.memoizedState,s)},useTransition:function(){var s=uv(jd)[0],i=hi().memoizedState;return[s,i]},useMutableSource:ab,useSyncExternalStore:lb,useId:Eb,unstable_isNewReconciler:!1};function Fi(s,i){if(s&&s.defaultProps){i=Z({},i),s=s.defaultProps;for(var c in s)i[c]===void 0&&(i[c]=s[c]);return i}return i}function fv(s,i,c,d){i=s.memoizedState,c=c(d,i),c=c==null?i:Z({},i,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var dm={isMounted:function(s){return(s=s._reactInternals)?he(s)===s:!1},enqueueSetState:function(s,i,c){s=s._reactInternals;var d=is(),m=ra(s),A=$r(d,m);A.payload=i,c!=null&&(A.callback=c),i=ea(s,A,m),i!==null&&(Ui(i,s,m,d),im(i,s,m))},enqueueReplaceState:function(s,i,c){s=s._reactInternals;var d=is(),m=ra(s),A=$r(d,m);A.tag=1,A.payload=i,c!=null&&(A.callback=c),i=ea(s,A,m),i!==null&&(Ui(i,s,m,d),im(i,s,m))},enqueueForceUpdate:function(s,i){s=s._reactInternals;var c=is(),d=ra(s),m=$r(c,d);m.tag=2,i!=null&&(m.callback=i),i=ea(s,m,d),i!==null&&(Ui(i,s,d,c),im(i,s,d))}};function Tb(s,i,c,d,m,A,_){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,A,_):i.prototype&&i.prototype.isPureReactComponent?!Td(c,d)||!Td(m,A):!0}function Pb(s,i,c){var d=!1,m=Zo,A=i.contextType;return typeof A=="object"&&A!==null?A=ui(A):(m=ys(i)?cl:Wn.current,d=i.contextTypes,A=(d=d!=null)?iu(s,m):Zo),i=new i(c,A),s.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=dm,s.stateNode=i,i._reactInternals=s,d&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=A),i}function Rb(s,i,c,d){s=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(c,d),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(c,d),i.state!==s&&dm.enqueueReplaceState(i,i.state,null)}function pv(s,i,c,d){var m=s.stateNode;m.props=c,m.state=s.memoizedState,m.refs={},tv(s);var A=i.contextType;typeof A=="object"&&A!==null?m.context=ui(A):(A=ys(i)?cl:Wn.current,m.context=iu(s,A)),m.state=s.memoizedState,A=i.getDerivedStateFromProps,typeof A=="function"&&(fv(s,i,A,c),m.state=s.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(i=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),i!==m.state&&dm.enqueueReplaceState(m,m.state,null),rm(s,c,m,d),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function du(s,i){try{var c="",d=i;do c+=bt(d),d=d.return;while(d);var m=c}catch(A){m=`
Error generating stack: `+A.message+`
`+A.stack}return{value:s,source:i,stack:m,digest:null}}function gv(s,i,c){return{value:s,source:null,stack:c??null,digest:i??null}}function mv(s,i){try{console.error(i.value)}catch(c){setTimeout(function(){throw c})}}var R_=typeof WeakMap=="function"?WeakMap:Map;function Lb(s,i,c){c=$r(-1,c),c.tag=3,c.payload={element:null};var d=i.value;return c.callback=function(){wm||(wm=!0,Lv=d),mv(s,i)},c}function Mb(s,i,c){c=$r(-1,c),c.tag=3;var d=s.type.getDerivedStateFromError;if(typeof d=="function"){var m=i.value;c.payload=function(){return d(m)},c.callback=function(){mv(s,i)}}var A=s.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(c.callback=function(){mv(s,i),typeof d!="function"&&(sa===null?sa=new Set([this]):sa.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})}),c}function Db(s,i,c){var d=s.pingCache;if(d===null){d=s.pingCache=new R_;var m=new Set;d.set(i,m)}else m=d.get(i),m===void 0&&(m=new Set,d.set(i,m));m.has(c)||(m.add(c),s=W_.bind(null,s,i,c),i.then(s,s))}function Nb(s){do{var i;if((i=s.tag===13)&&(i=s.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return s;s=s.return}while(s!==null);return null}function Ib(s,i,c,d,m){return(s.mode&1)===0?(s===i?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(i=$r(-1,1),i.tag=2,ea(c,i,1))),c.lanes|=1),s):(s.flags|=65536,s.lanes=m,s)}var L_=M.ReactCurrentOwner,vs=!1;function ss(s,i,c,d){i.child=s===null?eb(i,null,c,d):lu(i,s.child,c,d)}function Fb(s,i,c,d,m){c=c.render;var A=i.ref;return uu(i,m),d=av(s,i,c,d,A,m),c=lv(),s!==null&&!vs?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,Wr(s,i,m)):(Ie&&c&&W0(i),i.flags|=1,ss(s,i,d,m),i.child)}function Ob(s,i,c,d,m){if(s===null){var A=c.type;return typeof A=="function"&&!Bv(A)&&A.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(i.tag=15,i.type=A,Bb(s,i,A,d,m)):(s=Cm(c.type,null,d,i,i.mode,m),s.ref=i.ref,s.return=i,i.child=s)}if(A=s.child,(s.lanes&m)===0){var _=A.memoizedProps;if(c=c.compare,c=c!==null?c:Td,c(_,d)&&s.ref===i.ref)return Wr(s,i,m)}return i.flags|=1,s=aa(A,d),s.ref=i.ref,s.return=i,i.child=s}function Bb(s,i,c,d,m){if(s!==null){var A=s.memoizedProps;if(Td(A,d)&&s.ref===i.ref)if(vs=!1,i.pendingProps=d=A,(s.lanes&m)!==0)(s.flags&131072)!==0&&(vs=!0);else return i.lanes=s.lanes,Wr(s,i,m)}return yv(s,i,c,d,m)}function Ub(s,i,c){var d=i.pendingProps,m=d.children,A=s!==null?s.memoizedState:null;if(d.mode==="hidden")if((i.mode&1)===0)i.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(pu,Os),Os|=c;else{if((c&1073741824)===0)return s=A!==null?A.baseLanes|c:c,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:s,cachePool:null,transitions:null},i.updateQueue=null,ke(pu,Os),Os|=s,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=A!==null?A.baseLanes:c,ke(pu,Os),Os|=d}else A!==null?(d=A.baseLanes|c,i.memoizedState=null):d=c,ke(pu,Os),Os|=d;return ss(s,i,m,c),i.child}function zb(s,i){var c=i.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(i.flags|=512,i.flags|=2097152)}function yv(s,i,c,d,m){var A=ys(c)?cl:Wn.current;return A=iu(i,A),uu(i,m),c=av(s,i,c,d,A,m),d=lv(),s!==null&&!vs?(i.updateQueue=s.updateQueue,i.flags&=-2053,s.lanes&=~m,Wr(s,i,m)):(Ie&&d&&W0(i),i.flags|=1,ss(s,i,c,m),i.child)}function jb(s,i,c,d,m){if(ys(c)){var A=!0;Kg(i)}else A=!1;if(uu(i,m),i.stateNode===null)pm(s,i),Pb(i,c,d),pv(i,c,d,m),d=!0;else if(s===null){var _=i.stateNode,R=i.memoizedProps;_.props=R;var N=_.context,j=c.contextType;typeof j=="object"&&j!==null?j=ui(j):(j=ys(c)?cl:Wn.current,j=iu(i,j));var q=c.getDerivedStateFromProps,Q=typeof q=="function"||typeof _.getSnapshotBeforeUpdate=="function";Q||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(R!==d||N!==j)&&Rb(i,_,d,j),ta=!1;var X=i.memoizedState;_.state=X,rm(i,d,_,m),N=i.memoizedState,R!==d||X!==N||ms.current||ta?(typeof q=="function"&&(fv(i,c,q,d),N=i.memoizedState),(R=ta||Tb(i,c,R,d,X,N,j))?(Q||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(i.flags|=4194308)):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=d,i.memoizedState=N),_.props=d,_.state=N,_.context=j,d=R):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),d=!1)}else{_=i.stateNode,sb(s,i),R=i.memoizedProps,j=i.type===i.elementType?R:Fi(i.type,R),_.props=j,Q=i.pendingProps,X=_.context,N=c.contextType,typeof N=="object"&&N!==null?N=ui(N):(N=ys(c)?cl:Wn.current,N=iu(i,N));var ct=c.getDerivedStateFromProps;(q=typeof ct=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(R!==Q||X!==N)&&Rb(i,_,d,N),ta=!1,X=i.memoizedState,_.state=X,rm(i,d,_,m);var mt=i.memoizedState;R!==Q||X!==mt||ms.current||ta?(typeof ct=="function"&&(fv(i,c,ct,d),mt=i.memoizedState),(j=ta||Tb(i,c,j,d,X,mt,N)||!1)?(q||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(d,mt,N),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(d,mt,N)),typeof _.componentDidUpdate=="function"&&(i.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof _.componentDidUpdate!="function"||R===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),i.memoizedProps=d,i.memoizedState=mt),_.props=d,_.state=mt,_.context=N,d=j):(typeof _.componentDidUpdate!="function"||R===s.memoizedProps&&X===s.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&X===s.memoizedState||(i.flags|=1024),d=!1)}return vv(s,i,c,d,A,m)}function vv(s,i,c,d,m,A){zb(s,i);var _=(i.flags&128)!==0;if(!d&&!_)return m&&GS(i,c,!1),Wr(s,i,A);d=i.stateNode,L_.current=i;var R=_&&typeof c.getDerivedStateFromError!="function"?null:d.render();return i.flags|=1,s!==null&&_?(i.child=lu(i,s.child,null,A),i.child=lu(i,null,R,A)):ss(s,i,R,A),i.memoizedState=d.state,m&&GS(i,c,!0),i.child}function Hb(s){var i=s.stateNode;i.pendingContext?WS(s,i.pendingContext,i.pendingContext!==i.context):i.context&&WS(s,i.context,!1),ev(s,i.containerInfo)}function $b(s,i,c,d,m){return au(),q0(m),i.flags|=256,ss(s,i,c,d),i.child}var wv={dehydrated:null,treeContext:null,retryLane:0};function Av(s){return{baseLanes:s,cachePool:null,transitions:null}}function Wb(s,i,c){var d=i.pendingProps,m=Ue.current,A=!1,_=(i.flags&128)!==0,R;if((R=_)||(R=s!==null&&s.memoizedState===null?!1:(m&2)!==0),R?(A=!0,i.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),ke(Ue,m&1),s===null)return X0(i),s=i.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?((i.mode&1)===0?i.lanes=1:s.data==="$!"?i.lanes=8:i.lanes=1073741824,null):(_=d.children,s=d.fallback,A?(d=i.mode,A=i.child,_={mode:"hidden",children:_},(d&1)===0&&A!==null?(A.childLanes=0,A.pendingProps=_):A=_m(_,d,0,null),s=wl(s,d,c,null),A.return=i,s.return=i,A.sibling=s,i.child=A,i.child.memoizedState=Av(c),i.memoizedState=wv,s):Sv(i,_));if(m=s.memoizedState,m!==null&&(R=m.dehydrated,R!==null))return M_(s,i,_,d,R,m,c);if(A){A=d.fallback,_=i.mode,m=s.child,R=m.sibling;var N={mode:"hidden",children:d.children};return(_&1)===0&&i.child!==m?(d=i.child,d.childLanes=0,d.pendingProps=N,i.deletions=null):(d=aa(m,N),d.subtreeFlags=m.subtreeFlags&14680064),R!==null?A=aa(R,A):(A=wl(A,_,c,null),A.flags|=2),A.return=i,d.return=i,d.sibling=A,i.child=d,d=A,A=i.child,_=s.child.memoizedState,_=_===null?Av(c):{baseLanes:_.baseLanes|c,cachePool:null,transitions:_.transitions},A.memoizedState=_,A.childLanes=s.childLanes&~c,i.memoizedState=wv,d}return A=s.child,s=A.sibling,d=aa(A,{mode:"visible",children:d.children}),(i.mode&1)===0&&(d.lanes=c),d.return=i,d.sibling=null,s!==null&&(c=i.deletions,c===null?(i.deletions=[s],i.flags|=16):c.push(s)),i.child=d,i.memoizedState=null,d}function Sv(s,i){return i=_m({mode:"visible",children:i},s.mode,0,null),i.return=s,s.child=i}function fm(s,i,c,d){return d!==null&&q0(d),lu(i,s.child,null,c),s=Sv(i,i.pendingProps.children),s.flags|=2,i.memoizedState=null,s}function M_(s,i,c,d,m,A,_){if(c)return i.flags&256?(i.flags&=-257,d=gv(Error(e(422))),fm(s,i,_,d)):i.memoizedState!==null?(i.child=s.child,i.flags|=128,null):(A=d.fallback,m=i.mode,d=_m({mode:"visible",children:d.children},m,0,null),A=wl(A,m,_,null),A.flags|=2,d.return=i,A.return=i,d.sibling=A,i.child=d,(i.mode&1)!==0&&lu(i,s.child,null,_),i.child.memoizedState=Av(_),i.memoizedState=wv,A);if((i.mode&1)===0)return fm(s,i,_,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var R=d.dgst;return d=R,A=Error(e(419)),d=gv(A,d,void 0),fm(s,i,_,d)}if(R=(_&s.childLanes)!==0,vs||R){if(d=bn,d!==null){switch(_&-_){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|_))!==0?0:m,m!==0&&m!==A.retryLane&&(A.retryLane=m,Hr(s,m),Ui(d,s,m,-1))}return Ov(),d=gv(Error(e(421))),fm(s,i,_,d)}return m.data==="$?"?(i.flags|=128,i.child=s.child,i=V_.bind(null,s),m._reactRetry=i,null):(s=A.treeContext,Fs=Ko(m.nextSibling),Is=i,Ie=!0,Ii=null,s!==null&&(li[ci++]=zr,li[ci++]=jr,li[ci++]=ul,zr=s.id,jr=s.overflow,ul=i),i=Sv(i,d.children),i.flags|=4096,i)}function Vb(s,i,c){s.lanes|=i;var d=s.alternate;d!==null&&(d.lanes|=i),Z0(s.return,i,c)}function bv(s,i,c,d,m){var A=s.memoizedState;A===null?s.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:d,tail:c,tailMode:m}:(A.isBackwards=i,A.rendering=null,A.renderingStartTime=0,A.last=d,A.tail=c,A.tailMode=m)}function Gb(s,i,c){var d=i.pendingProps,m=d.revealOrder,A=d.tail;if(ss(s,i,d.children,c),d=Ue.current,(d&2)!==0)d=d&1|2,i.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=i.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Vb(s,c,i);else if(s.tag===19)Vb(s,c,i);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break t;for(;s.sibling===null;){if(s.return===null||s.return===i)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}if(ke(Ue,d),(i.mode&1)===0)i.memoizedState=null;else switch(m){case"forwards":for(c=i.child,m=null;c!==null;)s=c.alternate,s!==null&&om(s)===null&&(m=c),c=c.sibling;c=m,c===null?(m=i.child,i.child=null):(m=c.sibling,c.sibling=null),bv(i,!1,m,c,A);break;case"backwards":for(c=null,m=i.child,i.child=null;m!==null;){if(s=m.alternate,s!==null&&om(s)===null){i.child=m;break}s=m.sibling,m.sibling=c,c=m,m=s}bv(i,!0,c,null,A);break;case"together":bv(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function pm(s,i){(i.mode&1)===0&&s!==null&&(s.alternate=null,i.alternate=null,i.flags|=2)}function Wr(s,i,c){if(s!==null&&(i.dependencies=s.dependencies),gl|=i.lanes,(c&i.childLanes)===0)return null;if(s!==null&&i.child!==s.child)throw Error(e(153));if(i.child!==null){for(s=i.child,c=aa(s,s.pendingProps),i.child=c,c.return=i;s.sibling!==null;)s=s.sibling,c=c.sibling=aa(s,s.pendingProps),c.return=i;c.sibling=null}return i.child}function D_(s,i,c){switch(i.tag){case 3:Hb(i),au();break;case 5:ob(i);break;case 1:ys(i.type)&&Kg(i);break;case 4:ev(i,i.stateNode.containerInfo);break;case 10:var d=i.type._context,m=i.memoizedProps.value;ke(nm,d._currentValue),d._currentValue=m;break;case 13:if(d=i.memoizedState,d!==null)return d.dehydrated!==null?(ke(Ue,Ue.current&1),i.flags|=128,null):(c&i.child.childLanes)!==0?Wb(s,i,c):(ke(Ue,Ue.current&1),s=Wr(s,i,c),s!==null?s.sibling:null);ke(Ue,Ue.current&1);break;case 19:if(d=(c&i.childLanes)!==0,(s.flags&128)!==0){if(d)return Gb(s,i,c);i.flags|=128}if(m=i.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ke(Ue,Ue.current),d)break;return null;case 22:case 23:return i.lanes=0,Ub(s,i,c)}return Wr(s,i,c)}var Xb,xv,qb,Yb;Xb=function(s,i){for(var c=i.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===i)break;for(;c.sibling===null;){if(c.return===null||c.return===i)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},xv=function(){},qb=function(s,i,c,d){var m=s.memoizedProps;if(m!==d){s=i.stateNode,fl(ir.current);var A=null;switch(c){case"input":m=Bo(s,m),d=Bo(s,d),A=[];break;case"select":m=Z({},m,{value:void 0}),d=Z({},d,{value:void 0}),A=[];break;case"textarea":m=od(s,m),d=od(s,d),A=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(s.onclick=Xg)}Y(c,d);var _;c=null;for(j in m)if(!d.hasOwnProperty(j)&&m.hasOwnProperty(j)&&m[j]!=null)if(j==="style"){var R=m[j];for(_ in R)R.hasOwnProperty(_)&&(c||(c={}),c[_]="")}else j!=="dangerouslySetInnerHTML"&&j!=="children"&&j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&j!=="autoFocus"&&(r.hasOwnProperty(j)?A||(A=[]):(A=A||[]).push(j,null));for(j in d){var N=d[j];if(R=m!=null?m[j]:void 0,d.hasOwnProperty(j)&&N!==R&&(N!=null||R!=null))if(j==="style")if(R){for(_ in R)!R.hasOwnProperty(_)||N&&N.hasOwnProperty(_)||(c||(c={}),c[_]="");for(_ in N)N.hasOwnProperty(_)&&R[_]!==N[_]&&(c||(c={}),c[_]=N[_])}else c||(A||(A=[]),A.push(j,c)),c=N;else j==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,R=R?R.__html:void 0,N!=null&&R!==N&&(A=A||[]).push(j,N)):j==="children"?typeof N!="string"&&typeof N!="number"||(A=A||[]).push(j,""+N):j!=="suppressContentEditableWarning"&&j!=="suppressHydrationWarning"&&(r.hasOwnProperty(j)?(N!=null&&j==="onScroll"&&Le("scroll",s),A||R===N||(A=[])):(A=A||[]).push(j,N))}c&&(A=A||[]).push("style",c);var j=A;(i.updateQueue=j)&&(i.flags|=4)}},Yb=function(s,i,c,d){c!==d&&(i.flags|=4)};function $d(s,i){if(!Ie)switch(s.tailMode){case"hidden":i=s.tail;for(var c=null;i!==null;)i.alternate!==null&&(c=i),i=i.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var d=null;c!==null;)c.alternate!==null&&(d=c),c=c.sibling;d===null?i||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Gn(s){var i=s.alternate!==null&&s.alternate.child===s.child,c=0,d=0;if(i)for(var m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)c|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=d,s.childLanes=c,i}function N_(s,i,c){var d=i.pendingProps;switch(V0(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gn(i),null;case 1:return ys(i.type)&&Yg(),Gn(i),null;case 3:return d=i.stateNode,hu(),Me(ms),Me(Wn),iv(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(s===null||s.child===null)&&(tm(i)?i.flags|=4:s===null||s.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ii!==null&&(Nv(Ii),Ii=null))),xv(s,i),Gn(i),null;case 5:nv(i);var m=fl(Bd.current);if(c=i.type,s!==null&&i.stateNode!=null)qb(s,i,c,d,m),s.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!d){if(i.stateNode===null)throw Error(e(166));return Gn(i),null}if(s=fl(ir.current),tm(i)){d=i.stateNode,c=i.type;var A=i.memoizedProps;switch(d[sr]=i,d[Dd]=A,s=(i.mode&1)!==0,c){case"dialog":Le("cancel",d),Le("close",d);break;case"iframe":case"object":case"embed":Le("load",d);break;case"video":case"audio":for(m=0;m<Rd.length;m++)Le(Rd[m],d);break;case"source":Le("error",d);break;case"img":case"image":case"link":Le("error",d),Le("load",d);break;case"details":Le("toggle",d);break;case"input":Ls(d,A),Le("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!A.multiple},Le("invalid",d);break;case"textarea":Cg(d,A),Le("invalid",d)}Y(c,A),m=null;for(var _ in A)if(A.hasOwnProperty(_)){var R=A[_];_==="children"?typeof R=="string"?d.textContent!==R&&(A.suppressHydrationWarning!==!0&&Gg(d.textContent,R,s),m=["children",R]):typeof R=="number"&&d.textContent!==""+R&&(A.suppressHydrationWarning!==!0&&Gg(d.textContent,R,s),m=["children",""+R]):r.hasOwnProperty(_)&&R!=null&&_==="onScroll"&&Le("scroll",d)}switch(c){case"input":es(d),zo(d,A,!0);break;case"textarea":es(d),ld(d);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(d.onclick=Xg)}d=m,i.updateQueue=d,d!==null&&(i.flags|=4)}else{_=m.nodeType===9?m:m.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=_g(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=_.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof d.is=="string"?s=_.createElement(c,{is:d.is}):(s=_.createElement(c),c==="select"&&(_=s,d.multiple?_.multiple=!0:d.size&&(_.size=d.size))):s=_.createElementNS(s,c),s[sr]=i,s[Dd]=d,Xb(s,i,!1,!1),i.stateNode=s;t:{switch(_=W(c,d),c){case"dialog":Le("cancel",s),Le("close",s),m=d;break;case"iframe":case"object":case"embed":Le("load",s),m=d;break;case"video":case"audio":for(m=0;m<Rd.length;m++)Le(Rd[m],s);m=d;break;case"source":Le("error",s),m=d;break;case"img":case"image":case"link":Le("error",s),Le("load",s),m=d;break;case"details":Le("toggle",s),m=d;break;case"input":Ls(s,d),m=Bo(s,d),Le("invalid",s);break;case"option":m=d;break;case"select":s._wrapperState={wasMultiple:!!d.multiple},m=Z({},d,{value:void 0}),Le("invalid",s);break;case"textarea":Cg(s,d),m=od(s,d),Le("invalid",s);break;default:m=d}Y(c,m),R=m;for(A in R)if(R.hasOwnProperty(A)){var N=R[A];A==="style"?Tg(s,N):A==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&ud(s,N)):A==="children"?typeof N=="string"?(c!=="textarea"||N!=="")&&Ho(s,N):typeof N=="number"&&Ho(s,""+N):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(r.hasOwnProperty(A)?N!=null&&A==="onScroll"&&Le("scroll",s):N!=null&&P(s,A,N,_))}switch(c){case"input":es(s),zo(s,d,!1);break;case"textarea":es(s),ld(s);break;case"option":d.value!=null&&s.setAttribute("value",""+Et(d.value));break;case"select":s.multiple=!!d.multiple,A=d.value,A!=null?jo(s,!!d.multiple,A,!1):d.defaultValue!=null&&jo(s,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(s.onclick=Xg)}switch(c){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}}d&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Gn(i),null;case 6:if(s&&i.stateNode!=null)Yb(s,i,s.memoizedProps,d);else{if(typeof d!="string"&&i.stateNode===null)throw Error(e(166));if(c=fl(Bd.current),fl(ir.current),tm(i)){if(d=i.stateNode,c=i.memoizedProps,d[sr]=i,(A=d.nodeValue!==c)&&(s=Is,s!==null))switch(s.tag){case 3:Gg(d.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Gg(d.nodeValue,c,(s.mode&1)!==0)}A&&(i.flags|=4)}else d=(c.nodeType===9?c:c.ownerDocument).createTextNode(d),d[sr]=i,i.stateNode=d}return Gn(i),null;case 13:if(Me(Ue),d=i.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(Ie&&Fs!==null&&(i.mode&1)!==0&&(i.flags&128)===0)ZS(),au(),i.flags|=98560,A=!1;else if(A=tm(i),d!==null&&d.dehydrated!==null){if(s===null){if(!A)throw Error(e(318));if(A=i.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(e(317));A[sr]=i}else au(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Gn(i),A=!1}else Ii!==null&&(Nv(Ii),Ii=null),A=!0;if(!A)return i.flags&65536?i:null}return(i.flags&128)!==0?(i.lanes=c,i):(d=d!==null,d!==(s!==null&&s.memoizedState!==null)&&d&&(i.child.flags|=8192,(i.mode&1)!==0&&(s===null||(Ue.current&1)!==0?dn===0&&(dn=3):Ov())),i.updateQueue!==null&&(i.flags|=4),Gn(i),null);case 4:return hu(),xv(s,i),s===null&&Ld(i.stateNode.containerInfo),Gn(i),null;case 10:return Q0(i.type._context),Gn(i),null;case 17:return ys(i.type)&&Yg(),Gn(i),null;case 19:if(Me(Ue),A=i.memoizedState,A===null)return Gn(i),null;if(d=(i.flags&128)!==0,_=A.rendering,_===null)if(d)$d(A,!1);else{if(dn!==0||s!==null&&(s.flags&128)!==0)for(s=i.child;s!==null;){if(_=om(s),_!==null){for(i.flags|=128,$d(A,!1),d=_.updateQueue,d!==null&&(i.updateQueue=d,i.flags|=4),i.subtreeFlags=0,d=c,c=i.child;c!==null;)A=c,s=d,A.flags&=14680066,_=A.alternate,_===null?(A.childLanes=0,A.lanes=s,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=_.childLanes,A.lanes=_.lanes,A.child=_.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=_.memoizedProps,A.memoizedState=_.memoizedState,A.updateQueue=_.updateQueue,A.type=_.type,s=_.dependencies,A.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return ke(Ue,Ue.current&1|2),i.child}s=s.sibling}A.tail!==null&&Ne()>gu&&(i.flags|=128,d=!0,$d(A,!1),i.lanes=4194304)}else{if(!d)if(s=om(_),s!==null){if(i.flags|=128,d=!0,c=s.updateQueue,c!==null&&(i.updateQueue=c,i.flags|=4),$d(A,!0),A.tail===null&&A.tailMode==="hidden"&&!_.alternate&&!Ie)return Gn(i),null}else 2*Ne()-A.renderingStartTime>gu&&c!==1073741824&&(i.flags|=128,d=!0,$d(A,!1),i.lanes=4194304);A.isBackwards?(_.sibling=i.child,i.child=_):(c=A.last,c!==null?c.sibling=_:i.child=_,A.last=_)}return A.tail!==null?(i=A.tail,A.rendering=i,A.tail=i.sibling,A.renderingStartTime=Ne(),i.sibling=null,c=Ue.current,ke(Ue,d?c&1|2:c&1),i):(Gn(i),null);case 22:case 23:return Fv(),d=i.memoizedState!==null,s!==null&&s.memoizedState!==null!==d&&(i.flags|=8192),d&&(i.mode&1)!==0?(Os&1073741824)!==0&&(Gn(i),i.subtreeFlags&6&&(i.flags|=8192)):Gn(i),null;case 24:return null;case 25:return null}throw Error(e(156,i.tag))}function I_(s,i){switch(V0(i),i.tag){case 1:return ys(i.type)&&Yg(),s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 3:return hu(),Me(ms),Me(Wn),iv(),s=i.flags,(s&65536)!==0&&(s&128)===0?(i.flags=s&-65537|128,i):null;case 5:return nv(i),null;case 13:if(Me(Ue),s=i.memoizedState,s!==null&&s.dehydrated!==null){if(i.alternate===null)throw Error(e(340));au()}return s=i.flags,s&65536?(i.flags=s&-65537|128,i):null;case 19:return Me(Ue),null;case 4:return hu(),null;case 10:return Q0(i.type._context),null;case 22:case 23:return Fv(),null;case 24:return null;default:return null}}var gm=!1,Xn=!1,F_=typeof WeakSet=="function"?WeakSet:Set,pt=null;function fu(s,i){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(d){Ve(s,i,d)}else c.current=null}function Ev(s,i,c){try{c()}catch(d){Ve(s,i,d)}}var Kb=!1;function O_(s,i){if(F0=Ig,s=TS(),T0(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else t:{c=(c=s.ownerDocument)&&c.defaultView||window;var d=c.getSelection&&c.getSelection();if(d&&d.rangeCount!==0){c=d.anchorNode;var m=d.anchorOffset,A=d.focusNode;d=d.focusOffset;try{c.nodeType,A.nodeType}catch{c=null;break t}var _=0,R=-1,N=-1,j=0,q=0,Q=s,X=null;e:for(;;){for(var ct;Q!==c||m!==0&&Q.nodeType!==3||(R=_+m),Q!==A||d!==0&&Q.nodeType!==3||(N=_+d),Q.nodeType===3&&(_+=Q.nodeValue.length),(ct=Q.firstChild)!==null;)X=Q,Q=ct;for(;;){if(Q===s)break e;if(X===c&&++j===m&&(R=_),X===A&&++q===d&&(N=_),(ct=Q.nextSibling)!==null)break;Q=X,X=Q.parentNode}Q=ct}c=R===-1||N===-1?null:{start:R,end:N}}else c=null}c=c||{start:0,end:0}}else c=null;for(O0={focusedElem:s,selectionRange:c},Ig=!1,pt=i;pt!==null;)if(i=pt,s=i.child,(i.subtreeFlags&1028)!==0&&s!==null)s.return=i,pt=s;else for(;pt!==null;){i=pt;try{var mt=i.alternate;if((i.flags&1024)!==0)switch(i.tag){case 0:case 11:case 15:break;case 1:if(mt!==null){var yt=mt.memoizedProps,en=mt.memoizedState,B=i.stateNode,F=B.getSnapshotBeforeUpdate(i.elementType===i.type?yt:Fi(i.type,yt),en);B.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var z=i.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(e(163))}}catch(J){Ve(i,i.return,J)}if(s=i.sibling,s!==null){s.return=i.return,pt=s;break}pt=i.return}return mt=Kb,Kb=!1,mt}function Wd(s,i,c){var d=i.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&s)===s){var A=m.destroy;m.destroy=void 0,A!==void 0&&Ev(i,c,A)}m=m.next}while(m!==d)}}function mm(s,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var c=i=i.next;do{if((c.tag&s)===s){var d=c.create;c.destroy=d()}c=c.next}while(c!==i)}}function Cv(s){var i=s.ref;if(i!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof i=="function"?i(s):i.current=s}}function Qb(s){var i=s.alternate;i!==null&&(s.alternate=null,Qb(i)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(i=s.stateNode,i!==null&&(delete i[sr],delete i[Dd],delete i[j0],delete i[w_],delete i[A_])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Zb(s){return s.tag===5||s.tag===3||s.tag===4}function Jb(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||Zb(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function _v(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?c.nodeType===8?c.parentNode.insertBefore(s,i):c.insertBefore(s,i):(c.nodeType===8?(i=c.parentNode,i.insertBefore(s,c)):(i=c,i.appendChild(s)),c=c._reactRootContainer,c!=null||i.onclick!==null||(i.onclick=Xg));else if(d!==4&&(s=s.child,s!==null))for(_v(s,i,c),s=s.sibling;s!==null;)_v(s,i,c),s=s.sibling}function kv(s,i,c){var d=s.tag;if(d===5||d===6)s=s.stateNode,i?c.insertBefore(s,i):c.appendChild(s);else if(d!==4&&(s=s.child,s!==null))for(kv(s,i,c),s=s.sibling;s!==null;)kv(s,i,c),s=s.sibling}var Mn=null,Oi=!1;function na(s,i,c){for(c=c.child;c!==null;)t1(s,i,c),c=c.sibling}function t1(s,i,c){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(Ze,c)}catch{}switch(c.tag){case 5:Xn||fu(c,i);case 6:var d=Mn,m=Oi;Mn=null,na(s,i,c),Mn=d,Oi=m,Mn!==null&&(Oi?(s=Mn,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):Mn.removeChild(c.stateNode));break;case 18:Mn!==null&&(Oi?(s=Mn,c=c.stateNode,s.nodeType===8?z0(s.parentNode,c):s.nodeType===1&&z0(s,c),bd(s)):z0(Mn,c.stateNode));break;case 4:d=Mn,m=Oi,Mn=c.stateNode.containerInfo,Oi=!0,na(s,i,c),Mn=d,Oi=m;break;case 0:case 11:case 14:case 15:if(!Xn&&(d=c.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var A=m,_=A.destroy;A=A.tag,_!==void 0&&((A&2)!==0||(A&4)!==0)&&Ev(c,i,_),m=m.next}while(m!==d)}na(s,i,c);break;case 1:if(!Xn&&(fu(c,i),d=c.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=c.memoizedProps,d.state=c.memoizedState,d.componentWillUnmount()}catch(R){Ve(c,i,R)}na(s,i,c);break;case 21:na(s,i,c);break;case 22:c.mode&1?(Xn=(d=Xn)||c.memoizedState!==null,na(s,i,c),Xn=d):na(s,i,c);break;default:na(s,i,c)}}function e1(s){var i=s.updateQueue;if(i!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new F_),i.forEach(function(d){var m=G_.bind(null,s,d);c.has(d)||(c.add(d),d.then(m,m))})}}function Bi(s,i){var c=i.deletions;if(c!==null)for(var d=0;d<c.length;d++){var m=c[d];try{var A=s,_=i,R=_;t:for(;R!==null;){switch(R.tag){case 5:Mn=R.stateNode,Oi=!1;break t;case 3:Mn=R.stateNode.containerInfo,Oi=!0;break t;case 4:Mn=R.stateNode.containerInfo,Oi=!0;break t}R=R.return}if(Mn===null)throw Error(e(160));t1(A,_,m),Mn=null,Oi=!1;var N=m.alternate;N!==null&&(N.return=null),m.return=null}catch(j){Ve(m,i,j)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)n1(i,s),i=i.sibling}function n1(s,i){var c=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Bi(i,s),or(s),d&4){try{Wd(3,s,s.return),mm(3,s)}catch(yt){Ve(s,s.return,yt)}try{Wd(5,s,s.return)}catch(yt){Ve(s,s.return,yt)}}break;case 1:Bi(i,s),or(s),d&512&&c!==null&&fu(c,c.return);break;case 5:if(Bi(i,s),or(s),d&512&&c!==null&&fu(c,c.return),s.flags&32){var m=s.stateNode;try{Ho(m,"")}catch(yt){Ve(s,s.return,yt)}}if(d&4&&(m=s.stateNode,m!=null)){var A=s.memoizedProps,_=c!==null?c.memoizedProps:A,R=s.type,N=s.updateQueue;if(s.updateQueue=null,N!==null)try{R==="input"&&A.type==="radio"&&A.name!=null&&rd(m,A),W(R,_);var j=W(R,A);for(_=0;_<N.length;_+=2){var q=N[_],Q=N[_+1];q==="style"?Tg(m,Q):q==="dangerouslySetInnerHTML"?ud(m,Q):q==="children"?Ho(m,Q):P(m,q,Q,j)}switch(R){case"input":Uo(m,A);break;case"textarea":ad(m,A);break;case"select":var X=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!A.multiple;var ct=A.value;ct!=null?jo(m,!!A.multiple,ct,!1):X!==!!A.multiple&&(A.defaultValue!=null?jo(m,!!A.multiple,A.defaultValue,!0):jo(m,!!A.multiple,A.multiple?[]:"",!1))}m[Dd]=A}catch(yt){Ve(s,s.return,yt)}}break;case 6:if(Bi(i,s),or(s),d&4){if(s.stateNode===null)throw Error(e(162));m=s.stateNode,A=s.memoizedProps;try{m.nodeValue=A}catch(yt){Ve(s,s.return,yt)}}break;case 3:if(Bi(i,s),or(s),d&4&&c!==null&&c.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch(yt){Ve(s,s.return,yt)}break;case 4:Bi(i,s),or(s);break;case 13:Bi(i,s),or(s),m=s.child,m.flags&8192&&(A=m.memoizedState!==null,m.stateNode.isHidden=A,!A||m.alternate!==null&&m.alternate.memoizedState!==null||(Rv=Ne())),d&4&&e1(s);break;case 22:if(q=c!==null&&c.memoizedState!==null,s.mode&1?(Xn=(j=Xn)||q,Bi(i,s),Xn=j):Bi(i,s),or(s),d&8192){if(j=s.memoizedState!==null,(s.stateNode.isHidden=j)&&!q&&(s.mode&1)!==0)for(pt=s,q=s.child;q!==null;){for(Q=pt=q;pt!==null;){switch(X=pt,ct=X.child,X.tag){case 0:case 11:case 14:case 15:Wd(4,X,X.return);break;case 1:fu(X,X.return);var mt=X.stateNode;if(typeof mt.componentWillUnmount=="function"){d=X,c=X.return;try{i=d,mt.props=i.memoizedProps,mt.state=i.memoizedState,mt.componentWillUnmount()}catch(yt){Ve(d,c,yt)}}break;case 5:fu(X,X.return);break;case 22:if(X.memoizedState!==null){r1(Q);continue}}ct!==null?(ct.return=X,pt=ct):r1(Q)}q=q.sibling}t:for(q=null,Q=s;;){if(Q.tag===5){if(q===null){q=Q;try{m=Q.stateNode,j?(A=m.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(R=Q.stateNode,N=Q.memoizedProps.style,_=N!=null&&N.hasOwnProperty("display")?N.display:null,R.style.display=hd("display",_))}catch(yt){Ve(s,s.return,yt)}}}else if(Q.tag===6){if(q===null)try{Q.stateNode.nodeValue=j?"":Q.memoizedProps}catch(yt){Ve(s,s.return,yt)}}else if((Q.tag!==22&&Q.tag!==23||Q.memoizedState===null||Q===s)&&Q.child!==null){Q.child.return=Q,Q=Q.child;continue}if(Q===s)break t;for(;Q.sibling===null;){if(Q.return===null||Q.return===s)break t;q===Q&&(q=null),Q=Q.return}q===Q&&(q=null),Q.sibling.return=Q.return,Q=Q.sibling}}break;case 19:Bi(i,s),or(s),d&4&&e1(s);break;case 21:break;default:Bi(i,s),or(s)}}function or(s){var i=s.flags;if(i&2){try{t:{for(var c=s.return;c!==null;){if(Zb(c)){var d=c;break t}c=c.return}throw Error(e(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(Ho(m,""),d.flags&=-33);var A=Jb(s);kv(s,A,m);break;case 3:case 4:var _=d.stateNode.containerInfo,R=Jb(s);_v(s,R,_);break;default:throw Error(e(161))}}catch(N){Ve(s,s.return,N)}s.flags&=-3}i&4096&&(s.flags&=-4097)}function B_(s,i,c){pt=s,s1(s)}function s1(s,i,c){for(var d=(s.mode&1)!==0;pt!==null;){var m=pt,A=m.child;if(m.tag===22&&d){var _=m.memoizedState!==null||gm;if(!_){var R=m.alternate,N=R!==null&&R.memoizedState!==null||Xn;R=gm;var j=Xn;if(gm=_,(Xn=N)&&!j)for(pt=m;pt!==null;)_=pt,N=_.child,_.tag===22&&_.memoizedState!==null?o1(m):N!==null?(N.return=_,pt=N):o1(m);for(;A!==null;)pt=A,s1(A),A=A.sibling;pt=m,gm=R,Xn=j}i1(s)}else(m.subtreeFlags&8772)!==0&&A!==null?(A.return=m,pt=A):i1(s)}}function i1(s){for(;pt!==null;){var i=pt;if((i.flags&8772)!==0){var c=i.alternate;try{if((i.flags&8772)!==0)switch(i.tag){case 0:case 11:case 15:Xn||mm(5,i);break;case 1:var d=i.stateNode;if(i.flags&4&&!Xn)if(c===null)d.componentDidMount();else{var m=i.elementType===i.type?c.memoizedProps:Fi(i.type,c.memoizedProps);d.componentDidUpdate(m,c.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var A=i.updateQueue;A!==null&&rb(i,A,d);break;case 3:var _=i.updateQueue;if(_!==null){if(c=null,i.child!==null)switch(i.child.tag){case 5:c=i.child.stateNode;break;case 1:c=i.child.stateNode}rb(i,_,c)}break;case 5:var R=i.stateNode;if(c===null&&i.flags&4){c=R;var N=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&c.focus();break;case"img":N.src&&(c.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var j=i.alternate;if(j!==null){var q=j.memoizedState;if(q!==null){var Q=q.dehydrated;Q!==null&&bd(Q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(e(163))}Xn||i.flags&512&&Cv(i)}catch(X){Ve(i,i.return,X)}}if(i===s){pt=null;break}if(c=i.sibling,c!==null){c.return=i.return,pt=c;break}pt=i.return}}function r1(s){for(;pt!==null;){var i=pt;if(i===s){pt=null;break}var c=i.sibling;if(c!==null){c.return=i.return,pt=c;break}pt=i.return}}function o1(s){for(;pt!==null;){var i=pt;try{switch(i.tag){case 0:case 11:case 15:var c=i.return;try{mm(4,i)}catch(N){Ve(i,c,N)}break;case 1:var d=i.stateNode;if(typeof d.componentDidMount=="function"){var m=i.return;try{d.componentDidMount()}catch(N){Ve(i,m,N)}}var A=i.return;try{Cv(i)}catch(N){Ve(i,A,N)}break;case 5:var _=i.return;try{Cv(i)}catch(N){Ve(i,_,N)}}}catch(N){Ve(i,i.return,N)}if(i===s){pt=null;break}var R=i.sibling;if(R!==null){R.return=i.return,pt=R;break}pt=i.return}}var U_=Math.ceil,ym=M.ReactCurrentDispatcher,Tv=M.ReactCurrentOwner,di=M.ReactCurrentBatchConfig,te=0,bn=null,on=null,Dn=0,Os=0,pu=Qo(0),dn=0,Vd=null,gl=0,vm=0,Pv=0,Gd=null,ws=null,Rv=0,gu=1/0,Vr=null,wm=!1,Lv=null,sa=null,Am=!1,ia=null,Sm=0,Xd=0,Mv=null,bm=-1,xm=0;function is(){return(te&6)!==0?Ne():bm!==-1?bm:bm=Ne()}function ra(s){return(s.mode&1)===0?1:(te&2)!==0&&Dn!==0?Dn&-Dn:b_.transition!==null?(xm===0&&(xm=JA()),xm):(s=de,s!==0||(s=window.event,s=s===void 0?16:lS(s.type)),s)}function Ui(s,i,c,d){if(50<Xd)throw Xd=0,Mv=null,Error(e(185));yd(s,c,d),((te&2)===0||s!==bn)&&(s===bn&&((te&2)===0&&(vm|=c),dn===4&&oa(s,Dn)),As(s,d),c===1&&te===0&&(i.mode&1)===0&&(gu=Ne()+500,Qg&&Jo()))}function As(s,i){var c=s.callbackNode;bC(s,i);var d=Mg(s,s===bn?Dn:0);if(d===0)c!==null&&pd(c),s.callbackNode=null,s.callbackPriority=0;else if(i=d&-d,s.callbackPriority!==i){if(c!=null&&pd(c),i===1)s.tag===0?S_(l1.bind(null,s)):XS(l1.bind(null,s)),y_(function(){(te&6)===0&&Jo()}),c=null;else{switch(tS(d)){case 1:c=al;break;case 4:c=gd;break;case 16:c=it;break;case 536870912:c=ie;break;default:c=it}c=m1(c,a1.bind(null,s))}s.callbackPriority=i,s.callbackNode=c}}function a1(s,i){if(bm=-1,xm=0,(te&6)!==0)throw Error(e(327));var c=s.callbackNode;if(mu()&&s.callbackNode!==c)return null;var d=Mg(s,s===bn?Dn:0);if(d===0)return null;if((d&30)!==0||(d&s.expiredLanes)!==0||i)i=Em(s,d);else{i=d;var m=te;te|=2;var A=u1();(bn!==s||Dn!==i)&&(Vr=null,gu=Ne()+500,yl(s,i));do try{H_();break}catch(R){c1(s,R)}while(!0);K0(),ym.current=A,te=m,on!==null?i=0:(bn=null,Dn=0,i=dn)}if(i!==0){if(i===2&&(m=d0(s),m!==0&&(d=m,i=Dv(s,m))),i===1)throw c=Vd,yl(s,0),oa(s,d),As(s,Ne()),c;if(i===6)oa(s,d);else{if(m=s.current.alternate,(d&30)===0&&!z_(m)&&(i=Em(s,d),i===2&&(A=d0(s),A!==0&&(d=A,i=Dv(s,A))),i===1))throw c=Vd,yl(s,0),oa(s,d),As(s,Ne()),c;switch(s.finishedWork=m,s.finishedLanes=d,i){case 0:case 1:throw Error(e(345));case 2:vl(s,ws,Vr);break;case 3:if(oa(s,d),(d&130023424)===d&&(i=Rv+500-Ne(),10<i)){if(Mg(s,0)!==0)break;if(m=s.suspendedLanes,(m&d)!==d){is(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=U0(vl.bind(null,s,ws,Vr),i);break}vl(s,ws,Vr);break;case 4:if(oa(s,d),(d&4194240)===d)break;for(i=s.eventTimes,m=-1;0<d;){var _=31-tn(d);A=1<<_,_=i[_],_>m&&(m=_),d&=~A}if(d=m,d=Ne()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*U_(d/1960))-d,10<d){s.timeoutHandle=U0(vl.bind(null,s,ws,Vr),d);break}vl(s,ws,Vr);break;case 5:vl(s,ws,Vr);break;default:throw Error(e(329))}}}return As(s,Ne()),s.callbackNode===c?a1.bind(null,s):null}function Dv(s,i){var c=Gd;return s.current.memoizedState.isDehydrated&&(yl(s,i).flags|=256),s=Em(s,i),s!==2&&(i=ws,ws=c,i!==null&&Nv(i)),s}function Nv(s){ws===null?ws=s:ws.push.apply(ws,s)}function z_(s){for(var i=s;;){if(i.flags&16384){var c=i.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var d=0;d<c.length;d++){var m=c[d],A=m.getSnapshot;m=m.value;try{if(!Ni(A(),m))return!1}catch{return!1}}}if(c=i.child,i.subtreeFlags&16384&&c!==null)c.return=i,i=c;else{if(i===s)break;for(;i.sibling===null;){if(i.return===null||i.return===s)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function oa(s,i){for(i&=~Pv,i&=~vm,s.suspendedLanes|=i,s.pingedLanes&=~i,s=s.expirationTimes;0<i;){var c=31-tn(i),d=1<<c;s[c]=-1,i&=~d}}function l1(s){if((te&6)!==0)throw Error(e(327));mu();var i=Mg(s,0);if((i&1)===0)return As(s,Ne()),null;var c=Em(s,i);if(s.tag!==0&&c===2){var d=d0(s);d!==0&&(i=d,c=Dv(s,d))}if(c===1)throw c=Vd,yl(s,0),oa(s,i),As(s,Ne()),c;if(c===6)throw Error(e(345));return s.finishedWork=s.current.alternate,s.finishedLanes=i,vl(s,ws,Vr),As(s,Ne()),null}function Iv(s,i){var c=te;te|=1;try{return s(i)}finally{te=c,te===0&&(gu=Ne()+500,Qg&&Jo())}}function ml(s){ia!==null&&ia.tag===0&&(te&6)===0&&mu();var i=te;te|=1;var c=di.transition,d=de;try{if(di.transition=null,de=1,s)return s()}finally{de=d,di.transition=c,te=i,(te&6)===0&&Jo()}}function Fv(){Os=pu.current,Me(pu)}function yl(s,i){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,m_(c)),on!==null)for(c=on.return;c!==null;){var d=c;switch(V0(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&Yg();break;case 3:hu(),Me(ms),Me(Wn),iv();break;case 5:nv(d);break;case 4:hu();break;case 13:Me(Ue);break;case 19:Me(Ue);break;case 10:Q0(d.type._context);break;case 22:case 23:Fv()}c=c.return}if(bn=s,on=s=aa(s.current,null),Dn=Os=i,dn=0,Vd=null,Pv=vm=gl=0,ws=Gd=null,dl!==null){for(i=0;i<dl.length;i++)if(c=dl[i],d=c.interleaved,d!==null){c.interleaved=null;var m=d.next,A=c.pending;if(A!==null){var _=A.next;A.next=m,d.next=_}c.pending=d}dl=null}return s}function c1(s,i){do{var c=on;try{if(K0(),am.current=hm,lm){for(var d=ze.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}lm=!1}if(pl=0,Sn=hn=ze=null,Ud=!1,zd=0,Tv.current=null,c===null||c.return===null){dn=1,Vd=i,on=null;break}t:{var A=s,_=c.return,R=c,N=i;if(i=Dn,R.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var j=N,q=R,Q=q.tag;if((q.mode&1)===0&&(Q===0||Q===11||Q===15)){var X=q.alternate;X?(q.updateQueue=X.updateQueue,q.memoizedState=X.memoizedState,q.lanes=X.lanes):(q.updateQueue=null,q.memoizedState=null)}var ct=Nb(_);if(ct!==null){ct.flags&=-257,Ib(ct,_,R,A,i),ct.mode&1&&Db(A,j,i),i=ct,N=j;var mt=i.updateQueue;if(mt===null){var yt=new Set;yt.add(N),i.updateQueue=yt}else mt.add(N);break t}else{if((i&1)===0){Db(A,j,i),Ov();break t}N=Error(e(426))}}else if(Ie&&R.mode&1){var en=Nb(_);if(en!==null){(en.flags&65536)===0&&(en.flags|=256),Ib(en,_,R,A,i),q0(du(N,R));break t}}A=N=du(N,R),dn!==4&&(dn=2),Gd===null?Gd=[A]:Gd.push(A),A=_;do{switch(A.tag){case 3:A.flags|=65536,i&=-i,A.lanes|=i;var B=Lb(A,N,i);ib(A,B);break t;case 1:R=N;var F=A.type,z=A.stateNode;if((A.flags&128)===0&&(typeof F.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(sa===null||!sa.has(z)))){A.flags|=65536,i&=-i,A.lanes|=i;var J=Mb(A,R,i);ib(A,J);break t}}A=A.return}while(A!==null)}d1(c)}catch(St){i=St,on===c&&c!==null&&(on=c=c.return);continue}break}while(!0)}function u1(){var s=ym.current;return ym.current=hm,s===null?hm:s}function Ov(){(dn===0||dn===3||dn===2)&&(dn=4),bn===null||(gl&268435455)===0&&(vm&268435455)===0||oa(bn,Dn)}function Em(s,i){var c=te;te|=2;var d=u1();(bn!==s||Dn!==i)&&(Vr=null,yl(s,i));do try{j_();break}catch(m){c1(s,m)}while(!0);if(K0(),te=c,ym.current=d,on!==null)throw Error(e(261));return bn=null,Dn=0,dn}function j_(){for(;on!==null;)h1(on)}function H_(){for(;on!==null&&!ns();)h1(on)}function h1(s){var i=g1(s.alternate,s,Os);s.memoizedProps=s.pendingProps,i===null?d1(s):on=i,Tv.current=null}function d1(s){var i=s;do{var c=i.alternate;if(s=i.return,(i.flags&32768)===0){if(c=N_(c,i,Os),c!==null){on=c;return}}else{if(c=I_(c,i),c!==null){c.flags&=32767,on=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{dn=6,on=null;return}}if(i=i.sibling,i!==null){on=i;return}on=i=s}while(i!==null);dn===0&&(dn=5)}function vl(s,i,c){var d=de,m=di.transition;try{di.transition=null,de=1,$_(s,i,c,d)}finally{di.transition=m,de=d}return null}function $_(s,i,c,d){do mu();while(ia!==null);if((te&6)!==0)throw Error(e(327));c=s.finishedWork;var m=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(e(177));s.callbackNode=null,s.callbackPriority=0;var A=c.lanes|c.childLanes;if(xC(s,A),s===bn&&(on=bn=null,Dn=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||Am||(Am=!0,m1(it,function(){return mu(),null})),A=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||A){A=di.transition,di.transition=null;var _=de;de=1;var R=te;te|=4,Tv.current=null,O_(s,c),n1(c,s),c_(O0),Ig=!!F0,O0=F0=null,s.current=c,B_(c),qc(),te=R,de=_,di.transition=A}else s.current=c;if(Am&&(Am=!1,ia=s,Sm=m),A=s.pendingLanes,A===0&&(sa=null),rn(c.stateNode),As(s,Ne()),i!==null)for(d=s.onRecoverableError,c=0;c<i.length;c++)m=i[c],d(m.value,{componentStack:m.stack,digest:m.digest});if(wm)throw wm=!1,s=Lv,Lv=null,s;return(Sm&1)!==0&&s.tag!==0&&mu(),A=s.pendingLanes,(A&1)!==0?s===Mv?Xd++:(Xd=0,Mv=s):Xd=0,Jo(),null}function mu(){if(ia!==null){var s=tS(Sm),i=di.transition,c=de;try{if(di.transition=null,de=16>s?16:s,ia===null)var d=!1;else{if(s=ia,ia=null,Sm=0,(te&6)!==0)throw Error(e(331));var m=te;for(te|=4,pt=s.current;pt!==null;){var A=pt,_=A.child;if((pt.flags&16)!==0){var R=A.deletions;if(R!==null){for(var N=0;N<R.length;N++){var j=R[N];for(pt=j;pt!==null;){var q=pt;switch(q.tag){case 0:case 11:case 15:Wd(8,q,A)}var Q=q.child;if(Q!==null)Q.return=q,pt=Q;else for(;pt!==null;){q=pt;var X=q.sibling,ct=q.return;if(Qb(q),q===j){pt=null;break}if(X!==null){X.return=ct,pt=X;break}pt=ct}}}var mt=A.alternate;if(mt!==null){var yt=mt.child;if(yt!==null){mt.child=null;do{var en=yt.sibling;yt.sibling=null,yt=en}while(yt!==null)}}pt=A}}if((A.subtreeFlags&2064)!==0&&_!==null)_.return=A,pt=_;else t:for(;pt!==null;){if(A=pt,(A.flags&2048)!==0)switch(A.tag){case 0:case 11:case 15:Wd(9,A,A.return)}var B=A.sibling;if(B!==null){B.return=A.return,pt=B;break t}pt=A.return}}var F=s.current;for(pt=F;pt!==null;){_=pt;var z=_.child;if((_.subtreeFlags&2064)!==0&&z!==null)z.return=_,pt=z;else t:for(_=F;pt!==null;){if(R=pt,(R.flags&2048)!==0)try{switch(R.tag){case 0:case 11:case 15:mm(9,R)}}catch(St){Ve(R,R.return,St)}if(R===_){pt=null;break t}var J=R.sibling;if(J!==null){J.return=R.return,pt=J;break t}pt=R.return}}if(te=m,Jo(),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(Ze,s)}catch{}d=!0}return d}finally{de=c,di.transition=i}}return!1}function f1(s,i,c){i=du(c,i),i=Lb(s,i,1),s=ea(s,i,1),i=is(),s!==null&&(yd(s,1,i),As(s,i))}function Ve(s,i,c){if(s.tag===3)f1(s,s,c);else for(;i!==null;){if(i.tag===3){f1(i,s,c);break}else if(i.tag===1){var d=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(sa===null||!sa.has(d))){s=du(c,s),s=Mb(i,s,1),i=ea(i,s,1),s=is(),i!==null&&(yd(i,1,s),As(i,s));break}}i=i.return}}function W_(s,i,c){var d=s.pingCache;d!==null&&d.delete(i),i=is(),s.pingedLanes|=s.suspendedLanes&c,bn===s&&(Dn&c)===c&&(dn===4||dn===3&&(Dn&130023424)===Dn&&500>Ne()-Rv?yl(s,0):Pv|=c),As(s,i)}function p1(s,i){i===0&&((s.mode&1)===0?i=1:(i=Lg,Lg<<=1,(Lg&130023424)===0&&(Lg=4194304)));var c=is();s=Hr(s,i),s!==null&&(yd(s,i,c),As(s,c))}function V_(s){var i=s.memoizedState,c=0;i!==null&&(c=i.retryLane),p1(s,c)}function G_(s,i){var c=0;switch(s.tag){case 13:var d=s.stateNode,m=s.memoizedState;m!==null&&(c=m.retryLane);break;case 19:d=s.stateNode;break;default:throw Error(e(314))}d!==null&&d.delete(i),p1(s,c)}var g1;g1=function(s,i,c){if(s!==null)if(s.memoizedProps!==i.pendingProps||ms.current)vs=!0;else{if((s.lanes&c)===0&&(i.flags&128)===0)return vs=!1,D_(s,i,c);vs=(s.flags&131072)!==0}else vs=!1,Ie&&(i.flags&1048576)!==0&&qS(i,Jg,i.index);switch(i.lanes=0,i.tag){case 2:var d=i.type;pm(s,i),s=i.pendingProps;var m=iu(i,Wn.current);uu(i,c),m=av(null,i,d,s,m,c);var A=lv();return i.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ys(d)?(A=!0,Kg(i)):A=!1,i.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,tv(i),m.updater=dm,i.stateNode=m,m._reactInternals=i,pv(i,d,s,c),i=vv(null,i,d,!0,A,c)):(i.tag=0,Ie&&A&&W0(i),ss(null,i,m,c),i=i.child),i;case 16:d=i.elementType;t:{switch(pm(s,i),s=i.pendingProps,m=d._init,d=m(d._payload),i.type=d,m=i.tag=q_(d),s=Fi(d,s),m){case 0:i=yv(null,i,d,s,c);break t;case 1:i=jb(null,i,d,s,c);break t;case 11:i=Fb(null,i,d,s,c);break t;case 14:i=Ob(null,i,d,Fi(d.type,s),c);break t}throw Error(e(306,d,""))}return i;case 0:return d=i.type,m=i.pendingProps,m=i.elementType===d?m:Fi(d,m),yv(s,i,d,m,c);case 1:return d=i.type,m=i.pendingProps,m=i.elementType===d?m:Fi(d,m),jb(s,i,d,m,c);case 3:t:{if(Hb(i),s===null)throw Error(e(387));d=i.pendingProps,A=i.memoizedState,m=A.element,sb(s,i),rm(i,d,null,c);var _=i.memoizedState;if(d=_.element,A.isDehydrated)if(A={element:d,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},i.updateQueue.baseState=A,i.memoizedState=A,i.flags&256){m=du(Error(e(423)),i),i=$b(s,i,d,c,m);break t}else if(d!==m){m=du(Error(e(424)),i),i=$b(s,i,d,c,m);break t}else for(Fs=Ko(i.stateNode.containerInfo.firstChild),Is=i,Ie=!0,Ii=null,c=eb(i,null,d,c),i.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(au(),d===m){i=Wr(s,i,c);break t}ss(s,i,d,c)}i=i.child}return i;case 5:return ob(i),s===null&&X0(i),d=i.type,m=i.pendingProps,A=s!==null?s.memoizedProps:null,_=m.children,B0(d,m)?_=null:A!==null&&B0(d,A)&&(i.flags|=32),zb(s,i),ss(s,i,_,c),i.child;case 6:return s===null&&X0(i),null;case 13:return Wb(s,i,c);case 4:return ev(i,i.stateNode.containerInfo),d=i.pendingProps,s===null?i.child=lu(i,null,d,c):ss(s,i,d,c),i.child;case 11:return d=i.type,m=i.pendingProps,m=i.elementType===d?m:Fi(d,m),Fb(s,i,d,m,c);case 7:return ss(s,i,i.pendingProps,c),i.child;case 8:return ss(s,i,i.pendingProps.children,c),i.child;case 12:return ss(s,i,i.pendingProps.children,c),i.child;case 10:t:{if(d=i.type._context,m=i.pendingProps,A=i.memoizedProps,_=m.value,ke(nm,d._currentValue),d._currentValue=_,A!==null)if(Ni(A.value,_)){if(A.children===m.children&&!ms.current){i=Wr(s,i,c);break t}}else for(A=i.child,A!==null&&(A.return=i);A!==null;){var R=A.dependencies;if(R!==null){_=A.child;for(var N=R.firstContext;N!==null;){if(N.context===d){if(A.tag===1){N=$r(-1,c&-c),N.tag=2;var j=A.updateQueue;if(j!==null){j=j.shared;var q=j.pending;q===null?N.next=N:(N.next=q.next,q.next=N),j.pending=N}}A.lanes|=c,N=A.alternate,N!==null&&(N.lanes|=c),Z0(A.return,c,i),R.lanes|=c;break}N=N.next}}else if(A.tag===10)_=A.type===i.type?null:A.child;else if(A.tag===18){if(_=A.return,_===null)throw Error(e(341));_.lanes|=c,R=_.alternate,R!==null&&(R.lanes|=c),Z0(_,c,i),_=A.sibling}else _=A.child;if(_!==null)_.return=A;else for(_=A;_!==null;){if(_===i){_=null;break}if(A=_.sibling,A!==null){A.return=_.return,_=A;break}_=_.return}A=_}ss(s,i,m.children,c),i=i.child}return i;case 9:return m=i.type,d=i.pendingProps.children,uu(i,c),m=ui(m),d=d(m),i.flags|=1,ss(s,i,d,c),i.child;case 14:return d=i.type,m=Fi(d,i.pendingProps),m=Fi(d.type,m),Ob(s,i,d,m,c);case 15:return Bb(s,i,i.type,i.pendingProps,c);case 17:return d=i.type,m=i.pendingProps,m=i.elementType===d?m:Fi(d,m),pm(s,i),i.tag=1,ys(d)?(s=!0,Kg(i)):s=!1,uu(i,c),Pb(i,d,m),pv(i,d,m,c),vv(null,i,d,!0,s,c);case 19:return Gb(s,i,c);case 22:return Ub(s,i,c)}throw Error(e(156,i.tag))};function m1(s,i){return fd(s,i)}function X_(s,i,c,d){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fi(s,i,c,d){return new X_(s,i,c,d)}function Bv(s){return s=s.prototype,!(!s||!s.isReactComponent)}function q_(s){if(typeof s=="function")return Bv(s)?1:0;if(s!=null){if(s=s.$$typeof,s===Ct)return 11;if(s===kt)return 14}return 2}function aa(s,i){var c=s.alternate;return c===null?(c=fi(s.tag,i,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=i,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,i=s.dependencies,c.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function Cm(s,i,c,d,m,A){var _=2;if(d=s,typeof s=="function")Bv(s)&&(_=1);else if(typeof s=="string")_=5;else t:switch(s){case U:return wl(c.children,m,A,i);case $:_=8,m|=8;break;case G:return s=fi(12,c,i,m|2),s.elementType=G,s.lanes=A,s;case _t:return s=fi(13,c,i,m),s.elementType=_t,s.lanes=A,s;case wt:return s=fi(19,c,i,m),s.elementType=wt,s.lanes=A,s;case st:return _m(c,m,A,i);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case nt:_=10;break t;case et:_=9;break t;case Ct:_=11;break t;case kt:_=14;break t;case ot:_=16,d=null;break t}throw Error(e(130,s==null?s:typeof s,""))}return i=fi(_,c,i,m),i.elementType=s,i.type=d,i.lanes=A,i}function wl(s,i,c,d){return s=fi(7,s,d,i),s.lanes=c,s}function _m(s,i,c,d){return s=fi(22,s,d,i),s.elementType=st,s.lanes=c,s.stateNode={isHidden:!1},s}function Uv(s,i,c){return s=fi(6,s,null,i),s.lanes=c,s}function zv(s,i,c){return i=fi(4,s.children!==null?s.children:[],s.key,i),i.lanes=c,i.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},i}function Y_(s,i,c,d,m){this.tag=i,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=f0(0),this.expirationTimes=f0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=f0(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function jv(s,i,c,d,m,A,_,R,N){return s=new Y_(s,i,c,R,N),i===1?(i=1,A===!0&&(i|=8)):i=0,A=fi(3,null,null,i),s.current=A,A.stateNode=s,A.memoizedState={element:d,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},tv(A),s}function K_(s,i,c){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:d==null?null:""+d,children:s,containerInfo:i,implementation:c}}function y1(s){if(!s)return Zo;s=s._reactInternals;t:{if(he(s)!==s||s.tag!==1)throw Error(e(170));var i=s;do{switch(i.tag){case 3:i=i.stateNode.context;break t;case 1:if(ys(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break t}}i=i.return}while(i!==null);throw Error(e(171))}if(s.tag===1){var c=s.type;if(ys(c))return VS(s,c,i)}return i}function v1(s,i,c,d,m,A,_,R,N){return s=jv(c,d,!0,s,m,A,_,R,N),s.context=y1(null),c=s.current,d=is(),m=ra(c),A=$r(d,m),A.callback=i??null,ea(c,A,m),s.current.lanes=m,yd(s,m,d),As(s,d),s}function km(s,i,c,d){var m=i.current,A=is(),_=ra(m);return c=y1(c),i.context===null?i.context=c:i.pendingContext=c,i=$r(A,_),i.payload={element:s},d=d===void 0?null:d,d!==null&&(i.callback=d),s=ea(m,i,_),s!==null&&(Ui(s,m,_,A),im(s,m,_)),_}function Tm(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function w1(s,i){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<i?c:i}}function Hv(s,i){w1(s,i),(s=s.alternate)&&w1(s,i)}function Q_(){return null}var A1=typeof reportError=="function"?reportError:function(s){console.error(s)};function $v(s){this._internalRoot=s}Pm.prototype.render=$v.prototype.render=function(s){var i=this._internalRoot;if(i===null)throw Error(e(409));km(s,i,null,null)},Pm.prototype.unmount=$v.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var i=s.containerInfo;ml(function(){km(null,s,null,null)}),i[Br]=null}};function Pm(s){this._internalRoot=s}Pm.prototype.unstable_scheduleHydration=function(s){if(s){var i=sS();s={blockedOn:null,target:s,priority:i};for(var c=0;c<Xo.length&&i!==0&&i<Xo[c].priority;c++);Xo.splice(c,0,s),c===0&&oS(s)}};function Wv(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Rm(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function S1(){}function Z_(s,i,c,d,m){if(m){if(typeof d=="function"){var A=d;d=function(){var j=Tm(_);A.call(j)}}var _=v1(i,d,s,0,null,!1,!1,"",S1);return s._reactRootContainer=_,s[Br]=_.current,Ld(s.nodeType===8?s.parentNode:s),ml(),_}for(;m=s.lastChild;)s.removeChild(m);if(typeof d=="function"){var R=d;d=function(){var j=Tm(N);R.call(j)}}var N=jv(s,0,!1,null,null,!1,!1,"",S1);return s._reactRootContainer=N,s[Br]=N.current,Ld(s.nodeType===8?s.parentNode:s),ml(function(){km(i,N,c,d)}),N}function Lm(s,i,c,d,m){var A=c._reactRootContainer;if(A){var _=A;if(typeof m=="function"){var R=m;m=function(){var N=Tm(_);R.call(N)}}km(i,_,s,m)}else _=Z_(c,i,s,m,d);return Tm(_)}eS=function(s){switch(s.tag){case 3:var i=s.stateNode;if(i.current.memoizedState.isDehydrated){var c=md(i.pendingLanes);c!==0&&(p0(i,c|1),As(i,Ne()),(te&6)===0&&(gu=Ne()+500,Jo()))}break;case 13:ml(function(){var d=Hr(s,1);if(d!==null){var m=is();Ui(d,s,1,m)}}),Hv(s,1)}},g0=function(s){if(s.tag===13){var i=Hr(s,134217728);if(i!==null){var c=is();Ui(i,s,134217728,c)}Hv(s,134217728)}},nS=function(s){if(s.tag===13){var i=ra(s),c=Hr(s,i);if(c!==null){var d=is();Ui(c,s,i,d)}Hv(s,i)}},sS=function(){return de},iS=function(s,i){var c=de;try{return de=s,i()}finally{de=c}},Vt=function(s,i,c){switch(i){case"input":if(Uo(s,c),i=c.name,c.type==="radio"&&i!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<c.length;i++){var d=c[i];if(d!==s&&d.form===s.form){var m=qg(d);if(!m)throw Error(e(90));Li(d),Uo(d,m)}}}break;case"textarea":ad(s,c);break;case"select":i=c.value,i!=null&&jo(s,!!c.multiple,i,!1)}},At=Iv,Ft=ml;var J_={usingClientEntryPoint:!1,Events:[Nd,nu,qg,_e,se,Iv]},qd={findFiberByHostInstance:ll,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tk={bundleType:qd.bundleType,version:qd.version,rendererPackageName:qd.rendererPackageName,rendererConfig:qd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=dd(s),s===null?null:s.stateNode},findFiberByHostInstance:qd.findFiberByHostInstance||Q_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mm.isDisabled&&Mm.supportsFiber)try{Ze=Mm.inject(tk),Je=Mm}catch{}}return Ss.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J_,Ss.createPortal=function(s,i){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wv(i))throw Error(e(200));return K_(s,i,null,c)},Ss.createRoot=function(s,i){if(!Wv(s))throw Error(e(299));var c=!1,d="",m=A1;return i!=null&&(i.unstable_strictMode===!0&&(c=!0),i.identifierPrefix!==void 0&&(d=i.identifierPrefix),i.onRecoverableError!==void 0&&(m=i.onRecoverableError)),i=jv(s,1,!1,null,null,c,!1,d,m),s[Br]=i.current,Ld(s.nodeType===8?s.parentNode:s),new $v(i)},Ss.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var i=s._reactInternals;if(i===void 0)throw typeof s.render=="function"?Error(e(188)):(s=Object.keys(s).join(","),Error(e(268,s)));return s=dd(i),s=s===null?null:s.stateNode,s},Ss.flushSync=function(s){return ml(s)},Ss.hydrate=function(s,i,c){if(!Rm(i))throw Error(e(200));return Lm(null,s,i,!0,c)},Ss.hydrateRoot=function(s,i,c){if(!Wv(s))throw Error(e(405));var d=c!=null&&c.hydratedSources||null,m=!1,A="",_=A1;if(c!=null&&(c.unstable_strictMode===!0&&(m=!0),c.identifierPrefix!==void 0&&(A=c.identifierPrefix),c.onRecoverableError!==void 0&&(_=c.onRecoverableError)),i=v1(i,null,s,1,c??null,m,!1,A,_),s[Br]=i.current,Ld(s),d)for(s=0;s<d.length;s++)c=d[s],m=c._getVersion,m=m(c._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[c,m]:i.mutableSourceEagerHydrationData.push(c,m);return new Pm(i)},Ss.render=function(s,i,c){if(!Rm(i))throw Error(e(200));return Lm(null,s,i,!1,c)},Ss.unmountComponentAtNode=function(s){if(!Rm(s))throw Error(e(40));return s._reactRootContainer?(ml(function(){Lm(null,null,s,!1,function(){s._reactRootContainer=null,s[Br]=null})}),!0):!1},Ss.unstable_batchedUpdates=Iv,Ss.unstable_renderSubtreeIntoContainer=function(s,i,c,d){if(!Rm(c))throw Error(e(200));if(s==null||s._reactInternals===void 0)throw Error(e(38));return Lm(s,i,c,!1,d)},Ss.version="18.3.1-next-f1338f8080-20240426",Ss}var R1;function hk(){if(R1)return qv.exports;R1=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),qv.exports=uk(),qv.exports}var L1;function dk(){if(L1)return Dm;L1=1;var g=hk();return Dm.createRoot=g.createRoot,Dm.hydrateRoot=g.hydrateRoot,Dm}var fk=dk();const pk=lx(fk),us=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),aw=[.001,0,0,.001,0,0],Qv=1.35,ii={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},ua={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},xf="pdfjs_internal_editor_",jt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Qt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},gk={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},lw={TRIANGLES:1,LATTICE:2},pn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},$m={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},ln={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},vu={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},n0={ERRORS:0,WARNINGS:1,INFOS:5},Ef={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Kd={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},mk={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let s0=n0.WARNINGS;function yk(g){Number.isInteger(g)&&(s0=g)}function vk(){return s0}function i0(g){s0>=n0.INFOS&&console.info(`Info: ${g}`)}function Bt(g){s0>=n0.WARNINGS&&console.warn(`Warning: ${g}`)}function Ee(g){throw new Error(g)}function Zt(g,t){g||Ee(t)}function wk(g){switch(g==null?void 0:g.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function cx(g,t=null,e=null){if(!g)return null;if(e&&typeof g=="string"){if(e.addDefaultProtocol&&g.startsWith("www.")){const r=g.match(/\./g);(r==null?void 0:r.length)>=2&&(g=`http://${g}`)}if(e.tryConvertEncoding)try{g=Ek(g)}catch{}}const n=t?URL.parse(g,t):URL.parse(g);return wk(n)?n:null}function ux(g,t,e=!1){const n=URL.parse(g);return n?(n.hash=t,n.href):e&&cx(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function Ut(g,t,e,n=!1){return Object.defineProperty(g,t,{value:e,enumerable:!n,configurable:!0,writable:!1}),e}const Wc=(function(){function t(e,n){this.message=e,this.name=n}return t.prototype=new Error,t.constructor=t,t})();class M1 extends Wc{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Zv extends Wc{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class cw extends Wc{constructor(t){super(t,"InvalidPDFException")}}class xy extends Wc{constructor(t,e,n){super(t,"ResponseException"),this.status=e,this.missing=n}}class Ak extends Wc{constructor(t){super(t,"FormatError")}}class el extends Wc{constructor(t){super(t,"AbortException")}}function hx(g){(typeof g!="object"||(g==null?void 0:g.length)===void 0)&&Ee("Invalid argument for bytesToString");const t=g.length,e=8192;if(t<e)return String.fromCharCode.apply(null,g);const n=[];for(let r=0;r<t;r+=e){const a=Math.min(r+e,t),l=g.subarray(r,a);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function vg(g){typeof g!="string"&&Ee("Invalid argument for stringToBytes");const t=g.length,e=new Uint8Array(t);for(let n=0;n<t;++n)e[n]=g.charCodeAt(n)&255;return e}function Sk(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function bk(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function xk(){try{return new Function(""),!0}catch{return!1}}class wn{static get isLittleEndian(){return Ut(this,"isLittleEndian",bk())}static get isEvalSupported(){return Ut(this,"isEvalSupported",xk())}static get isOffscreenCanvasSupported(){return Ut(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ut(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Ut(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Ut(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return Ut(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){var t,e;return Ut(this,"isCSSRoundSupported",(e=(t=globalThis.CSS)==null?void 0:t.supports)==null?void 0:e.call(t,"width: round(1.5px, 1px)"))}}const Jv=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));var Do,Wm,uw;class at{static makeHexColor(t,e,n){return`#${Jv[t]}${Jv[e]}${Jv[n]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let n;t[0]?(t[0]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[3],e[3]*=t[3]):(n=e[0],e[0]=e[1],e[1]=n,n=e[2],e[2]=e[3],e[3]=n,t[1]<0&&(n=e[1],e[1]=e[3],e[3]=n),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(n=e[0],e[0]=e[2],e[2]=n),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,n=0){const r=t[n],a=t[n+1];t[n]=r*e[0]+a*e[2]+e[4],t[n+1]=r*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,n=0){const r=e[0],a=e[1],l=e[2],u=e[3],h=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[n+p],v=t[n+p+1];t[n+p]=y*r+v*l+h,t[n+p+1]=y*a+v*u+f}}static applyInverseTransform(t,e){const n=t[0],r=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(n*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-n*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,n){const r=e[0],a=e[1],l=e[2],u=e[3],h=e[4],f=e[5],p=t[0],y=t[1],v=t[2],S=t[3];let C=r*p+h,E=C,k=r*v+h,T=k,L=u*y+f,P=L,M=u*S+f,D=M;if(a!==0||l!==0){const I=a*p,U=a*v,$=l*y,G=l*S;C+=$,T+=$,k+=G,E+=G,L+=I,D+=I,M+=U,P+=U}n[0]=Math.min(n[0],C,k,E,T),n[1]=Math.min(n[1],L,M,P,D),n[2]=Math.max(n[2],C,k,E,T),n[3]=Math.max(n[3],L,M,P,D)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const n=t[0],r=t[1],a=t[2],l=t[3],u=n**2+r**2,h=n*a+r*l,f=a**2+l**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-h**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const n=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(n>r)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[n,a,r,l]}static pointBoundingBox(t,e,n){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}static rectBoundingBox(t,e,n,r,a){a[0]=Math.min(a[0],t,n),a[1]=Math.min(a[1],e,r),a[2]=Math.max(a[2],t,n),a[3]=Math.max(a[3],e,r)}static bezierBoundingBox(t,e,n,r,a,l,u,h,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,h),x(this,Do,uw).call(this,t,n,a,u,e,r,l,h,3*(-t+3*(n-a)+u),6*(t-2*n+a),3*(n-t),f),x(this,Do,uw).call(this,t,n,a,u,e,r,l,h,3*(-e+3*(r-l)+h),6*(e-2*r+l),3*(r-e),f)}}Do=new WeakSet,Wm=function(t,e,n,r,a,l,u,h,f,p){if(f<=0||f>=1)return;const y=1-f,v=f*f,S=v*f,C=y*(y*(y*t+3*f*e)+3*v*n)+S*r,E=y*(y*(y*a+3*f*l)+3*v*u)+S*h;p[0]=Math.min(p[0],C),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],C),p[3]=Math.max(p[3],E)},uw=function(t,e,n,r,a,l,u,h,f,p,y,v){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&x(this,Do,Wm).call(this,t,e,n,r,a,l,u,h,-y/p,v);return}const S=p**2-4*y*f;if(S<0)return;const C=Math.sqrt(S),E=2*f;x(this,Do,Wm).call(this,t,e,n,r,a,l,u,h,(-p+C)/E,v),x(this,Do,Wm).call(this,t,e,n,r,a,l,u,h,(-p-C)/E,v)},b(at,Do);function Ek(g){return decodeURIComponent(escape(g))}let tw=null,D1=null;function Ck(g){return tw||(tw=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,D1=new Map([["","t"]])),g.replaceAll(tw,(t,e,n)=>e?e.normalize("NFKC"):D1.get(n))}function dx(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),hx(g)}const _u="pdfjs_internal_id_";function _k(g,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[n,r,...a]=e;if(!g(n)&&!Number.isInteger(n)||!t(r))return!1;const l=a.length;let u=!0;switch(r.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;u=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function hs(g,t,e){return Math.min(Math.max(g,t),e)}function fx(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(hx(g))}function kk(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):vg(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(e=>{e(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,e)=>t+e,0)});class Cf{static textContent(t){const e=[],n={items:e,styles:Object.create(null)};function r(a){var h;if(!a)return;let l=null;const u=a.name;if(u==="#text")l=a.value;else if(Cf.shouldBuildText(u))(h=a==null?void 0:a.attributes)!=null&&h.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const f of a.children)r(f)}return r(t),n}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class px{static setupStorage(t,e,n,r,a){const l=r.getValue(e,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?t.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{r.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const u of n.children)u.attributes.value===l.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:n=null,intent:r,linkService:a}){const{attributes:l}=e,u=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}u&&a.addLinkAttributes(t,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(t,l.dataId,e,n)}static render(t){var y,v;const e=t.annotationStorage,n=t.linkService,r=t.xfaHtml,a=t.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:a,linkService:n});const u=a!=="richText",h=t.div;if(h.append(l),t.viewport){const S=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=S}u&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const S=document.createTextNode(r.value);l.append(S),u&&Cf.shouldBuildText(r.name)&&f.push(S)}return{textDivs:f}}const p=[[r,-1,l]];for(;p.length>0;){const[S,C,E]=p.at(-1);if(C+1===S.children.length){p.pop();continue}const k=S.children[++p.at(-1)[1]];if(k===null)continue;const{name:T}=k;if(T==="#text"){const P=document.createTextNode(k.value);f.push(P),E.append(P);continue}const L=(y=k==null?void 0:k.attributes)!=null&&y.xmlns?document.createElementNS(k.attributes.xmlns,T):document.createElement(T);if(E.append(L),k.attributes&&this.setAttributes({html:L,element:k,storage:e,intent:a,linkService:n}),((v=k.children)==null?void 0:v.length)>0)p.push([k,-1,L]);else if(k.value){const P=document.createTextNode(k.value);u&&Cf.shouldBuildText(T)&&f.push(P),L.append(P)}}for(const S of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))S.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Gr="http://www.w3.org/2000/svg",xl=class xl{};K(xl,"CSS",96),K(xl,"PDF",72),K(xl,"PDF_TO_CSS_UNITS",xl.CSS/xl.PDF);let nl=xl;async function wg(g,t="text"){if(ef(g,document.baseURI)){const e=await fetch(g);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,n)=>{const r=new XMLHttpRequest;r.open("GET",g,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}n(new Error(r.statusText))}},r.send(null)})}class Ag{constructor({viewBox:t,userUnit:e,scale:n,rotation:r,offsetX:a=0,offsetY:l=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=n,this.rotation=r,this.offsetX=a,this.offsetY=l,n*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,v,S;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,y=0,v=0,S=1;break;case 90:p=0,y=1,v=1,S=0;break;case 270:p=0,y=-1,v=-1,S=0;break;case 0:p=1,y=0,v=0,S=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,S=-S);let C,E,k,T;p===0?(C=Math.abs(f-t[1])*n+a,E=Math.abs(h-t[0])*n+l,k=(t[3]-t[1])*n,T=(t[2]-t[0])*n):(C=Math.abs(h-t[0])*n+a,E=Math.abs(f-t[1])*n+l,k=(t[2]-t[0])*n,T=(t[3]-t[1])*n),this.transform=[p*n,y*n,v*n,S*n,C-p*n*h-v*n*f,E-y*n*h-S*n*f],this.width=k,this.height=T}get rawDims(){const t=this.viewBox;return Ut(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:n=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new Ag({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:r,dontFlip:a})}convertToViewportPoint(t,e){const n=[t,e];return at.applyTransform(n,this.transform),n}convertToViewportRectangle(t){const e=[t[0],t[1]];at.applyTransform(e,this.transform);const n=[t[2],t[3]];return at.applyTransform(n,this.transform),[e[0],e[1],n[0],n[1]]}convertToPdfPoint(t,e){const n=[t,e];return at.applyInverseTransform(n,this.transform),n}}class BA extends Wc{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function r0(g){const t=g.length;let e=0;for(;e<t&&g[e].trim()==="";)e++;return g.substring(e,e+5).toLowerCase()==="data:"}function UA(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function Tk(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function Pk(g,t="document.pdf"){if(typeof g!="string")return t;if(r0(g))return Bt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const n=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(g);if(!n)return t;const r=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},a=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(a.test(l))return r(l);if(n.searchParams.size>0){const u=Array.from(n.searchParams.values()).reverse();for(const f of u)if(a.test(f))return r(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(a.test(f))return r(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return r(h[0])}return t}class N1{constructor(){K(this,"started",Object.create(null));K(this,"times",[])}time(t){t in this.started&&Bt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||Bt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:n}of this.times)e=Math.max(n.length,e);for(const{name:n,start:r,end:a}of this.times)t.push(`${n.padEnd(e)} ${a-r}ms
`);return t.join("")}}function ef(g,t){const e=t?URL.parse(g,t):URL.parse(g);return(e==null?void 0:e.protocol)==="http:"||(e==null?void 0:e.protocol)==="https:"}function Ri(g){g.preventDefault()}function Qe(g){g.preventDefault(),g.stopPropagation()}function Rk(g){console.log("Deprecated API usage: "+g)}var Tf;class Ey{static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;o(this,Tf)||w(this,Tf,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const e=o(this,Tf).exec(t);if(!e)return null;const n=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(l+=p,u+=y):f==="+"&&(l-=p,u-=y),new Date(Date.UTC(n,r,a,l,u,h))}}Tf=new WeakMap,b(Ey,Tf);function Lk(g,{scale:t=1,rotation:e=0}){const{width:n,height:r}=g.attributes.style,a=[0,0,parseInt(n),parseInt(r)];return new Ag({viewBox:a,userUnit:1,scale:t,rotation:e})}function Sg(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(Bt(`Not a valid color format: "${g}"`),[0,0,0])}function Mk(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of g.keys()){t.style.color=e;const n=window.getComputedStyle(t).color;g.set(e,Sg(n))}t.remove()}function He(g){const{a:t,b:e,c:n,d:r,e:a,f:l}=g.getTransform();return[t,e,n,r,a,l]}function ar(g){const{a:t,b:e,c:n,d:r,e:a,f:l}=g.getTransform().invertSelf();return[t,e,n,r,a,l]}function jc(g,t,e=!1,n=!0){if(t instanceof Ag){const{pageWidth:r,pageHeight:a}=t.rawDims,{style:l}=g,u=wn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${a}px`,p=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=p,l.height=y):(l.width=y,l.height=p)}n&&g.setAttribute("data-main-rotation",t.rotation)}class Dr{constructor(){const{pixelRatio:t}=Dr;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,n,r,a=-1){let l=1/0,u=1/0,h=1/0;n=Dr.capPixels(n,a),n>0&&(l=Math.sqrt(n/(t*e))),r!==-1&&(u=r/t,h=r/e);const f=Math.min(l,u,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,n):n}return t}}const hw=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Dk{static get isDarkMode(){var t;return Ut(this,"isDarkMode",!!((t=window==null?void 0:window.matchMedia)!=null&&t.call(window,"(prefers-color-scheme: dark)").matches))}}class Nk{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:n}=window.getComputedStyle(t);return t.remove(),Ut(this,"commentForegroundColor",Sg(n))}}function Ik(g,t,e,n){n=Math.min(Math.max(n??1,0),1);const r=255*(1-n);return g=Math.round(g*n+r),t=Math.round(t*n+r),e=Math.round(e*n+r),[g,t,e]}function I1(g,t){const e=g[0]/255,n=g[1]/255,r=g[2]/255,a=Math.max(e,n,r),l=Math.min(e,n,r),u=(a+l)/2;if(a===l)t[0]=t[1]=0;else{const h=a-l;switch(t[1]=u<.5?h/(a+l):h/(2-a-l),a){case e:t[0]=((n-r)/h+(n<r?6:0))*60;break;case n:t[0]=((r-e)/h+2)*60;break;case r:t[0]=((e-n)/h+4)*60;break}}t[2]=u}function dw(g,t){const e=g[0],n=g[1],r=g[2],a=(1-Math.abs(2*r-1))*n,l=a*(1-Math.abs(e/60%2-1)),u=r-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+u,t[1]=l+u,t[2]=u;break;case 1:t[0]=l+u,t[1]=a+u,t[2]=u;break;case 2:t[0]=u,t[1]=a+u,t[2]=l+u;break;case 3:t[0]=u,t[1]=l+u,t[2]=a+u;break;case 4:t[0]=l+u,t[1]=u,t[2]=a+u;break;case 5:case 6:t[0]=a+u,t[1]=u,t[2]=l+u;break}}function F1(g){return g<=.03928?g/12.92:((g+.055)/1.055)**2.4}function O1(g,t,e){dw(g,e),e.map(F1);const n=.2126*e[0]+.7152*e[1]+.0722*e[2];dw(t,e),e.map(F1);const r=.2126*e[0]+.7152*e[1]+.0722*e[2];return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)}const B1=new Map;function Fk(g,t){const e=g[0]+g[1]*256+g[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let n=B1.get(e);if(n)return n;const r=new Float32Array(9),a=r.subarray(0,3),l=r.subarray(3,6);I1(g,l);const u=r.subarray(6,9);I1(t,u);const h=u[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),O1(l,u,a)<f){let p,y;h?(p=l[2],y=1):(p=0,y=l[2]);const v=.005;for(;y-p>v;){const S=l[2]=(p+y)/2;h===O1(l,u,a)<f?p=S:y=S}l[2]=h?y:p}return dw(l,a),n=at.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),B1.set(e,n),n}function gx({html:g,dir:t,className:e},n){const r=document.createDocumentFragment();if(typeof g=="string"){const a=document.createElement("p");a.dir=t||"auto";const l=g.split(/(?:\r\n?|\n)/);for(let u=0,h=l.length;u<h;++u){const f=l[u];a.append(document.createTextNode(f)),u<h-1&&a.append(document.createElement("br"))}r.append(a)}else px.render({xfaHtml:g,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",e),n.append(r)}function mx(g){const t=new Path2D;if(!g)return t;for(let e=0,n=g.length;e<n;)switch(g[e++]){case Kd.moveTo:t.moveTo(g[e++],g[e++]);break;case Kd.lineTo:t.lineTo(g[e++],g[e++]);break;case Kd.curveTo:t.bezierCurveTo(g[e++],g[e++],g[e++],g[e++],g[e++],g[e++]);break;case Kd.quadraticCurveTo:t.quadraticCurveTo(g[e++],g[e++],g[e++],g[e++]);break;case Kd.closePath:t.closePath();break;default:Bt(`Unrecognized drawing path operator: ${g[e-1]}`);break}return t}var ha,da,mi,yi,Pf,fa,Du,Nu,Rf,Oy,yx,Hn,vx,wx,wu,nf;const Yr=class Yr{constructor(t){b(this,Hn);b(this,ha,null);b(this,da,null);b(this,mi);b(this,yi,null);b(this,Pf,null);b(this,fa,null);b(this,Du,null);b(this,Nu,null);w(this,mi,t),o(Yr,Rf)||w(Yr,Rf,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const t=w(this,ha,document.createElement("div"));t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=o(this,mi)._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Ri,{signal:e}),t.addEventListener("pointerdown",x(Yr,Oy,yx),{signal:e}));const n=w(this,yi,document.createElement("div"));n.className="buttons",t.append(n);const r=o(this,mi).toolbarPosition;if(r){const{style:a}=t,l=o(this,mi)._uiManager.direction==="ltr"?1-r[0]:r[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return o(this,ha)}hide(){var t;o(this,ha).classList.add("hidden"),(t=o(this,da))==null||t.hideDropdown()}show(){var t,e;o(this,ha).classList.remove("hidden"),(t=o(this,Pf))==null||t.shown(),(e=o(this,fa))==null||e.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=o(this,mi),n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",o(Yr,Rf)[t]),x(this,Hn,wu).call(this,n)&&n.addEventListener("click",r=>{e.delete()},{signal:e._signal}),o(this,yi).append(n)}async addAltText(t){const e=await t.render();x(this,Hn,wu).call(this,e),o(this,yi).append(e,o(this,Hn,nf)),w(this,Pf,t)}addComment(t,e=null){if(o(this,fa))return;const n=t.renderForToolbar();if(!n)return;x(this,Hn,wu).call(this,n);const r=w(this,Du,o(this,Hn,nf));e?(o(this,yi).insertBefore(n,e),o(this,yi).insertBefore(r,e)):o(this,yi).append(n,r),w(this,fa,t),t.toolbar=this}addColorPicker(t){if(o(this,da))return;w(this,da,t);const e=t.renderButton();x(this,Hn,wu).call(this,e),o(this,yi).append(e,o(this,Hn,nf))}async addEditSignatureButton(t){const e=w(this,Nu,await t.renderEditButton(o(this,mi)));x(this,Hn,wu).call(this,e),o(this,yi).append(e,o(this,Hn,nf))}removeButton(t){var e,n;switch(t){case"comment":(e=o(this,fa))==null||e.removeToolbarCommentButton(),w(this,fa,null),(n=o(this,Du))==null||n.remove(),w(this,Du,null);break}}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,n){if(!e&&t==="comment")return;const r=o(this,yi).querySelector(n);r&&t==="comment"&&this.addComment(e,r)}updateEditSignatureButton(t){o(this,Nu)&&(o(this,Nu).title=t)}remove(){var t;o(this,ha).remove(),(t=o(this,da))==null||t.destroy(),w(this,da,null)}};ha=new WeakMap,da=new WeakMap,mi=new WeakMap,yi=new WeakMap,Pf=new WeakMap,fa=new WeakMap,Du=new WeakMap,Nu=new WeakMap,Rf=new WeakMap,Oy=new WeakSet,yx=function(t){t.stopPropagation()},Hn=new WeakSet,vx=function(t){o(this,mi)._focusEventsAllowed=!1,Qe(t)},wx=function(t){o(this,mi)._focusEventsAllowed=!0,Qe(t)},wu=function(t){const e=o(this,mi)._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",x(this,Hn,vx).bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",x(this,Hn,wx).bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Ri,{signal:e}),!0)},nf=function(){const t=document.createElement("div");return t.className="divider",t},b(Yr,Oy),b(Yr,Rf,null);let fw=Yr;var Lf,_l,Qr,Fo,Ax,Sx,pw;class Ok{constructor(t){b(this,Fo);b(this,Lf,null);b(this,_l,null);b(this,Qr);w(this,Qr,t)}show(t,e,n){const[r,a]=x(this,Fo,Sx).call(this,e,n),{style:l}=o(this,_l)||w(this,_l,x(this,Fo,Ax).call(this));t.append(o(this,_l)),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){o(this,_l).remove()}}Lf=new WeakMap,_l=new WeakMap,Qr=new WeakMap,Fo=new WeakSet,Ax=function(){const t=w(this,_l,document.createElement("div"));t.className="editToolbar",t.setAttribute("role","toolbar");const e=o(this,Qr)._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Ri,{signal:e});const n=w(this,Lf,document.createElement("div"));return n.className="buttons",t.append(n),o(this,Qr).hasCommentManager()&&x(this,Fo,pw).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{o(this,Qr).commentSelection("floating_button")}),x(this,Fo,pw).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{o(this,Qr).highlightSelection("floating_button")}),t},Sx=function(t,e){let n=0,r=0;for(const a of t){const l=a.y+a.height;if(l<n)continue;const u=a.x+(e?a.width:0);if(l>n){r=u,n=l;continue}e?u>r&&(r=u):u<r&&(r=u)}return[e?1-r:r,n]},pw=function(t,e,n,r){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const u=o(this,Qr)._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",Ri,{signal:u}),a.addEventListener("click",r,{signal:u})),o(this,Lf).append(a)};function bx(g,t,e){for(const n of e)t.addEventListener(n,g[n].bind(g))}var kl,Tl,Iu,Pl;const ge=class ge{static initializeAndAddPointerId(t){(o(ge,Tl)||w(ge,Tl,new Set)).add(t)}static setPointer(t,e){o(ge,kl)||w(ge,kl,e),o(ge,Pl)??w(ge,Pl,t)}static setTimeStamp(t){w(ge,Iu,t)}static isSamePointerId(t){return o(ge,kl)===t}static isSamePointerIdOrRemove(t){var e;return o(ge,kl)===t?!0:((e=o(ge,Tl))==null||e.delete(t),!1)}static isSamePointerType(t){return o(ge,Pl)===t}static isInitializedAndDifferentPointerType(t){return o(ge,Pl)!==null&&!ge.isSamePointerType(t)}static isSameTimeStamp(t){return o(ge,Iu)===t}static isUsingMultiplePointers(){var t;return((t=o(ge,Tl))==null?void 0:t.size)>=1}static clearPointerType(){w(ge,Pl,null)}static clearPointerIds(){w(ge,kl,NaN),w(ge,Tl,null)}static clearTimeStamp(){w(ge,Iu,NaN)}};kl=new WeakMap,Tl=new WeakMap,Iu=new WeakMap,Pl=new WeakMap,b(ge,kl,NaN),b(ge,Tl,null),b(ge,Iu,NaN),b(ge,Pl,null);let Yn=ge;var By;class Bk{constructor(){b(this,By,0)}get id(){return`${xf}${fn(this,By)._++}`}}By=new WeakMap;var Fu,Mf,Kn,Ou,Vm;const XA=class XA{constructor(){b(this,Ou);b(this,Fu,dx());b(this,Mf,0);b(this,Kn,null)}static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const a=r.decode().then(()=>(n.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ut(this,"_isSVGFittingCanvas",a)}async getFromFile(t){const{lastModified:e,name:n,size:r,type:a}=t;return x(this,Ou,Vm).call(this,`${e}_${n}_${r}_${a}`,t)}async getFromUrl(t){return x(this,Ou,Vm).call(this,t,t)}async getFromBlob(t,e){const n=await e;return x(this,Ou,Vm).call(this,t,n)}async getFromId(t){o(this,Kn)||w(this,Kn,new Map);const e=o(this,Kn).get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:n}=e;return delete e.blobPromise,this.getFromBlob(e.id,n)}return this.getFromUrl(e.url)}getFromCanvas(t,e){o(this,Kn)||w(this,Kn,new Map);let n=o(this,Kn).get(t);if(n!=null&&n.bitmap)return n.refCounter+=1,n;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${o(this,Fu)}_${fn(this,Mf)._++}`,refCounter:1,isSvg:!1},o(this,Kn).set(t,n),o(this,Kn).set(n.id,n),n}getSvgUrl(t){const e=o(this,Kn).get(t);return e!=null&&e.isSvg?e.svgUrl:null}deleteId(t){var r;o(this,Kn)||w(this,Kn,new Map);const e=o(this,Kn).get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:n}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(n.width,n.height);a.getContext("bitmaprenderer").transferFromImageBitmap(n),e.blobPromise=a.convertToBlob()}(r=n.close)==null||r.call(n),e.bitmap=null}isValidId(t){return t.startsWith(`image_${o(this,Fu)}_`)}};Fu=new WeakMap,Mf=new WeakMap,Kn=new WeakMap,Ou=new WeakSet,Vm=async function(t,e){o(this,Kn)||w(this,Kn,new Map);let n=o(this,Kn).get(t);if(n===null)return null;if(n!=null&&n.bitmap)return n.refCounter+=1,n;try{n||(n={bitmap:null,id:`image_${o(this,Fu)}_${fn(this,Mf)._++}`,refCounter:0,isSvg:!1});let r;if(typeof e=="string"?(n.url=e,r=await wg(e,"blob")):e instanceof File?r=n.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const a=XA._isSVGFittingCanvas,l=new FileReader,u=new Image,h=new Promise((f,p)=>{u.onload=()=>{n.bitmap=u,n.isSvg=!0,f()},l.onload=async()=>{const y=n.svgUrl=l.result;u.src=await a?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=l.onerror=p});l.readAsDataURL(r),await h}else n.bitmap=await createImageBitmap(r);n.refCounter=1}catch(r){Bt(r),n=null}return o(this,Kn).set(t,n),n&&o(this,Kn).set(n.id,n),n};let gw=XA;var nn,pa,Df,je;class Uk{constructor(t=128){b(this,nn,[]);b(this,pa,!1);b(this,Df);b(this,je,-1);w(this,Df,t)}add({cmd:t,undo:e,post:n,mustExec:r,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:u=!1}){if(r&&t(),o(this,pa))return;const h={cmd:t,undo:e,post:n,type:a};if(o(this,je)===-1){o(this,nn).length>0&&(o(this,nn).length=0),w(this,je,0),o(this,nn).push(h);return}if(l&&o(this,nn)[o(this,je)].type===a){u&&(h.undo=o(this,nn)[o(this,je)].undo),o(this,nn)[o(this,je)]=h;return}const f=o(this,je)+1;f===o(this,Df)?o(this,nn).splice(0,1):(w(this,je,f),f<o(this,nn).length&&o(this,nn).splice(f)),o(this,nn).push(h)}undo(){if(o(this,je)===-1)return;w(this,pa,!0);const{undo:t,post:e}=o(this,nn)[o(this,je)];t(),e==null||e(),w(this,pa,!1),w(this,je,o(this,je)-1)}redo(){if(o(this,je)<o(this,nn).length-1){w(this,je,o(this,je)+1),w(this,pa,!0);const{cmd:t,post:e}=o(this,nn)[o(this,je)];t(),e==null||e(),w(this,pa,!1)}}hasSomethingToUndo(){return o(this,je)!==-1}hasSomethingToRedo(){return o(this,je)<o(this,nn).length-1}cleanType(t){if(o(this,je)!==-1){for(let e=o(this,je);e>=0;e--)if(o(this,nn)[e].type!==t){o(this,nn).splice(e+1,o(this,je)-e),w(this,je,e);return}o(this,nn).length=0,w(this,je,-1)}}destroy(){w(this,nn,null)}}nn=new WeakMap,pa=new WeakMap,Df=new WeakMap,je=new WeakMap;var Uy,xx;class bg{constructor(t){b(this,Uy);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=wn.platform;for(const[n,r,a={}]of t)for(const l of n){const u=l.startsWith("mac+");e&&u?(this.callbacks.set(l.slice(4),{callback:r,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!u&&(this.callbacks.set(l,{callback:r,options:a}),this.allKeys.add(l.split("+").at(-1)))}}exec(t,e){if(!this.allKeys.has(e.key))return;const n=this.callbacks.get(x(this,Uy,xx).call(this,e));if(!n)return;const{callback:r,options:{bubbles:a=!1,args:l=[],checker:u=null}}=n;u&&!u(t,e)||(r.bind(t,...l,e)(),a||Qe(e))}}Uy=new WeakSet,xx=function(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e};const zy=class zy{get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Mk(t),Ut(this,"_colors",t)}convert(t){const e=Sg(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[n,r]of this._colors)if(r.every((a,l)=>a===e[l]))return zy._colorsMapping.get(n);return e}getHexCode(t){const e=this._colors.get(t);return e?at.makeHexColor(...e):t}};K(zy,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let mw=zy;var Bu,Us,Uu,Ge,mn,zu,vi,ju,wi,Qn,ga,ma,Hu,ya,ur,Ai,Rl,Nf,If,$u,Ff,hr,va,Wu,wa,dr,jy,Aa,Vu,Of,Sa,Ll,Gu,ba,Bf,cn,fe,Zr,xa,Ea,Uf,Xu,zf,Ca,fr,Jr,jf,Hf,Si,rt,Gm,yw,Ex,Cx,sf,_x,kx,Tx,vw,Px,Rx,Lx,Mx,rs,Xr,Dx,Nx,ww,Ix,rf,Aw;const Tu=class Tu{constructor(t,e,n,r,a,l,u,h,f,p,y,v,S,C,E,k){b(this,rt);b(this,Bu,new AbortController);b(this,Us,null);b(this,Uu,null);b(this,Ge,new Map);b(this,mn,new Map);b(this,zu,null);b(this,vi,null);b(this,ju,null);b(this,wi,new Uk);b(this,Qn,null);b(this,ga,null);b(this,ma,null);b(this,Hu,0);b(this,ya,new Set);b(this,ur,null);b(this,Ai,null);b(this,Rl,new Set);K(this,"_editorUndoBar",null);b(this,Nf,!1);b(this,If,!1);b(this,$u,!1);b(this,Ff,null);b(this,hr,null);b(this,va,null);b(this,Wu,null);b(this,wa,!1);b(this,dr,null);b(this,jy,new Bk);b(this,Aa,!1);b(this,Vu,!1);b(this,Of,!1);b(this,Sa,null);b(this,Ll,null);b(this,Gu,null);b(this,ba,null);b(this,Bf,null);b(this,cn,jt.NONE);b(this,fe,new Set);b(this,Zr,null);b(this,xa,null);b(this,Ea,null);b(this,Uf,null);b(this,Xu,null);b(this,zf,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});b(this,Ca,[0,0]);b(this,fr,null);b(this,Jr,null);b(this,jf,null);b(this,Hf,null);b(this,Si,null);const T=this._signal=o(this,Bu).signal;w(this,Jr,t),w(this,jf,e),w(this,Hf,n),w(this,zu,r),w(this,Qn,a),w(this,xa,l),w(this,Xu,h),this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:T}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:T}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:T}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:T}),u._on("setpreference",this.onSetPreference.bind(this),{signal:T}),u._on("switchannotationeditorparams",L=>this.updateParams(L.type,L.value),{signal:T}),window.addEventListener("pointerdown",()=>{w(this,Vu,!0)},{capture:!0,signal:T}),window.addEventListener("pointerup",()=>{w(this,Vu,!1)},{capture:!0,signal:T}),x(this,rt,_x).call(this),x(this,rt,Mx).call(this),x(this,rt,vw).call(this),w(this,vi,h.annotationStorage),w(this,Ff,h.filterFactory),w(this,Ea,f),w(this,Wu,p||null),w(this,Nf,y),w(this,If,v),w(this,$u,S),w(this,Bf,C||null),this.viewParameters={realScale:nl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=E||null,this._supportsPinchToZoom=k!==!1,a==null||a.setSidebarUiManager(this)}static get _keyboardManager(){const t=Tu.prototype,e=l=>o(l,Jr).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new bg([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],t.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:n}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&o(l,Jr).contains(u)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:u})=>!(u instanceof HTMLButtonElement)&&o(l,Jr).contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}destroy(){var t,e,n,r,a,l,u,h,f;(t=o(this,Si))==null||t.resolve(),w(this,Si,null),(e=o(this,Bu))==null||e.abort(),w(this,Bu,null),this._signal=null;for(const p of o(this,mn).values())p.destroy();o(this,mn).clear(),o(this,Ge).clear(),o(this,Rl).clear(),(n=o(this,ba))==null||n.clear(),w(this,Us,null),o(this,fe).clear(),o(this,wi).destroy(),(r=o(this,zu))==null||r.destroy(),(a=o(this,Qn))==null||a.destroy(),(l=o(this,xa))==null||l.destroy(),(u=o(this,dr))==null||u.hide(),w(this,dr,null),(h=o(this,Gu))==null||h.destroy(),w(this,Gu,null),w(this,Uu,null),o(this,hr)&&(clearTimeout(o(this,hr)),w(this,hr,null)),o(this,fr)&&(clearTimeout(o(this,fr)),w(this,fr,null)),(f=this._editorUndoBar)==null||f.destroy(),w(this,Xu,null)}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return o(this,Bf)}get useNewAltTextFlow(){return o(this,If)}get useNewAltTextWhenAddingImage(){return o(this,$u)}get hcmFilter(){return Ut(this,"hcmFilter",o(this,Ea)?o(this,Ff).addHCMFilter(o(this,Ea).foreground,o(this,Ea).background):"none")}get direction(){return Ut(this,"direction",getComputedStyle(o(this,Jr)).direction)}get _highlightColors(){return Ut(this,"_highlightColors",o(this,Wu)?new Map(o(this,Wu).split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return Ut(this,"highlightColors",null);const e=new Map,n=!!o(this,Ea);for(const[r,a]of t){const l=r.endsWith("_HCM");if(n&&l){e.set(r.replace("_HCM",""),a);continue}!n&&!l&&e.set(r,a)}return Ut(this,"highlightColors",e)}get highlightColorNames(){return Ut(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),w(this,ma,t)}setMainHighlightColorPicker(t){w(this,Gu,t)}editAltText(t,e=!1){var n;(n=o(this,zu))==null||n.editAltText(this,t,e)}hasCommentManager(){return!!o(this,Qn)}editComment(t,e,n,r){var a;(a=o(this,Qn))==null||a.showDialog(this,t,e,n,r)}selectComment(t,e){const n=o(this,mn).get(t),r=n==null?void 0:n.getEditorByUID(e);r==null||r.toggleComment(!0,!0)}updateComment(t){var e;(e=o(this,Qn))==null||e.updateComment(t.getData())}updatePopupColor(t){var e;(e=o(this,Qn))==null||e.updatePopupColor(t)}removeComment(t){var e;(e=o(this,Qn))==null||e.removeComments([t.uid])}toggleComment(t,e,n=void 0){var r;(r=o(this,Qn))==null||r.toggleCommentPopup(t,e,n)}makeCommentColor(t,e){var n;return t&&((n=o(this,Qn))==null?void 0:n.makeCommentColor(t,e))||null}getCommentDialogElement(){var t;return((t=o(this,Qn))==null?void 0:t.dialogElement)||null}async waitForEditorsRendered(t){if(o(this,mn).has(t-1))return;const{resolve:e,promise:n}=Promise.withResolvers(),r=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",r),e())};this._eventBus.on("editorsrendered",r),await n}getSignature(t){var e;(e=o(this,xa))==null||e.getSignature({uiManager:this,editor:t})}get signatureManager(){return o(this,xa)}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":w(this,$u,e);break}}onPageChanging({pageNumber:t}){w(this,Hu,t-1)}focusMainContainer(){o(this,Jr).focus()}findParent(t,e){for(const n of o(this,mn).values()){const{x:r,y:a,width:l,height:u}=n.div.getBoundingClientRect();if(t>=r&&t<=r+l&&e>=a&&e<=a+u)return n}return null}disableUserSelect(t=!1){o(this,jf).classList.toggle("noUserSelect",t)}addShouldRescale(t){o(this,Rl).add(t)}removeShouldRescale(t){o(this,Rl).delete(t)}onScaleChanging({scale:t}){var e;this.commitOrRemove(),this.viewParameters.realScale=t*nl.PDF_TO_CSS_UNITS;for(const n of o(this,Rl))n.onScaleChanging();(e=o(this,ma))==null||e.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}highlightSelection(t="",e=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:r,anchorOffset:a,focusNode:l,focusOffset:u}=n,h=n.toString(),p=x(this,rt,Gm).call(this,n).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;n.empty();const v=x(this,rt,yw).call(this,p),S=o(this,cn)===jt.NONE,C=()=>{const E=v==null?void 0:v.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:a,focusNode:l,focusOffset:u,text:h});S&&this.showAllEditors("highlight",!0,!0),e&&(E==null||E.editComment())};if(S){this.switchToMode(jt.HIGHLIGHT,C);return}C()}commentSelection(t=""){this.highlightSelection(t,!0)}getAndRemoveDataFromAnnotationStorage(t){if(!o(this,vi))return null;const e=`${xf}${t}`,n=o(this,vi).getRawValue(e);return n&&o(this,vi).remove(e),n}addToAnnotationStorage(t){!t.isEmpty()&&o(this,vi)&&!o(this,vi).has(t.id)&&o(this,vi).setValue(t.id,t)}a11yAlert(t,e=null){const n=o(this,Hf);n&&(n.setAttribute("data-l10n-id",t),e?n.setAttribute("data-l10n-args",JSON.stringify(e)):n.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,o(this,wa)&&(w(this,wa,!1),x(this,rt,sf).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of o(this,fe))if(e.div.contains(t)){w(this,Ll,[e,t]),e._focusEventsAllowed=!1;break}}focus(){if(!o(this,Ll))return;const[t,e]=o(this,Ll);w(this,Ll,null),e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}addEditListeners(){x(this,rt,vw).call(this),this.setEditingState(!0)}removeEditListeners(){x(this,rt,Px).call(this),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const n of o(this,Ai))if(n.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const n of o(this,Ai))if(n.isHandlingMimeForPasting(e.type)){n.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){var n;if(t.preventDefault(),(n=o(this,Us))==null||n.commitOrRemove(),!this.hasSelection)return;const e=[];for(const r of o(this,fe)){const a=r.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of o(this,Ai))if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let n=e.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(a){Bt(`paste: "${a.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const r=this.currentLayer;try{const a=[];for(const h of n){const f=await r.deserialize(h);if(!f)return;a.push(f)}const l=()=>{for(const h of a)x(this,rt,ww).call(this,h);x(this,rt,Aw).call(this,a)},u=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:u,mustExec:!0})}catch(a){Bt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),o(this,cn)!==jt.NONE&&!this.isEditorHandlingKeyboard&&Tu._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,o(this,wa)&&(w(this,wa,!1),x(this,rt,sf).call(this,"main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(t){t?(x(this,rt,kx).call(this),x(this,rt,Rx).call(this),x(this,rt,rs).call(this,{isEditing:o(this,cn)!==jt.NONE,isEmpty:x(this,rt,rf).call(this),hasSomethingToUndo:o(this,wi).hasSomethingToUndo(),hasSomethingToRedo:o(this,wi).hasSomethingToRedo(),hasSelectedEditor:!1})):(x(this,rt,Tx).call(this),x(this,rt,Lx).call(this),x(this,rt,rs).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!o(this,Ai)){w(this,Ai,t);for(const e of o(this,Ai))x(this,rt,Xr).call(this,e.defaultPropertiesToUpdate)}}getId(){return o(this,jy).id}get currentLayer(){return o(this,mn).get(o(this,Hu))}getLayer(t){return o(this,mn).get(t)}get currentPageIndex(){return o(this,Hu)}addLayer(t){o(this,mn).set(t.pageIndex,t),o(this,Aa)?t.enable():t.disable()}removeLayer(t){o(this,mn).delete(t.pageIndex)}async updateMode(t,e=null,n=!1,r=!1,a=!1,l=!1){var u,h,f,p,y,v;if(o(this,cn)!==t&&!(o(this,Si)&&(await o(this,Si).promise,!o(this,Si)))){if(w(this,Si,Promise.withResolvers()),(u=o(this,ma))==null||u.commitOrRemove(),o(this,cn)===jt.POPUP&&((h=o(this,Qn))==null||h.hideSidebar()),(f=o(this,Qn))==null||f.destroyPopup(),w(this,cn,t),t===jt.NONE){this.setEditingState(!1),x(this,rt,Nx).call(this);for(const S of o(this,Ge).values())S.hideStandaloneCommentButton();(p=this._editorUndoBar)==null||p.hide(),this.toggleComment(null),o(this,Si).resolve();return}for(const S of o(this,Ge).values())S.addStandaloneCommentButton();t===jt.SIGNATURE&&await((y=o(this,xa))==null?void 0:y.loadSignatures()),n&&Yn.clearPointerType(),this.setEditingState(!0),await x(this,rt,Dx).call(this),this.unselectAll();for(const S of o(this,mn).values())S.updateMode(t);if(t===jt.POPUP){o(this,Uu)||w(this,Uu,await o(this,Xu).getAnnotationsByType(new Set(o(this,Ai).map(E=>E._editorType))));const S=new Set,C=[];for(const E of o(this,Ge).values()){const{annotationElementId:k,hasComment:T,deleted:L}=E;k&&S.add(k),T&&!L&&C.push(E.getData())}for(const E of o(this,Uu)){const{id:k,popupRef:T,contentsObj:L}=E;T&&(L!=null&&L.str)&&!S.has(k)&&!o(this,ya).has(k)&&C.push(E)}(v=o(this,Qn))==null||v.showSidebar(C)}if(!e){r&&this.addNewEditorFromKeyboard(),o(this,Si).resolve();return}for(const S of o(this,Ge).values())S.uid===e?(this.setSelected(S),l?S.editComment():a?S.enterInEditMode():S.focus()):S.unselect();o(this,Si).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==o(this,cn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(o(this,Ai)){switch(t){case Qt.CREATE:this.currentLayer.addNewEditor(e);return;case Qt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(o(this,Uf)||w(this,Uf,new Map)).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const n of o(this,fe))n.updateParams(t,e);else for(const n of o(this,Ai))n.updateDefaultParams(t,e)}}showAllEditors(t,e,n=!1){var a;for(const l of o(this,Ge).values())l.editorType===t&&l.show(e);(((a=o(this,Uf))==null?void 0:a.get(Qt.HIGHLIGHT_SHOW_ALL))??!0)!==e&&x(this,rt,Xr).call(this,[[Qt.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(o(this,Of)!==t){w(this,Of,t);for(const e of o(this,mn).values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}*getEditors(t){for(const e of o(this,Ge).values())e.pageIndex===t&&(yield e)}getEditor(t){return o(this,Ge).get(t)}addEditor(t){o(this,Ge).set(t.id,t)}removeEditor(t){var e,n;t.div.contains(document.activeElement)&&(o(this,hr)&&clearTimeout(o(this,hr)),w(this,hr,setTimeout(()=>{this.focusMainContainer(),w(this,hr,null)},0))),o(this,Ge).delete(t.id),t.annotationElementId&&((e=o(this,ba))==null||e.delete(t.annotationElementId)),this.unselect(t),(!t.annotationElementId||!o(this,ya).has(t.annotationElementId))&&((n=o(this,vi))==null||n.remove(t.id))}addDeletedAnnotationElement(t){o(this,ya).add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return o(this,ya).has(t)}removeDeletedAnnotationElement(t){o(this,ya).delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}setActiveEditor(t){o(this,Us)!==t&&(w(this,Us,t),t&&x(this,rt,Xr).call(this,t.propertiesToUpdate))}updateUI(t){o(this,rt,Ix)===t&&x(this,rt,Xr).call(this,t.propertiesToUpdate)}updateUIForDefaultProperties(t){x(this,rt,Xr).call(this,t.defaultPropertiesToUpdate)}toggleSelected(t){if(o(this,fe).has(t)){o(this,fe).delete(t),t.unselect(),x(this,rt,rs).call(this,{hasSelectedEditor:this.hasSelection});return}o(this,fe).add(t),t.select(),x(this,rt,Xr).call(this,t.propertiesToUpdate),x(this,rt,rs).call(this,{hasSelectedEditor:!0})}setSelected(t){var e;this.updateToolbar({mode:t.mode,editId:t.uid}),(e=o(this,ma))==null||e.commitOrRemove();for(const n of o(this,fe))n!==t&&n.unselect();o(this,fe).clear(),o(this,fe).add(t),t.select(),x(this,rt,Xr).call(this,t.propertiesToUpdate),x(this,rt,rs).call(this,{hasSelectedEditor:!0})}isSelected(t){return o(this,fe).has(t)}get firstSelectedEditor(){return o(this,fe).values().next().value}unselect(t){t.unselect(),o(this,fe).delete(t),x(this,rt,rs).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return o(this,fe).size!==0}get isEnterHandled(){return o(this,fe).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var t;o(this,wi).undo(),x(this,rt,rs).call(this,{hasSomethingToUndo:o(this,wi).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:x(this,rt,rf).call(this)}),(t=this._editorUndoBar)==null||t.hide()}redo(){o(this,wi).redo(),x(this,rt,rs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:o(this,wi).hasSomethingToRedo(),isEmpty:x(this,rt,rf).call(this)})}addCommands(t){o(this,wi).add(t),x(this,rt,rs).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:x(this,rt,rf).call(this)})}cleanUndoStack(t){o(this,wi).cleanType(t)}delete(){var a;this.commitOrRemove();const t=(a=this.currentLayer)==null?void 0:a.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...o(this,fe)],n=()=>{var l;(l=this._editorUndoBar)==null||l.show(r,e.length===1?e[0].editorType:e.length);for(const u of e)u.remove()},r=()=>{for(const l of e)x(this,rt,ww).call(this,l)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){var t;(t=o(this,Us))==null||t.commitOrRemove()}hasSomethingToControl(){return o(this,Us)||this.hasSelection}selectAll(){for(const t of o(this,fe))t.commit();x(this,rt,Aw).call(this,o(this,Ge).values())}unselectAll(){var t;if(!(o(this,Us)&&(o(this,Us).commitOrRemove(),o(this,cn)!==jt.NONE))&&!((t=o(this,ma))!=null&&t.commitOrRemove())&&this.hasSelection){for(const e of o(this,fe))e.unselect();o(this,fe).clear(),x(this,rt,rs).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(t,e,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;o(this,Ca)[0]+=t,o(this,Ca)[1]+=e;const[r,a]=o(this,Ca),l=[...o(this,fe)],u=1e3;o(this,fr)&&clearTimeout(o(this,fr)),w(this,fr,setTimeout(()=>{w(this,fr,null),o(this,Ca)[0]=o(this,Ca)[1]=0,this.addCommands({cmd:()=>{for(const h of l)o(this,Ge).has(h.id)&&(h.translateInPage(r,a),h.translationDone())},undo:()=>{for(const h of l)o(this,Ge).has(h.id)&&(h.translateInPage(-r,-a),h.translationDone())},mustExec:!1})},u));for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),w(this,ur,new Map);for(const t of o(this,fe))o(this,ur).set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!o(this,ur))return!1;this.disableUserSelect(!1);const t=o(this,ur);w(this,ur,null);let e=!1;for(const[{x:r,y:a,pageIndex:l},u]of t)u.newX=r,u.newY=a,u.newPageIndex=l,e||(e=r!==u.savedX||a!==u.savedY||l!==u.savedPageIndex);if(!e)return!1;const n=(r,a,l,u)=>{if(o(this,Ge).has(r.id)){const h=o(this,mn).get(u);h?r._setParentAndPosition(h,a,l):(r.pageIndex=u,r.x=a,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:a,newY:l,newPageIndex:u}]of t)n(r,a,l,u)},undo:()=>{for(const[r,{savedX:a,savedY:l,savedPageIndex:u}]of t)n(r,a,l,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(o(this,ur))for(const n of o(this,ur).keys())n.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){var t;return((t=this.getActive())==null?void 0:t.shouldGetKeyboardEvents())||o(this,fe).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return o(this,Us)===t}getActive(){return o(this,Us)}getMode(){return o(this,cn)}isEditingMode(){return o(this,cn)!==jt.NONE}get imageManager(){return Ut(this,"imageManager",new gw)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:r,width:a,height:l}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,v)=>({x:(p-r)/l,y:1-(f+y-n)/a,width:v/l,height:y/a});break;case"180":u=(f,p,y,v)=>({x:1-(f+y-n)/a,y:1-(p+v-r)/l,width:y/a,height:v/l});break;case"270":u=(f,p,y,v)=>({x:1-(p+v-r)/l,y:(f-n)/a,width:v/l,height:y/a});break;default:u=(f,p,y,v)=>({x:(f-n)/a,y:(p-r)/l,width:y/a,height:v/l});break}const h=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:v,y:S,width:C,height:E}of y.getClientRects())C===0||E===0||h.push(u(v,S,C,E))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(o(this,ju)||w(this,ju,new Map)).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){var e;(e=o(this,ju))==null||e.delete(t)}renderAnnotationElement(t){var r;const e=(r=o(this,ju))==null?void 0:r.get(t.data.id);if(!e)return;const n=o(this,vi).getRawValue(e);n&&(o(this,cn)===jt.NONE&&!n.hasBeenModified||n.renderAnnotationElement(t))}setMissingCanvas(t,e,n){var a;const r=(a=o(this,ba))==null?void 0:a.get(t);r&&(r.setCanvas(e,n),o(this,ba).delete(t))}addMissingCanvas(t,e){(o(this,ba)||w(this,ba,new Map)).set(t,e)}};Bu=new WeakMap,Us=new WeakMap,Uu=new WeakMap,Ge=new WeakMap,mn=new WeakMap,zu=new WeakMap,vi=new WeakMap,ju=new WeakMap,wi=new WeakMap,Qn=new WeakMap,ga=new WeakMap,ma=new WeakMap,Hu=new WeakMap,ya=new WeakMap,ur=new WeakMap,Ai=new WeakMap,Rl=new WeakMap,Nf=new WeakMap,If=new WeakMap,$u=new WeakMap,Ff=new WeakMap,hr=new WeakMap,va=new WeakMap,Wu=new WeakMap,wa=new WeakMap,dr=new WeakMap,jy=new WeakMap,Aa=new WeakMap,Vu=new WeakMap,Of=new WeakMap,Sa=new WeakMap,Ll=new WeakMap,Gu=new WeakMap,ba=new WeakMap,Bf=new WeakMap,cn=new WeakMap,fe=new WeakMap,Zr=new WeakMap,xa=new WeakMap,Ea=new WeakMap,Uf=new WeakMap,Xu=new WeakMap,zf=new WeakMap,Ca=new WeakMap,fr=new WeakMap,Jr=new WeakMap,jf=new WeakMap,Hf=new WeakMap,Si=new WeakMap,rt=new WeakSet,Gm=function({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t},yw=function(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const n of o(this,mn).values())if(n.hasTextLayer(t))return n;return null},Ex=function(){const t=document.getSelection();if(!t||t.isCollapsed)return;const n=x(this,rt,Gm).call(this,t).closest(".textLayer"),r=this.getSelectionBoxes(n);r&&(o(this,dr)||w(this,dr,new Ok(this)),o(this,dr).show(n,r,this.direction==="ltr"))},Cx=function(){var a,l,u;const t=document.getSelection();if(!t||t.isCollapsed){o(this,Zr)&&((a=o(this,dr))==null||a.hide(),w(this,Zr,null),x(this,rt,rs).call(this,{hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===o(this,Zr))return;const r=x(this,rt,Gm).call(this,t).closest(".textLayer");if(!r){o(this,Zr)&&((l=o(this,dr))==null||l.hide(),w(this,Zr,null),x(this,rt,rs).call(this,{hasSelectedText:!1}));return}if((u=o(this,dr))==null||u.hide(),w(this,Zr,e),x(this,rt,rs).call(this,{hasSelectedText:!0}),!(o(this,cn)!==jt.HIGHLIGHT&&o(this,cn)!==jt.NONE)&&(o(this,cn)===jt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),w(this,wa,this.isShiftKeyDown),!this.isShiftKeyDown)){const h=o(this,cn)===jt.HIGHLIGHT?x(this,rt,yw).call(this,r):null;if(h==null||h.toggleDrawing(),o(this,Vu)){const f=new AbortController,p=this.combinedSignal(f),y=v=>{v.type==="pointerup"&&v.button!==0||(f.abort(),h==null||h.toggleDrawing(!0),v.type==="pointerup"&&x(this,rt,sf).call(this,"main_toolbar"))};window.addEventListener("pointerup",y,{signal:p}),window.addEventListener("blur",y,{signal:p})}else h==null||h.toggleDrawing(!0),x(this,rt,sf).call(this,"main_toolbar")}},sf=function(t=""){o(this,cn)===jt.HIGHLIGHT?this.highlightSelection(t):o(this,Nf)&&x(this,rt,Ex).call(this)},_x=function(){document.addEventListener("selectionchange",x(this,rt,Cx).bind(this),{signal:this._signal})},kx=function(){if(o(this,va))return;w(this,va,new AbortController);const t=this.combinedSignal(o(this,va));window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})},Tx=function(){var t;(t=o(this,va))==null||t.abort(),w(this,va,null)},vw=function(){if(o(this,Sa))return;w(this,Sa,new AbortController);const t=this.combinedSignal(o(this,Sa));window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})},Px=function(){var t;(t=o(this,Sa))==null||t.abort(),w(this,Sa,null)},Rx=function(){if(o(this,ga))return;w(this,ga,new AbortController);const t=this.combinedSignal(o(this,ga));document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})},Lx=function(){var t;(t=o(this,ga))==null||t.abort(),w(this,ga,null)},Mx=function(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})},rs=function(t){Object.entries(t).some(([n,r])=>o(this,zf)[n]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(o(this,zf),t)}),o(this,cn)===jt.HIGHLIGHT&&t.hasSelectedEditor===!1&&x(this,rt,Xr).call(this,[[Qt.HIGHLIGHT_FREE,!0]]))},Xr=function(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})},Dx=async function(){if(!o(this,Aa)){w(this,Aa,!0);const t=[];for(const e of o(this,mn).values())t.push(e.enable());await Promise.all(t);for(const e of o(this,Ge).values())e.enable()}},Nx=function(){if(this.unselectAll(),o(this,Aa)){w(this,Aa,!1);for(const t of o(this,mn).values())t.disable();for(const t of o(this,Ge).values())t.disable()}},ww=function(t){const e=o(this,mn).get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))},Ix=function(){let t=null;for(t of o(this,fe));return t},rf=function(){if(o(this,Ge).size===0)return!0;if(o(this,Ge).size===1)for(const t of o(this,Ge).values())return t.isEmpty();return!1},Aw=function(t){for(const e of o(this,fe))e.unselect();o(this,fe).clear();for(const e of t)e.isEmpty()||(o(this,fe).add(e),e.select());x(this,rt,rs).call(this,{hasSelectedEditor:this.hasSelection})},K(Tu,"TRANSLATE_SMALL",1),K(Tu,"TRANSLATE_BIG",10);let Hc=Tu;var En,pr,Hi,qu,gr,zs,Yu,mr,Es,to,Ml,yr,_a,tr,of,Xm;const os=class os{constructor(t){b(this,tr);b(this,En,null);b(this,pr,!1);b(this,Hi,null);b(this,qu,null);b(this,gr,null);b(this,zs,null);b(this,Yu,!1);b(this,mr,null);b(this,Es,null);b(this,to,null);b(this,Ml,null);b(this,yr,!1);w(this,Es,t),w(this,yr,t._uiManager.useNewAltTextFlow),o(os,_a)||w(os,_a,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(t){os._l10n??(os._l10n=t)}async render(){const t=w(this,Hi,document.createElement("button"));t.className="altText",t.tabIndex="0";const e=w(this,qu,document.createElement("span"));t.append(e),o(this,yr)?(t.classList.add("new"),t.setAttribute("data-l10n-id",o(os,_a).missing),e.setAttribute("data-l10n-id",o(os,_a)["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=o(this,Es)._uiManager._signal;t.addEventListener("contextmenu",Ri,{signal:n}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const r=a=>{a.preventDefault(),o(this,Es)._uiManager.editAltText(o(this,Es)),o(this,yr)&&o(this,Es)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:o(this,tr,of)}})};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(w(this,Yu,!0),r(a))},{signal:n}),await x(this,tr,Xm).call(this),t}finish(){o(this,Hi)&&(o(this,Hi).focus({focusVisible:o(this,Yu)}),w(this,Yu,!1))}isEmpty(){return o(this,yr)?o(this,En)===null:!o(this,En)&&!o(this,pr)}hasData(){return o(this,yr)?o(this,En)!==null||!!o(this,to):this.isEmpty()}get guessedText(){return o(this,to)}async setGuessedText(t){o(this,En)===null&&(w(this,to,t),w(this,Ml,await os._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t})),x(this,tr,Xm).call(this))}toggleAltTextBadge(t=!1){var e;if(!o(this,yr)||o(this,En)){(e=o(this,mr))==null||e.remove(),w(this,mr,null);return}if(!o(this,mr)){const n=w(this,mr,document.createElement("div"));n.className="noAltTextBadge",o(this,Es).div.append(n)}o(this,mr).classList.toggle("hidden",!t)}serialize(t){let e=o(this,En);return!t&&o(this,to)===e&&(e=o(this,Ml)),{altText:e,decorative:o(this,pr),guessedText:o(this,to),textWithDisclaimer:o(this,Ml)}}get data(){return{altText:o(this,En),decorative:o(this,pr)}}set data({altText:t,decorative:e,guessedText:n,textWithDisclaimer:r,cancel:a=!1}){n&&(w(this,to,n),w(this,Ml,r)),!(o(this,En)===t&&o(this,pr)===e)&&(a||(w(this,En,t),w(this,pr,e)),x(this,tr,Xm).call(this))}toggle(t=!1){o(this,Hi)&&(!t&&o(this,zs)&&(clearTimeout(o(this,zs)),w(this,zs,null)),o(this,Hi).disabled=!t)}shown(){o(this,Es)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:o(this,tr,of)}})}destroy(){var t,e;(t=o(this,Hi))==null||t.remove(),w(this,Hi,null),w(this,qu,null),w(this,gr,null),(e=o(this,mr))==null||e.remove(),w(this,mr,null)}};En=new WeakMap,pr=new WeakMap,Hi=new WeakMap,qu=new WeakMap,gr=new WeakMap,zs=new WeakMap,Yu=new WeakMap,mr=new WeakMap,Es=new WeakMap,to=new WeakMap,Ml=new WeakMap,yr=new WeakMap,_a=new WeakMap,tr=new WeakSet,of=function(){return o(this,En)&&"added"||o(this,En)===null&&this.guessedText&&"review"||"missing"},Xm=async function(){var r,a,l;const t=o(this,Hi);if(!t)return;if(o(this,yr)){if(t.classList.toggle("done",!!o(this,En)),t.setAttribute("data-l10n-id",o(os,_a)[o(this,tr,of)]),(r=o(this,qu))==null||r.setAttribute("data-l10n-id",o(os,_a)[`${o(this,tr,of)}-label`]),!o(this,En)){(a=o(this,gr))==null||a.remove();return}}else{if(!o(this,En)&&!o(this,pr)){t.classList.remove("done"),(l=o(this,gr))==null||l.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=o(this,gr);if(!e){w(this,gr,e=document.createElement("span")),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${o(this,Es).id}`;const u=100,h=o(this,Es)._uiManager._signal;h.addEventListener("abort",()=>{clearTimeout(o(this,zs)),w(this,zs,null)},{once:!0}),t.addEventListener("mouseenter",()=>{w(this,zs,setTimeout(()=>{w(this,zs,null),o(this,gr).classList.add("show"),o(this,Es)._reportTelemetry({action:"alt_text_tooltip"})},u))},{signal:h}),t.addEventListener("mouseleave",()=>{var f;o(this,zs)&&(clearTimeout(o(this,zs)),w(this,zs,null)),(f=o(this,gr))==null||f.classList.remove("show")},{signal:h})}o(this,pr)?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=o(this,En)),e.parentNode||t.append(e);const n=o(this,Es).getElementForAltText();n==null||n.setAttribute("aria-describedby",e.id)},b(os,_a,null),K(os,"_l10n",null);let Cy=os;var In,bi,Dl,Pe,$f,Nl,$i,Il,Fl,Ol,Wf,Sw;class Nm{constructor(t){b(this,Wf);b(this,In,null);b(this,bi,null);b(this,Dl,!1);b(this,Pe,null);b(this,$f,null);b(this,Nl,null);b(this,$i,null);b(this,Il,null);b(this,Fl,!1);b(this,Ol,null);w(this,Pe,t)}renderForToolbar(){const t=w(this,bi,document.createElement("button"));return t.className="comment",x(this,Wf,Sw).call(this,t,!1)}renderForStandalone(){const t=w(this,In,document.createElement("button"));t.className="annotationCommentButton";const e=o(this,Pe).commentButtonPosition;if(e){const{style:n}=t;n.insetInlineEnd=`calc(${100*(o(this,Pe)._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const r=o(this,Pe).commentButtonColor;r&&(n.backgroundColor=r)}return x(this,Wf,Sw).call(this,t,!0)}focusButton(){setTimeout(()=>{var t;(t=o(this,In)??o(this,bi))==null||t.focus()},0)}onUpdatedColor(){if(!o(this,In))return;const t=o(this,Pe).commentButtonColor;t&&(o(this,In).style.backgroundColor=t),o(this,Pe)._uiManager.updatePopupColor(o(this,Pe))}get commentButtonWidth(){var t;return(((t=o(this,In))==null?void 0:t.getBoundingClientRect().width)??0)/o(this,Pe).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(o(this,Ol))return o(this,Ol);if(!o(this,In))return null;const{x:t,y:e,height:n}=o(this,In).getBoundingClientRect(),{x:r,y:a,width:l,height:u}=o(this,Pe).parent.boundingClientRect;return[(t-r)/l,(e+n-a)/u]}set commentPopupPositionInLayer(t){w(this,Ol,t)}hasDefaultPopupPosition(){return o(this,Ol)===null}removeStandaloneCommentButton(){var t;(t=o(this,In))==null||t.remove(),w(this,In,null)}removeToolbarCommentButton(){var t;(t=o(this,bi))==null||t.remove(),w(this,bi,null)}setCommentButtonStates({selected:t,hasPopup:e}){o(this,In)&&(o(this,In).classList.toggle("selected",t),o(this,In).ariaExpanded=e)}edit(t){const e=this.commentPopupPositionInLayer;let n,r;if(e)[n,r]=e;else{[n,r]=o(this,Pe).commentButtonPosition;const{width:p,height:y,x:v,y:S}=o(this,Pe);n=v+n*p,r=S+r*y}const a=o(this,Pe).parent.boundingClientRect,{x:l,y:u,width:h,height:f}=a;o(this,Pe)._uiManager.editComment(o(this,Pe),l+n*h,u+r*f,{...t,parentDimensions:a})}finish(){o(this,bi)&&(o(this,bi).focus({focusVisible:o(this,Dl)}),w(this,Dl,!1))}isDeleted(){return o(this,Fl)||o(this,$i)===""}isEmpty(){return o(this,$i)===null}hasBeenEdited(){return this.isDeleted()||o(this,$i)!==o(this,$f)}serialize(){return this.data}get data(){return{text:o(this,$i),richText:o(this,Nl),date:o(this,Il),deleted:this.isDeleted()}}set data(t){if(t!==o(this,$i)&&w(this,Nl,null),t===null){w(this,$i,""),w(this,Fl,!0);return}w(this,$i,t),w(this,Il,new Date),w(this,Fl,!1)}setInitialText(t,e=null){w(this,$f,t),this.data=t,w(this,Il,null),w(this,Nl,e)}shown(){}destroy(){var t,e;(t=o(this,bi))==null||t.remove(),w(this,bi,null),(e=o(this,In))==null||e.remove(),w(this,In,null),w(this,$i,""),w(this,Nl,null),w(this,Il,null),w(this,Pe,null),w(this,Dl,!1),w(this,Fl,!1)}}In=new WeakMap,bi=new WeakMap,Dl=new WeakMap,Pe=new WeakMap,$f=new WeakMap,Nl=new WeakMap,$i=new WeakMap,Il=new WeakMap,Fl=new WeakMap,Ol=new WeakMap,Wf=new WeakSet,Sw=function(t,e){if(!o(this,Pe)._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[o(this,Pe)._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=o(this,Pe)._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return t;t.addEventListener("contextmenu",Ri,{signal:n}),e&&(t.addEventListener("focusin",a=>{o(this,Pe)._focusEventsAllowed=!1,Qe(a)},{capture:!0,signal:n}),t.addEventListener("focusout",a=>{o(this,Pe)._focusEventsAllowed=!0,Qe(a)},{capture:!0,signal:n})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:n});const r=a=>{a.preventDefault(),t===o(this,bi)?this.edit():o(this,Pe).toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:n}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(w(this,Dl,!0),r(a))},{signal:n}),t.addEventListener("pointerenter",()=>{o(this,Pe).toggleComment(!1,!0)},{signal:n}),t.addEventListener("pointerleave",()=>{o(this,Pe).toggleComment(!1,!1)},{signal:n}),t};var Ku,Bl,Vf,Gf,Xf,qf,Yf,eo,Ul,no,zl,so,sl,Fx,Ox,Bx;const qA=class qA{constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:a=null,onPinchEnd:l=null,signal:u}){b(this,sl);b(this,Ku);b(this,Bl,!1);b(this,Vf,null);b(this,Gf);b(this,Xf);b(this,qf);b(this,Yf);b(this,eo,null);b(this,Ul);b(this,no,null);b(this,zl);b(this,so,null);w(this,Ku,t),w(this,Vf,n),w(this,Gf,e),w(this,Xf,r),w(this,qf,a),w(this,Yf,l),w(this,zl,new AbortController),w(this,Ul,AbortSignal.any([u,o(this,zl).signal])),t.addEventListener("touchstart",x(this,sl,Fx).bind(this),{passive:!1,signal:o(this,Ul)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Dr.pixelRatio}destroy(){var t,e;(t=o(this,zl))==null||t.abort(),w(this,zl,null),(e=o(this,eo))==null||e.abort(),w(this,eo,null)}};Ku=new WeakMap,Bl=new WeakMap,Vf=new WeakMap,Gf=new WeakMap,Xf=new WeakMap,qf=new WeakMap,Yf=new WeakMap,eo=new WeakMap,Ul=new WeakMap,no=new WeakMap,zl=new WeakMap,so=new WeakMap,sl=new WeakSet,Fx=function(t){var r,a,l;if((r=o(this,Gf))!=null&&r.call(this))return;if(t.touches.length===1){if(o(this,eo))return;const u=w(this,eo,new AbortController),h=AbortSignal.any([o(this,Ul),u.signal]),f=o(this,Ku),p={capture:!0,signal:h,passive:!1},y=v=>{var S;v.pointerType==="touch"&&((S=o(this,eo))==null||S.abort(),w(this,eo,null))};f.addEventListener("pointerdown",v=>{v.pointerType==="touch"&&(Qe(v),y(v))},p),f.addEventListener("pointerup",y,p),f.addEventListener("pointercancel",y,p);return}if(!o(this,so)){w(this,so,new AbortController);const u=AbortSignal.any([o(this,Ul),o(this,so).signal]),h=o(this,Ku),f={signal:u,capture:!1,passive:!1};h.addEventListener("touchmove",x(this,sl,Ox).bind(this),f);const p=x(this,sl,Bx).bind(this);h.addEventListener("touchend",p,f),h.addEventListener("touchcancel",p,f),f.capture=!0,h.addEventListener("pointerdown",Qe,f),h.addEventListener("pointermove",Qe,f),h.addEventListener("pointercancel",Qe,f),h.addEventListener("pointerup",Qe,f),(a=o(this,Xf))==null||a.call(this)}if(Qe(t),t.touches.length!==2||(l=o(this,Vf))!=null&&l.call(this)){w(this,no,null);return}let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]),w(this,no,{touch0X:e.screenX,touch0Y:e.screenY,touch1X:n.screenX,touch1Y:n.screenY})},Ox=function(t){var M;if(!o(this,no)||t.touches.length!==2)return;Qe(t);let[e,n]=t.touches;e.identifier>n.identifier&&([e,n]=[n,e]);const{screenX:r,screenY:a}=e,{screenX:l,screenY:u}=n,h=o(this,no),{touch0X:f,touch0Y:p,touch1X:y,touch1Y:v}=h,S=y-f,C=v-p,E=l-r,k=u-a,T=Math.hypot(E,k)||1,L=Math.hypot(S,C)||1;if(!o(this,Bl)&&Math.abs(L-T)<=qA.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=a,h.touch1X=l,h.touch1Y=u,!o(this,Bl)){w(this,Bl,!0);return}const P=[(r+l)/2,(a+u)/2];(M=o(this,qf))==null||M.call(this,P,L,T)},Bx=function(t){var e;t.touches.length>=2||(o(this,so)&&(o(this,so).abort(),w(this,so,null),(e=o(this,Yf))==null||e.call(this)),o(this,no)&&(Qe(t),w(this,no,null),w(this,Bl,!1)))};let _y=qA;var jl,Wi,Oe,Se,io,Qu,ka,Kf,Fn,Hl,ro,xi,Ta,Qf,$l,js,Zf,Wl,oo,vr,Zu,Ju,Ei,Vl,Jf,Hy,Dt,bw,tp,xw,qm,Ux,zx,Ew,Ym,Cw,jx,Hx,$x,_w,Wx,kw,Vx,Gx,Xx,Tw,af;const zt=class zt{constructor(t){b(this,Dt);b(this,jl,null);b(this,Wi,null);b(this,Oe,null);b(this,Se,null);b(this,io,null);b(this,Qu,!1);b(this,ka,null);b(this,Kf,"");b(this,Fn,null);b(this,Hl,null);b(this,ro,null);b(this,xi,null);b(this,Ta,null);b(this,Qf,"");b(this,$l,!1);b(this,js,null);b(this,Zf,!1);b(this,Wl,!1);b(this,oo,!1);b(this,vr,null);b(this,Zu,0);b(this,Ju,0);b(this,Ei,null);b(this,Vl,null);K(this,"isSelected",!1);K(this,"_isCopy",!1);K(this,"_editToolbar",null);K(this,"_initialOptions",Object.create(null));K(this,"_initialData",null);K(this,"_isVisible",!0);K(this,"_uiManager",null);K(this,"_focusEventsAllowed",!0);b(this,Jf,!1);b(this,Hy,zt._zIndex++);this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[a,l];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const t=zt.prototype._resizeWithKeyboard,e=Hc.TRANSLATE_SMALL,n=Hc.TRANSLATE_BIG;return Ut(this,"_resizerKeyboardManager",new bg([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,n]}],[["Escape","mac+Escape"],zt.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ut(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new zk({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(zt._l10n??(zt._l10n=t),zt._l10nResizer||(zt._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),zt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);zt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Ee("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return o(this,Jf)}set _isDraggable(t){var e;w(this,Jf,t),(e=this.div)==null||e.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=o(this,Hy)}setParent(t){var e;t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(x(this,Dt,af).call(this),(e=o(this,xi))==null||e.remove(),w(this,xi,null)),this.parent=t}focusin(t){this._focusEventsAllowed&&(o(this,$l)?w(this,$l,!1):this.parent.setSelected(this))}focusout(t){var n;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const e=t.relatedTarget;e!=null&&e.closest(`#${this.id}`)||(t.preventDefault(),(n=this.parent)!=null&&n.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,n,r){const[a,l]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(t+n)/a,this.y=(e+r)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[n,r]=this.parentDimensions;this.setAt(t*n,e*r,this.width*n,this.height*r),this._onTranslated()}translate(t,e){x(this,Dt,bw).call(this,this.parentDimensions,t,e)}translateInPage(t,e){o(this,js)||w(this,js,[this.x,this.y,this.width,this.height]),x(this,Dt,bw).call(this,this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){o(this,js)||w(this,js,[this.x,this.y,this.width,this.height]);const{div:n,parentDimensions:[r,a]}=this;if(this.x+=t/r,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:u}=this;const[h,f]=this.getBaseTranslation();l+=h,u+=f;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(l,u),n.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!o(this,js)&&(o(this,js)[0]!==this.x||o(this,js)[1]!==this.y)}get _hasBeenResized(){return!!o(this,js)&&(o(this,js)[2]!==this.width||o(this,js)[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:n}=zt,r=n/t,a=n/e;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[n,r]}=this;let{x:a,y:l,width:u,height:h}=this;if(u*=n,h*=r,a*=n,l*=r,this._mustFixPosition)switch(t){case 0:a=hs(a,0,n-u),l=hs(l,0,r-h);break;case 90:a=hs(a,0,n-h),l=hs(l,u,r);break;case 180:a=hs(a,u,n),l=hs(l,h,r);break;case 270:a=hs(a,h,n),l=hs(l,0,r-u);break}this.x=a/=n,this.y=l/=r;const[f,p]=this.getBaseTranslation();a+=f,l+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(t,e){var n;return x(n=zt,tp,xw).call(n,t,e,this.parentRotation)}pageTranslationToScreen(t,e){var n;return x(n=zt,tp,xw).call(n,t,e,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,n]}=this;return[e*t,n*t]}setDims(){const{div:{style:t},width:e,height:n}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(t){return Math.round(t*1e4)/1e4}_onResizing(){}altTextFinish(){var t;(t=o(this,Oe))==null||t.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||o(this,Wl))return this._editToolbar;this._editToolbar=new fw(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,n]of t)await this._editToolbar.addButton(e,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var t;(t=this._editToolbar)==null||t.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var t;(t=this._editToolbar)==null||t.removeButton("comment")}removeEditToolbar(){var t,e;(t=this._editToolbar)==null||t.remove(),this._editToolbar=null,(e=o(this,Oe))==null||e.destroy()}addContainer(t){var n;const e=(n=this._editToolbar)==null?void 0:n.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return o(this,Oe)||(Cy.initialize(zt._l10n),w(this,Oe,new Cy(this)),o(this,jl)&&(o(this,Oe).data=o(this,jl),w(this,jl,null))),o(this,Oe)}get altTextData(){var t;return(t=o(this,Oe))==null?void 0:t.data}set altTextData(t){o(this,Oe)&&(o(this,Oe).data=t)}get guessedAltText(){var t;return(t=o(this,Oe))==null?void 0:t.guessedText}async setGuessedAltText(t){var e;await((e=o(this,Oe))==null?void 0:e.setGuessedText(t))}serializeAltText(t){var e;return(e=o(this,Oe))==null?void 0:e.serialize(t)}hasAltText(){return!!o(this,Oe)&&!o(this,Oe).isEmpty()}hasAltTextData(){var t;return((t=o(this,Oe))==null?void 0:t.hasData())??!1}focusCommentButton(){var t;(t=o(this,Se))==null||t.focusButton()}addCommentButton(){return this.canAddComment?o(this,Se)||w(this,Se,new Nm(this)):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(o(this,io)){this._uiManager.isEditingMode()&&o(this,io).classList.remove("hidden");return}this.hasComment&&(w(this,io,o(this,Se).renderForStandalone()),this.div.append(o(this,io)))}}removeStandaloneCommentButton(){o(this,Se).removeStandaloneCommentButton(),w(this,io,null)}hideStandaloneCommentButton(){var t;(t=o(this,io))==null||t.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:n,deleted:r}}=o(this,Se);return{text:e,richText:t,date:n,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){o(this,Se)||w(this,Se,new Nm(this)),o(this,Se).data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:n}){if(!e||(o(this,Se)||w(this,Se,new Nm(this)),o(this,Se).setInitialText(t,n),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){var t;return(t=o(this,Se))==null?void 0:t.hasBeenEdited()}get hasDeletedComment(){var t;return(t=o(this,Se))==null?void 0:t.isDeleted()}get hasComment(){return!!o(this,Se)&&!o(this,Se).isEmpty()&&!o(this,Se).isDeleted()}async editComment(t){o(this,Se)||w(this,Se,new Nm(this)),o(this,Se).edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){o(this,Se).setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,u=l+a+1,h=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){o(this,Se).data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var l;const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=o(this,Qu)?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),x(this,Dt,kw).call(this);const[e,n]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*n/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/n).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),bx(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(o(this,Vl)||w(this,Vl,new _y({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:x(this,Dt,jx).bind(this),onPinching:x(this,Dt,Hx).bind(this),onPinchEnd:x(this,Dt,$x).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(l=this._uiManager._editorUndoBar)==null||l.hide(),t}pointerdown(t){const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(w(this,$l,!0),this._isDraggable){x(this,Dt,Wx).call(this,t);return}x(this,Dt,_w).call(this,t)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){o(this,vr)&&clearTimeout(o(this,vr)),w(this,vr,setTimeout(()=>{var t;w(this,vr,null),(t=this.parent)==null||t.moveEditorInDOM(this)},0))}_setParentAndPosition(t,e,n){t.changeParent(this),this.x=e,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,n=this.rotation){const r=this.parentScale,[a,l]=this.pageDimensions,[u,h]=this.pageTranslation,f=t/r,p=e/r,y=this.x*a,v=this.y*l,S=this.width*a,C=this.height*l;switch(n){case 0:return[y+f+u,l-v-p-C+h,y+f+S+u,l-v-p+h];case 90:return[y+p+u,l-v+f+h,y+p+C+u,l-v+f+S+h];case 180:return[y-f-S+u,l-v+p+h,y-f+u,l-v+p+C+h];case 270:return[y-p-C+u,l-v-f-S+h,y-p+u,l-v-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[n,r,a,l]=t,u=a-n,h=l-r;switch(this.rotation){case 0:return[n,e-l,u,h];case 90:return[n,e-r,h,u];case 180:return[a,e-r,u,h];case 270:return[a,e-l,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var t;(t=o(this,Se))==null||t.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:n,opacity:r,deleted:a,richText:l},uid:u,pageIndex:h,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:t},creationDate:f,modificationDate:n||p,popupRef:!a,color:e,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),w(this,Wl,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),w(this,Wl,!1),!0):!1}isInEditMode(){return o(this,Wl)}shouldGetKeyboardEvents(){return o(this,oo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&r>0&&t<a&&n>0}rebuild(){x(this,Dt,kw).call(this)}rotate(t){}resize(){}serializeDeleted(){var t;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((t=this._initialData)==null?void 0:t.popupRef)||""}}serialize(t=!1,e=null){var n;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((n=this._initialData)==null?void 0:n.popupRef)||""}}static async deserialize(t,e,n){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:n,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,w(r,jl,t.accessibilityData),r._isCopy=t.isCopy||!1;const[a,l]=r.pageDimensions,[u,h,f,p]=r.getRectInCurrentCoords(t.rect,l);return r.x=u/a,r.y=h/l,r.width=f/a,r.height=p/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var t,e,n;if((t=o(this,Ta))==null||t.abort(),w(this,Ta,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),o(this,vr)&&(clearTimeout(o(this,vr)),w(this,vr,null)),x(this,Dt,af).call(this),this.removeEditToolbar(),o(this,Ei)){for(const r of o(this,Ei).values())clearTimeout(r);w(this,Ei,null)}this.parent=null,(e=o(this,Vl))==null||e.destroy(),w(this,Vl,null),(n=o(this,xi))==null||n.remove(),w(this,xi,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(x(this,Dt,Ux).call(this),o(this,Fn).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[n,r,a,l]=this.getPDFRect();return[zt._round(n+(a-n)*t),zt._round(r+(l-r)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return o(this,Se).commentPopupPositionInLayer}set commentPopupPosition(t){o(this,Se).commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return o(this,Se).hasDefaultPopupPosition()}get commentButtonWidth(){return o(this,Se).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){var e;(e=o(this,Se))==null||e.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),w(this,ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const e=o(this,Fn).children;if(!o(this,Wi)){w(this,Wi,Array.from(e));const l=x(this,Dt,Vx).bind(this),u=x(this,Dt,Gx).bind(this),h=this._uiManager._signal;for(const f of o(this,Wi)){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",u,{signal:h}),f.addEventListener("focus",x(this,Dt,Xx).bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",zt._l10nResizer[p])}}const n=o(this,Wi)[0];let r=0;for(const l of e){if(l===n)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(o(this,Wi).length/4);if(a!==r){if(a<r)for(let u=0;u<r-a;u++)o(this,Fn).append(o(this,Fn).firstElementChild);else if(a>r)for(let u=0;u<a-r;u++)o(this,Fn).firstElementChild.before(o(this,Fn).lastElementChild);let l=0;for(const u of e){const f=o(this,Wi)[l++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",zt._l10nResizer[f])}}x(this,Dt,Tw).call(this,0),w(this,oo,!0),o(this,Fn).firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}_resizeWithKeyboard(t,e){o(this,oo)&&x(this,Dt,Cw).call(this,o(this,Qf),{deltaX:t,deltaY:e,fromKeyboard:!0})}_stopResizingWithKeyboard(){x(this,Dt,af).call(this),this.div.focus()}select(){var t,e,n;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(t=this.div)==null||t.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var r,a;(r=this.div)!=null&&r.classList.contains("selectedEditor")&&((a=this._editToolbar)==null||a.show())});return}(e=this._editToolbar)==null||e.show(),(n=o(this,Oe))==null||n.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var t;return(t=this.div)==null?void 0:t.focus({preventScroll:!0})},0)}unselect(){var t,e,n,r,a;this.isSelected&&(this.isSelected=!1,(t=o(this,Fn))==null||t.classList.add("hidden"),(e=this.div)==null||e.classList.remove("selectedEditor"),(n=this.div)!=null&&n.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(r=this._editToolbar)==null||r.hide(),(a=o(this,Oe))==null||a.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return o(this,Zf)}set isEditing(t){w(this,Zf,t),this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){o(this,Ei)||w(this,Ei,new Map);const{action:n}=t;let r=o(this,Ei).get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),o(this,Ei).delete(n),o(this,Ei).size===0&&w(this,Ei,null)},zt._telemetryTimeout),o(this,Ei).set(n,r);return}t.type||(t.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),w(this,Qu,!1)}disable(){this.div&&(this.div.tabIndex=-1),w(this,Qu,!0)}updateFakeAnnotationElement(t){if(!o(this,xi)&&!this.deleted){w(this,xi,t.addFakeAnnotation(this));return}if(this.deleted){o(this,xi).remove(),w(this,xi,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&o(this,xi).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const n=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),n.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;(e==null?void 0:e.nodeName)==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}};jl=new WeakMap,Wi=new WeakMap,Oe=new WeakMap,Se=new WeakMap,io=new WeakMap,Qu=new WeakMap,ka=new WeakMap,Kf=new WeakMap,Fn=new WeakMap,Hl=new WeakMap,ro=new WeakMap,xi=new WeakMap,Ta=new WeakMap,Qf=new WeakMap,$l=new WeakMap,js=new WeakMap,Zf=new WeakMap,Wl=new WeakMap,oo=new WeakMap,vr=new WeakMap,Zu=new WeakMap,Ju=new WeakMap,Ei=new WeakMap,Vl=new WeakMap,Jf=new WeakMap,Hy=new WeakMap,Dt=new WeakSet,bw=function([t,e],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},tp=new WeakSet,xw=function(t,e,n){switch(n){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}},qm=function(t){switch(t){case 90:{const[e,n]=this.pageDimensions;return[0,-e/n,n/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,n]=this.pageDimensions;return[0,e/n,-n/e,0]}default:return[1,0,0,1]}},Ux=function(){if(o(this,Fn))return;w(this,Fn,document.createElement("div")),o(this,Fn).classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const n of t){const r=document.createElement("div");o(this,Fn).append(r),r.classList.add("resizer",n),r.setAttribute("data-resizer-name",n),r.addEventListener("pointerdown",x(this,Dt,zx).bind(this,n),{signal:e}),r.addEventListener("contextmenu",Ri,{signal:e}),r.tabIndex=-1}this.div.prepend(o(this,Fn))},zx=function(t,e){var p;e.preventDefault();const{isMac:n}=wn.platform;if(e.button!==0||e.ctrlKey&&n)return;(p=o(this,Oe))==null||p.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,w(this,Hl,[e.screenX,e.screenY]);const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",x(this,Dt,Cw).bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Qe,{passive:!1,signal:l}),window.addEventListener("contextmenu",Ri,{signal:l}),w(this,ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{var y;a.abort(),this.parent.togglePointerEvents(!0),(y=o(this,Oe))==null||y.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=h,x(this,Dt,Ym).call(this)};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})},Ew=function(t,e,n,r){this.width=n,this.height=r,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()},Ym=function(){if(!o(this,ro))return;const{savedX:t,savedY:e,savedWidth:n,savedHeight:r}=o(this,ro);w(this,ro,null);const a=this.x,l=this.y,u=this.width,h=this.height;a===t&&l===e&&u===n&&h===r||this.addCommands({cmd:x(this,Dt,Ew).bind(this,a,l,u,h),undo:x(this,Dt,Ew).bind(this,t,e,n,r),mustExec:!0})},Cw=function(t,e){const[n,r]=this.parentDimensions,a=this.x,l=this.y,u=this.width,h=this.height,f=zt.MIN_SIZE/n,p=zt.MIN_SIZE/r,y=x(this,Dt,qm).call(this,this.rotation),v=(ot,st)=>[y[0]*ot+y[2]*st,y[1]*ot+y[3]*st],S=x(this,Dt,qm).call(this,360-this.rotation),C=(ot,st)=>[S[0]*ot+S[2]*st,S[1]*ot+S[3]*st];let E,k,T=!1,L=!1;switch(t){case"topLeft":T=!0,E=(ot,st)=>[0,0],k=(ot,st)=>[ot,st];break;case"topMiddle":E=(ot,st)=>[ot/2,0],k=(ot,st)=>[ot/2,st];break;case"topRight":T=!0,E=(ot,st)=>[ot,0],k=(ot,st)=>[0,st];break;case"middleRight":L=!0,E=(ot,st)=>[ot,st/2],k=(ot,st)=>[0,st/2];break;case"bottomRight":T=!0,E=(ot,st)=>[ot,st],k=(ot,st)=>[0,0];break;case"bottomMiddle":E=(ot,st)=>[ot/2,st],k=(ot,st)=>[ot/2,0];break;case"bottomLeft":T=!0,E=(ot,st)=>[0,st],k=(ot,st)=>[ot,0];break;case"middleLeft":L=!0,E=(ot,st)=>[0,st/2],k=(ot,st)=>[ot,st/2];break}const P=E(u,h),M=k(u,h);let D=v(...M);const I=zt._round(a+D[0]),U=zt._round(l+D[1]);let $=1,G=1,nt,et;if(e.fromKeyboard)({deltaX:nt,deltaY:et}=e);else{const{screenX:ot,screenY:st}=e,[V,dt]=o(this,Hl);[nt,et]=this.screenToPageTranslation(ot-V,st-dt),o(this,Hl)[0]=ot,o(this,Hl)[1]=st}if([nt,et]=C(nt/n,et/r),T){const ot=Math.hypot(u,h);$=G=Math.max(Math.min(Math.hypot(M[0]-P[0]-nt,M[1]-P[1]-et)/ot,1/u,1/h),f/u,p/h)}else L?$=hs(Math.abs(M[0]-P[0]-nt),f,1)/u:G=hs(Math.abs(M[1]-P[1]-et),p,1)/h;const Ct=zt._round(u*$),_t=zt._round(h*G);D=v(...k(Ct,_t));const wt=I-D[0],kt=U-D[1];o(this,js)||w(this,js,[this.x,this.y,this.width,this.height]),this.width=Ct,this.height=_t,this.x=wt,this.y=kt,this.setDims(),this.fixAndSetPosition(),this._onResizing()},jx=function(){var t;w(this,ro,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(t=o(this,Oe))==null||t.toggle(!1),this.parent.togglePointerEvents(!1)},Hx=function(t,e,n){let a=.7*(n/e)+1-.7;if(a===1)return;const l=x(this,Dt,qm).call(this,this.rotation),u=(I,U)=>[l[0]*I+l[2]*U,l[1]*I+l[3]*U],[h,f]=this.parentDimensions,p=this.x,y=this.y,v=this.width,S=this.height,C=zt.MIN_SIZE/h,E=zt.MIN_SIZE/f;a=Math.max(Math.min(a,1/v,1/S),C/v,E/S);const k=zt._round(v*a),T=zt._round(S*a);if(k===v&&T===S)return;o(this,js)||w(this,js,[p,y,v,S]);const L=u(v/2,S/2),P=zt._round(p+L[0]),M=zt._round(y+L[1]),D=u(k/2,T/2);this.x=P-D[0],this.y=M-D[1],this.width=k,this.height=T,this.setDims(),this.fixAndSetPosition(),this._onResizing()},$x=function(){var t;(t=o(this,Oe))==null||t.toggle(!0),this.parent.togglePointerEvents(!0),x(this,Dt,Ym).call(this)},_w=function(t){const{isMac:e}=wn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)},Wx=function(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let n=!1;const r=new AbortController,a=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:a},u=f=>{r.abort(),w(this,ka,null),w(this,$l,!1),this._uiManager.endDragSession()||x(this,Dt,_w).call(this,f),n&&this._onStopDragging()};e&&(w(this,Zu,t.clientX),w(this,Ju,t.clientY),w(this,ka,t.pointerId),w(this,Kf,t.pointerType),window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:v}=f;if(v!==o(this,ka)){Qe(f);return}const[S,C]=this.screenToPageTranslation(p-o(this,Zu),y-o(this,Ju));w(this,Zu,p),w(this,Ju,y),this._uiManager.dragSelectedEditors(S,C)},l),window.addEventListener("touchmove",Qe,l),window.addEventListener("pointerdown",f=>{f.pointerType===o(this,Kf)&&(o(this,Vl)||f.isPrimary)&&u(f),Qe(f)},l));const h=f=>{if(!o(this,ka)||o(this,ka)===f.pointerId){u(f);return}Qe(f)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})},kw=function(){if(o(this,Ta)||!this.div)return;w(this,Ta,new AbortController);const t=this._uiManager.combinedSignal(o(this,Ta));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})},Vx=function(t){zt._resizerKeyboardManager.exec(this,t)},Gx=function(t){var e;o(this,oo)&&((e=t.relatedTarget)==null?void 0:e.parentNode)!==o(this,Fn)&&x(this,Dt,af).call(this)},Xx=function(t){w(this,Qf,o(this,oo)?t:"")},Tw=function(t){if(o(this,Wi))for(const e of o(this,Wi))e.tabIndex=t},af=function(){w(this,oo,!1),x(this,Dt,Tw).call(this,-1),x(this,Dt,Ym).call(this)},b(zt,tp),K(zt,"_l10n",null),K(zt,"_l10nResizer",null),K(zt,"_borderLineWidth",-1),K(zt,"_colorManager",new mw),K(zt,"_zIndex",1),K(zt,"_telemetryTimeout",1e3);let Re=zt;class zk extends Re{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const U1=3285377520,pi=4294901760,lr=65535;class qx{constructor(t){this.h1=t?t&4294967295:U1,this.h2=t?t&4294967295:U1}update(t){let e,n;if(typeof t=="string"){e=new Uint8Array(t.length*2),n=0;for(let E=0,k=t.length;E<k;E++){const T=t.charCodeAt(E);T<=255?e[n++]=T:(e[n++]=T>>>8,e[n++]=T&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),n=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=n>>2,a=n-r*4,l=new Uint32Array(e.buffer,0,r);let u=0,h=0,f=this.h1,p=this.h2;const y=3432918353,v=461845907,S=y&lr,C=v&lr;for(let E=0;E<r;E++)E&1?(u=l[E],u=u*y&pi|u*S&lr,u=u<<15|u>>>17,u=u*v&pi|u*C&lr,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[E],h=h*y&pi|h*S&lr,h=h<<15|h>>>17,h=h*v&pi|h*C&lr,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,a){case 3:u^=e[r*4+2]<<16;case 2:u^=e[r*4+1]<<8;case 1:u^=e[r*4],u=u*y&pi|u*S&lr,u=u<<15|u>>>17,u=u*v&pi|u*C&lr,r&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&pi|t*36045&lr,e=e*4283543511&pi|((e<<16|t>>>16)*2950163797&pi)>>>16,t^=e>>>1,t=t*444984403&pi|t*60499&lr,e=e*3301882366&pi|((e<<16|t>>>16)*3120437893&pi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const Pw=Object.freeze({map:null,hash:"",transfer:void 0});var Gl,Xl,ao,On,$y,Yx;class zA{constructor(){b(this,$y);b(this,Gl,!1);b(this,Xl,null);b(this,ao,null);b(this,On,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const n=o(this,On).get(t);return n===void 0?e:Object.assign(e,n)}getRawValue(t){return o(this,On).get(t)}remove(t){const e=o(this,On).get(t);if(e!==void 0&&(e instanceof Re&&o(this,ao).delete(e.annotationElementId),o(this,On).delete(t),o(this,On).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of o(this,On).values())if(n instanceof Re)return;this.onAnnotationEditor(null)}}setValue(t,e){const n=o(this,On).get(t);let r=!1;if(n!==void 0)for(const[a,l]of Object.entries(e))n[a]!==l&&(r=!0,n[a]=l);else r=!0,o(this,On).set(t,e);r&&x(this,$y,Yx).call(this),e instanceof Re&&((o(this,ao)||w(this,ao,new Map)).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return o(this,On).has(t)}get size(){return o(this,On).size}resetModified(){o(this,Gl)&&(w(this,Gl,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Kx(this)}get serializable(){if(o(this,On).size===0)return Pw;const t=new Map,e=new qx,n=[],r=Object.create(null);let a=!1;for(const[l,u]of o(this,On)){const h=u instanceof Re?u.serialize(!1,r):u;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),a||(a=!!h.bitmap))}if(a)for(const l of t.values())l.bitmap&&n.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:n}:Pw}get editorStats(){let t=null;const e=new Map;let n=0,r=0;for(const a of o(this,On).values()){if(!(a instanceof Re)){a.popup&&(a.popup.deleted?r+=1:n+=1);continue}a.isCommentDeleted?r+=1:a.hasEditedComment&&(n+=1);const l=a.telemetryFinalData;if(!l)continue;const{type:u}=l;e.has(u)||e.set(u,Object.getPrototypeOf(a).constructor),t||(t=Object.create(null));const h=t[u]||(t[u]=new Map);for(const[f,p]of Object.entries(l)){if(f==="type")continue;let y=h.get(f);y||(y=new Map,h.set(f,y));const v=y.get(p)??0;y.set(p,v+1)}}if((r>0||n>0)&&(t||(t=Object.create(null)),t.comments={deleted:r,edited:n}),!t)return null;for(const[a,l]of e)t[a]=l.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){w(this,Xl,null)}updateEditor(t,e){var r;const n=(r=o(this,ao))==null?void 0:r.get(t);return n?(n.updateFromAnnotationLayer(e),!0):!1}getEditor(t){var e;return((e=o(this,ao))==null?void 0:e.get(t))||null}get modifiedIds(){if(o(this,Xl))return o(this,Xl);const t=[];if(o(this,ao))for(const e of o(this,ao).values())e.serialize()&&t.push(e.annotationElementId);return w(this,Xl,{ids:new Set(t),hash:t.join(",")})}[Symbol.iterator](){return o(this,On).entries()}}Gl=new WeakMap,Xl=new WeakMap,ao=new WeakMap,On=new WeakMap,$y=new WeakSet,Yx=function(){o(this,Gl)||(w(this,Gl,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var ep;class Kx extends zA{constructor(e){super();b(this,ep);const{map:n,hash:r,transfer:a}=e.serializable,l=structuredClone(n,a?{transfer:a}:null);w(this,ep,{map:l,hash:r,transfer:a})}get print(){Ee("Should not call PrintAnnotationStorage.print")}get serializable(){return o(this,ep)}get modifiedIds(){return Ut(this,"modifiedIds",{ids:new Set,hash:""})}}ep=new WeakMap;var th;class jk{constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){b(this,th,new Set);this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),o(this,th).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:n}){if(!(!t||o(this,th).has(t.loadedName))){if(Zt(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:a,style:l}=t,u=new FontFace(r,a,l);this.addNativeFontFace(u);try{await u.load(),o(this,th).add(r),n==null||n(t)}catch{Bt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Ee("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const n=t.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(r){throw Bt(`Failed to load font '${n.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const r=this._queueLoadingCallback(n);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){var e;const t=!!((e=this._document)!=null&&e.fonts);return Ut(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return Ut(this,"isSyncFontLoadingSupported",us||wn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Zt(!r.done,"completeRequest() cannot be called twice."),r.done=!0;n.length>0&&n[0].done;){const a=n.shift();setTimeout(a.callback,0)}}const{loadingRequests:n}=this,r={done:!1,complete:e,callback:t};return n.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ut(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function n(M,D){return M.charCodeAt(D)<<24|M.charCodeAt(D+1)<<16|M.charCodeAt(D+2)<<8|M.charCodeAt(D+3)&255}function r(M,D,I,U){const $=M.substring(0,D),G=M.substring(D+I);return $+U+G}let a,l;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let f=0;function p(M,D){if(++f>30){Bt("Load test font never loaded."),D();return}if(h.font="30px "+M,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(p.bind(null,M,D))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=r(v,976,y.length,y);const C=16,E=1482184792;let k=n(v,C);for(a=0,l=y.length-3;a<l;a+=4)k=k-E+n(y,a)|0;a<y.length&&(k=k-E+n(y+"XXX",a)|0),v=r(v,C,4,Sk(k));const T=`url(data:font/opentype;base64,${btoa(v)});`,L=`@font-face {font-family:"${y}";src:${T}}`;this.insertRule(L);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const M of[t.loadedName,y]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=M,P.append(D)}this._document.body.append(P),p(y,()=>{P.remove(),e.complete()})}}th=new WeakMap;var me;class Hk{constructor(t,e=null,n,r){b(this,me);this.compiledGlyphs=Object.create(null),w(this,me,t),this._inspectFont=e,n&&Object.assign(this,n),r&&(this.charProcOperatorList=r)}createNativeFontFace(){var e;if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const n={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(n.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,n)}return(e=this._inspectFont)==null||e.call(this,this),t}createFontFaceRule(){var n;if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${fx(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let r=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(r+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${r}src:${t}}`}return(n=this._inspectFont)==null||n.call(this,this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const n=this.loadedName+"_path_"+e;let r;try{r=t.get(n)}catch(l){Bt(`getPathGenerator - ignoring character: "${l}".`)}const a=mx(r==null?void 0:r.path);return this.fontExtraProperties||t.delete(n),this.compiledGlyphs[e]=a}get black(){return o(this,me).black}get bold(){return o(this,me).bold}get disableFontFace(){return o(this,me).disableFontFace??!1}set disableFontFace(t){Ut(this,"disableFontFace",!!t)}get fontExtraProperties(){return o(this,me).fontExtraProperties??!1}get isInvalidPDFjsFont(){return o(this,me).isInvalidPDFjsFont}get isType3Font(){return o(this,me).isType3Font}get italic(){return o(this,me).italic}get missingFile(){return o(this,me).missingFile}get remeasure(){return o(this,me).remeasure}get vertical(){return o(this,me).vertical}get ascent(){return o(this,me).ascent}get defaultWidth(){return o(this,me).defaultWidth}get descent(){return o(this,me).descent}get bbox(){return o(this,me).bbox}set bbox(t){Ut(this,"bbox",t)}get fontMatrix(){return o(this,me).fontMatrix}get fallbackName(){return o(this,me).fallbackName}get loadedName(){return o(this,me).loadedName}get mimetype(){return o(this,me).mimetype}get name(){return o(this,me).name}get data(){return o(this,me).data}clearData(){o(this,me).clearData()}get cssFontInfo(){return o(this,me).cssFontInfo}get systemFontInfo(){return o(this,me).systemFontInfo}get defaultVMetrics(){return o(this,me).defaultVMetrics}}me=new WeakMap;var eh,nh,np,sh,Km;const Pu=class Pu{constructor(t){b(this,sh);b(this,eh);b(this,nh);b(this,np);w(this,eh,t),w(this,nh,new DataView(o(this,eh))),w(this,np,new TextDecoder)}static write(t){const e=new TextEncoder,n={};let r=0;for(const f of Pu.strings){const p=e.encode(t[f]);n[f]=p,r+=4+p.length}const a=new ArrayBuffer(r),l=new Uint8Array(a),u=new DataView(a);let h=0;for(const f of Pu.strings){const p=n[f],y=p.length;u.setUint32(h,y),l.set(p,h+4),h+=4+y}return Zt(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}get fontFamily(){return x(this,sh,Km).call(this,0)}get fontWeight(){return x(this,sh,Km).call(this,1)}get italicAngle(){return x(this,sh,Km).call(this,2)}};eh=new WeakMap,nh=new WeakMap,np=new WeakMap,sh=new WeakSet,Km=function(t){Zt(t<Pu.strings.length,"Invalid string index");let e=0;for(let r=0;r<t;r++)e+=o(this,nh).getUint32(e)+4;const n=o(this,nh).getUint32(e);return o(this,np).decode(new Uint8Array(o(this,eh),e+4,n))},K(Pu,"strings",["fontFamily","fontWeight","italicAngle"]);let ky=Pu;var Pa,wr,ql,Yl,lf;const Ru=class Ru{constructor(t){b(this,Yl);b(this,Pa);b(this,wr);b(this,ql);w(this,Pa,t),w(this,wr,new DataView(o(this,Pa))),w(this,ql,new TextDecoder)}static write(t){const e=new TextEncoder,n={};let r=0;for(const v of Ru.strings){const S=e.encode(t[v]);n[v]=S,r+=4+S.length}r+=4;let a,l,u=1+r;t.style&&(a=e.encode(t.style.style),l=e.encode(t.style.weight),u+=4+a.length+4+l.length);const h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,r=0;for(const v of Ru.strings){const S=n[v],C=S.length;r+=4+C,p.setUint32(y,C),f.set(S,y+4),y+=4+C}return p.setUint32(y-r-4,r),t.style&&(p.setUint32(y,a.length),f.set(a,y+4),y+=4+a.length,p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length),Zt(y<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(y)}get guessFallback(){return o(this,wr).getUint8(0)!==0}get css(){return x(this,Yl,lf).call(this,0)}get loadedName(){return x(this,Yl,lf).call(this,1)}get baseFontName(){return x(this,Yl,lf).call(this,2)}get src(){return x(this,Yl,lf).call(this,3)}get style(){let t=1;t+=4+o(this,wr).getUint32(t);const e=o(this,wr).getUint32(t),n=o(this,ql).decode(new Uint8Array(o(this,Pa),t+4,e));t+=4+e;const r=o(this,wr).getUint32(t),a=o(this,ql).decode(new Uint8Array(o(this,Pa),t+4,r));return{style:n,weight:a}}};Pa=new WeakMap,wr=new WeakMap,ql=new WeakMap,Yl=new WeakSet,lf=function(t){Zt(t<Ru.strings.length,"Invalid string index");let e=5;for(let r=0;r<t;r++)e+=o(this,wr).getUint32(e)+4;const n=o(this,wr).getUint32(e);return o(this,ql).decode(new Uint8Array(o(this,Pa),e+4,n))},K(Ru,"strings",["css","loadedName","baseFontName","src"]);let Ty=Ru;var ih,rh,oh,ah,Hs,Ar,sp,ye,Ke,zi,Qm,cf;const Ht=class Ht{constructor({data:t,extra:e}){b(this,Ke);b(this,Ar);b(this,sp);b(this,ye);w(this,Ar,t),w(this,sp,new TextDecoder),w(this,ye,new DataView(o(this,Ar))),e&&Object.assign(this,e)}get black(){return x(this,Ke,zi).call(this,0)}get bold(){return x(this,Ke,zi).call(this,1)}get disableFontFace(){return x(this,Ke,zi).call(this,2)}get fontExtraProperties(){return x(this,Ke,zi).call(this,3)}get isInvalidPDFjsFont(){return x(this,Ke,zi).call(this,4)}get isType3Font(){return x(this,Ke,zi).call(this,5)}get italic(){return x(this,Ke,zi).call(this,6)}get missingFile(){return x(this,Ke,zi).call(this,7)}get remeasure(){return x(this,Ke,zi).call(this,8)}get vertical(){return x(this,Ke,zi).call(this,9)}get ascent(){return x(this,Ke,Qm).call(this,0)}get defaultWidth(){return x(this,Ke,Qm).call(this,1)}get descent(){return x(this,Ke,Qm).call(this,2)}get bbox(){let t=o(Ht,rh);if(o(this,ye).getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<4;r++)n.push(o(this,ye).getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=o(Ht,oh);if(o(this,ye).getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<6;r++)n.push(o(this,ye).getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=o(Ht,ah);if(o(this,ye).getUint8(t)===0)return;t+=1;const n=[];for(let r=0;r<3;r++)n.push(o(this,ye).getInt16(t,!0)),t+=2;return n}get fallbackName(){return x(this,Ke,cf).call(this,0)}get loadedName(){return x(this,Ke,cf).call(this,1)}get mimetype(){return x(this,Ke,cf).call(this,2)}get name(){return x(this,Ke,cf).call(this,3)}get data(){let t=o(Ht,Hs);const e=o(this,ye).getUint32(t);t+=4+e;const n=o(this,ye).getUint32(t);t+=4+n;const r=o(this,ye).getUint32(t);t+=4+r;const a=o(this,ye).getUint32(t);if(a!==0)return new Uint8Array(o(this,Ar),t+4,a)}clearData(){let t=o(Ht,Hs);const e=o(this,ye).getUint32(t);t+=4+e;const n=o(this,ye).getUint32(t);t+=4+n;const r=o(this,ye).getUint32(t);t+=4+r;const a=o(this,ye).getUint32(t);new Uint8Array(o(this,Ar),t+4,a).fill(0),o(this,ye).setUint32(t,0)}get cssFontInfo(){let t=o(Ht,Hs);const e=o(this,ye).getUint32(t);t+=4+e;const n=o(this,ye).getUint32(t);t+=4+n;const r=o(this,ye).getUint32(t);if(r===0)return null;const a=new Uint8Array(r);return a.set(new Uint8Array(o(this,Ar),t+4,r)),new ky(a.buffer)}get systemFontInfo(){let t=o(Ht,Hs);const e=o(this,ye).getUint32(t);t+=4+e;const n=o(this,ye).getUint32(t);if(n===0)return null;const r=new Uint8Array(n);return r.set(new Uint8Array(o(this,Ar),t+4,n)),new Ty(r.buffer)}static write(t){const e=t.systemFontInfo?Ty.write(t.systemFontInfo):null,n=t.cssFontInfo?ky.write(t.cssFontInfo):null,r=new TextEncoder,a={};let l=0;for(const E of Ht.strings)a[E]=r.encode(t[E]),l+=4+a[E].length;const u=o(Ht,Hs)+4+l+4+(e?e.byteLength:0)+4+(n?n.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),f=new Uint8Array(h),p=new DataView(h);let y=0;const v=Ht.bools.length;let S=0,C=0;for(let E=0;E<v;E++){const k=t[Ht.bools[E]];S|=(k===void 0?0:k?2:1)<<C,C+=2,(C===8||E===v-1)&&(p.setUint8(y++,S),S=0,C=0)}Zt(y===o(Ht,ih),"FontInfo.write: Boolean properties offset mismatch");for(const E of Ht.numbers)p.setFloat64(y,t[E]),y+=8;if(Zt(y===o(Ht,rh),"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const E of t.bbox)p.setInt16(y,E,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Zt(y===o(Ht,oh),"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const E of t.fontMatrix)p.setFloat64(y,E,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Zt(y===o(Ht,ah),"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const E of t.defaultVMetrics)p.setInt16(y,E,!0),y+=2}else p.setUint8(y++,0),y+=6;Zt(y===o(Ht,Hs),"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(o(Ht,Hs),0),y+=4;for(const E of Ht.strings){const k=a[E],T=k.length;p.setUint32(y,T),f.set(k,y+4),y+=4+T}if(p.setUint32(o(Ht,Hs),y-o(Ht,Hs)-4),!e)p.setUint32(y,0),y+=4;else{const E=e.byteLength;p.setUint32(y,E),Zt(y+4+E<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+E}if(!n)p.setUint32(y,0),y+=4;else{const E=n.byteLength;p.setUint32(y,E),Zt(y+4+E<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),y+4),y+=4+E}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Zt(y<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(y)}};ih=new WeakMap,rh=new WeakMap,oh=new WeakMap,ah=new WeakMap,Hs=new WeakMap,Ar=new WeakMap,sp=new WeakMap,ye=new WeakMap,Ke=new WeakSet,zi=function(t){Zt(t<Ht.bools.length,"Invalid boolean index");const e=Math.floor(t/4),n=t*2%8,r=o(this,ye).getUint8(e)>>n&3;return r===0?void 0:r===2},Qm=function(t){return Zt(t<Ht.numbers.length,"Invalid number index"),o(this,ye).getFloat64(o(Ht,ih)+t*8)},cf=function(t){Zt(t<Ht.strings.length,"Invalid string index");let e=o(Ht,Hs)+4;for(let a=0;a<t;a++)e+=o(this,ye).getUint32(e)+4;const n=o(this,ye).getUint32(e),r=new Uint8Array(n);return r.set(new Uint8Array(o(this,Ar),e+4,n)),o(this,sp).decode(r)},K(Ht,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),K(Ht,"numbers",["ascent","defaultWidth","descent"]),K(Ht,"strings",["fallbackName","loadedName","mimetype","name"]),b(Ht,ih,Math.ceil(Ht.bools.length*2/8)),b(Ht,rh,o(Ht,ih)+Ht.numbers.length*8),b(Ht,oh,o(Ht,rh)+1+8),b(Ht,ah,o(Ht,oh)+1+48),b(Ht,Hs,o(Ht,ah)+1+6);let Rw=Ht;var ip,rp,op,ap,lp,cp,up,hp;const Te=class Te{constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,n=null,r=[],a=[],l=[],u=[],h=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,n=t[2],l=t[3],e===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,h=t[1],r=t[2],a=t[3],u=t[4]||[],n=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(r.length/2),y=Math.floor(a.length/3),v=l.length,S=u.length;let C=0;for(const D of u)C+=1,C=Math.ceil(C/4)*4,C+=4+D.coords.length*4,C+=4+D.colors.length*4,D.verticesPerRow!==void 0&&(C+=4);const E=20+p*8+y*3+v*8+(n?16:0)+(f?3:0)+C,k=new ArrayBuffer(E),T=new DataView(k),L=new Uint8Array(k);T.setUint8(o(Te,ip),e),T.setUint8(o(Te,rp),n?1:0),T.setUint8(o(Te,op),f?1:0),T.setUint8(o(Te,ap),h),T.setUint32(o(Te,lp),p,!0),T.setUint32(o(Te,cp),y,!0),T.setUint32(o(Te,up),v,!0),T.setUint32(o(Te,hp),S,!0);let P=20;new Float32Array(k,P,p*2).set(r),P+=p*8,L.set(a,P),P+=y*3;for(const[D,I]of l)T.setFloat32(P,D,!0),P+=4,T.setUint32(P,parseInt(I.slice(1),16),!0),P+=4;if(n)for(const D of n)T.setFloat32(P,D,!0),P+=4;f&&(L.set(f,P),P+=3);for(let D=0;D<u.length;D++){const I=u[D];T.setUint8(P,I.type),P+=1,P=Math.ceil(P/4)*4,T.setUint32(P,I.coords.length,!0),P+=4,new Int32Array(k,P,I.coords.length).set(I.coords),P+=I.coords.length*4,T.setUint32(P,I.colors.length,!0),P+=4,new Int32Array(k,P,I.colors.length).set(I.colors),P+=I.colors.length*4,I.verticesPerRow!==void 0&&(T.setUint32(P,I.verticesPerRow,!0),P+=4)}return k}getIR(){const t=this.view,e=this.data[o(Te,ip)],n=!!this.data[o(Te,rp)],r=!!this.data[o(Te,op)],a=t.getUint32(o(Te,lp),!0),l=t.getUint32(o(Te,cp),!0),u=t.getUint32(o(Te,up),!0),h=t.getUint32(o(Te,hp),!0);let f=20;const p=new Float32Array(this.buffer,f,a*2);f+=a*8;const y=new Uint8Array(this.buffer,f,l*3);f+=l*3;const v=[];for(let k=0;k<u;++k){const T=t.getFloat32(f,!0);f+=4;const L=t.getUint32(f,!0);f+=4,v.push([T,`#${L.toString(16).padStart(6,"0")}`])}let S=null;if(n){S=[];for(let k=0;k<4;++k)S.push(t.getFloat32(f,!0)),f+=4}let C=null;r&&(C=new Uint8Array(this.buffer,f,3),f+=3);const E=[];for(let k=0;k<h;++k){const T=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const L=t.getUint32(f,!0);f+=4;const P=new Int32Array(this.buffer,f,L);f+=L*4;const M=t.getUint32(f,!0);f+=4;const D=new Int32Array(this.buffer,f,M);f+=M*4;const I={type:T,coords:P,colors:D};T===lw.LATTICE&&(I.verticesPerRow=t.getUint32(f,!0),f+=4),E.push(I)}if(e===1)return["RadialAxial","axial",S,v,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",S,v,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const k=this.data[o(Te,ap)];let T=null;if(p.length>0){let L=p[0],P=p[0],M=p[1],D=p[1];for(let I=0;I<p.length;I+=2){const U=p[I],$=p[I+1];L=L>U?U:L,M=M>$?$:M,P=P<U?U:P,D=D<$?$:D}T=[L,M,P,D]}return["Mesh",k,p,y,E,T,S,C]}throw new Error(`Unsupported pattern kind: ${e}`)}};ip=new WeakMap,rp=new WeakMap,op=new WeakMap,ap=new WeakMap,lp=new WeakMap,cp=new WeakMap,up=new WeakMap,hp=new WeakMap,b(Te,ip,0),b(Te,rp,1),b(Te,op,2),b(Te,ap,3),b(Te,lp,4),b(Te,cp,8),b(Te,up,12),b(Te,hp,16);let Lw=Te;var lh;class $k{constructor(t){b(this,lh);w(this,lh,t)}static write(t){let e,n;return wn.isFloat16ArraySupported?(n=new ArrayBuffer(t.length*2),e=new Float16Array(n)):(n=new ArrayBuffer(t.length*4),e=new Float32Array(n)),e.set(t),n}get path(){return wn.isFloat16ArraySupported?new Float16Array(o(this,lh)):new Float32Array(o(this,lh))}}lh=new WeakMap;function Wk(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if(us)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Vk(g){if(us&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return vg(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g==null?void 0:g.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Im(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const Mw=g=>typeof g=="object"&&Number.isInteger(g==null?void 0:g.num)&&g.num>=0&&Number.isInteger(g==null?void 0:g.gen)&&g.gen>=0,Gk=g=>typeof g=="object"&&typeof(g==null?void 0:g.name)=="string",Xk=_k.bind(null,Mw,Gk);var lo,Wy;class qk{constructor(){b(this,lo,new Map);b(this,Wy,Promise.resolve())}postMessage(t,e){const n={data:structuredClone(t,e?{transfer:e}:null)};o(this,Wy).then(()=>{for(const[r]of o(this,lo))r.call(this,n)})}addEventListener(t,e,n=null){let r=null;if((n==null?void 0:n.signal)instanceof AbortSignal){const{signal:a}=n;if(a.aborted){Bt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);r=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}o(this,lo).set(e,r)}removeEventListener(t,e){const n=o(this,lo).get(e);n==null||n(),o(this,lo).delete(e)}terminate(){for(const[,t]of o(this,lo))t==null||t();o(this,lo).clear()}}lo=new WeakMap,Wy=new WeakMap;const Fm={DATA:1,ERROR:2},an={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z1(){}function bs(g){if(g instanceof el||g instanceof cw||g instanceof M1||g instanceof xy||g instanceof Zv)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||Ee('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new el(g.message);case"InvalidPDFException":return new cw(g.message);case"PasswordException":return new M1(g.message,g.code);case"ResponseException":return new xy(g.message,g.status,g.missing);case"UnknownErrorException":return new Zv(g.message,g.details)}return new Zv(g.message,g.toString())}var ch,Pi,Qx,Zx,Jx,Zm;class uf{constructor(t,e,n){b(this,Pi);b(this,ch,new AbortController);this.sourceName=t,this.targetName=e,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",x(this,Pi,Qx).bind(this),{signal:o(this,ch).signal})}on(t,e){const n=this.actionHandler;if(n[t])throw new Error(`There is already an actionName called "${t}"`);n[t]=e}send(t,e,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},n)}sendWithPromise(t,e,n){const r=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[r]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},n)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,n,r){const a=this.streamId++,l=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:u,action:t,streamId:a,data:e,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:u,stream:an.PULL,streamId:a,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Zt(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:u,stream:an.CANCEL,streamId:a,reason:bs(f)}),p.promise}},n)}destroy(){var t;(t=o(this,ch))==null||t.abort(),w(this,ch,null)}}ch=new WeakMap,Pi=new WeakSet,Qx=function({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){x(this,Pi,Jx).call(this,t);return}if(t.callback){const n=t.callbackId,r=this.callbackCapabilities[n];if(!r)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],t.callback===Fm.DATA)r.resolve(t.data);else if(t.callback===Fm.ERROR)r.reject(bs(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const n=this.sourceName,r=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:n,targetName:r,callback:Fm.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:n,targetName:r,callback:Fm.ERROR,callbackId:t.callbackId,reason:bs(l)})});return}if(t.streamId){x(this,Pi,Zx).call(this,t);return}e(t.data)},Zx=function(t){const e=t.streamId,n=this.sourceName,r=t.sourceName,a=this.comObj,l=this,u=this.actionHandler[t.action],h={enqueue(f,p=1,y){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:n,targetName:r,stream:an.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:r,stream:an.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Zt(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:n,targetName:r,stream:an.ERROR,streamId:e,reason:bs(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(u,t.data,h).then(function(){a.postMessage({sourceName:n,targetName:r,stream:an.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:r,stream:an.START_COMPLETE,streamId:e,reason:bs(f)})})},Jx=function(t){const e=t.streamId,n=this.sourceName,r=t.sourceName,a=this.comObj,l=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case an.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(bs(t.reason));break;case an.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(bs(t.reason));break;case an.PULL:if(!u){a.postMessage({sourceName:n,targetName:r,stream:an.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||z1).then(function(){a.postMessage({sourceName:n,targetName:r,stream:an.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:r,stream:an.PULL_COMPLETE,streamId:e,reason:bs(f)})});break;case an.ENQUEUE:if(Zt(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case an.CLOSE:if(Zt(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),x(this,Pi,Zm).call(this,l,e);break;case an.ERROR:Zt(l,"error should have stream controller"),l.controller.error(bs(t.reason)),x(this,Pi,Zm).call(this,l,e);break;case an.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(bs(t.reason)),x(this,Pi,Zm).call(this,l,e);break;case an.CANCEL:if(!u)break;const h=bs(t.reason);Promise.try(u.onCancel||z1,h).then(function(){a.postMessage({sourceName:n,targetName:r,stream:an.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:n,targetName:r,stream:an.CANCEL_COMPLETE,streamId:e,reason:bs(f)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}},Zm=async function(t,e){var n,r,a;await Promise.allSettled([(n=t.startCall)==null?void 0:n.promise,(r=t.pullCall)==null?void 0:r.promise,(a=t.cancelCall)==null?void 0:a.promise]),delete this.streamControllers[e]};var dp;class tE{constructor({enableHWA:t=!1}){b(this,dp,!1);w(this,dp,t)}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(t,e);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!o(this,dp)})}}reset(t,e,n){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||n<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=n}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Ee("Abstract method `_createCanvas` called.")}}dp=new WeakMap;class Yk extends tE{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const n=this._document.createElement("canvas");return n.width=t,n.height=e,n}}class eE{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class j1 extends eE{async _fetch(t){const e=await wg(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):vg(e)}}class nE{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,n,r,a){return"none"}destroy(t=!1){}}var Kl,uh,co,uo,Zn,Ql,Zl,ht,qn,hf,Au,Jm,Su,sE,Dw,bu,df,ff,Nw,pf;class Kk extends nE{constructor({docId:e,ownerDocument:n=globalThis.document}){super();b(this,ht);b(this,Kl);b(this,uh);b(this,co);b(this,uo);b(this,Zn);b(this,Ql);b(this,Zl,0);w(this,uo,e),w(this,Zn,n)}addFilter(e){if(!e)return"none";let n=o(this,ht,qn).get(e);if(n)return n;const[r,a,l]=x(this,ht,Jm).call(this,e),u=e.length===1?r:`${r}${a}${l}`;if(n=o(this,ht,qn).get(u),n)return o(this,ht,qn).set(e,n),n;const h=`g_${o(this,uo)}_transfer_map_${fn(this,Zl)._++}`,f=x(this,ht,Su).call(this,h);o(this,ht,qn).set(e,f),o(this,ht,qn).set(u,f);const p=x(this,ht,bu).call(this,h);return x(this,ht,ff).call(this,r,a,l,p),f}addHCMFilter(e,n){var C;const r=`${e}-${n}`,a="base";let l=o(this,ht,hf).get(a);if((l==null?void 0:l.key)===r||(l?((C=l.filter)==null||C.remove(),l.key=r,l.url="none",l.filter=null):(l={key:r,url:"none",filter:null},o(this,ht,hf).set(a,l)),!e||!n))return l.url;const u=x(this,ht,pf).call(this,e);e=at.makeHexColor(...u);const h=x(this,ht,pf).call(this,n);if(n=at.makeHexColor(...h),o(this,ht,Au).style.color="",e==="#000000"&&n==="#ffffff"||e===n)return l.url;const f=new Array(256);for(let E=0;E<=255;E++){const k=E/255;f[E]=k<=.03928?k/12.92:((k+.055)/1.055)**2.4}const p=f.join(","),y=`g_${o(this,uo)}_hcm_filter`,v=l.filter=x(this,ht,bu).call(this,y);x(this,ht,ff).call(this,p,p,p,v),x(this,ht,Dw).call(this,v);const S=(E,k)=>{const T=u[E]/255,L=h[E]/255,P=new Array(k+1);for(let M=0;M<=k;M++)P[M]=T+M/k*(L-T);return P.join(",")};return x(this,ht,ff).call(this,S(0,5),S(1,5),S(2,5),v),l.url=x(this,ht,Su).call(this,y),l.url}addAlphaFilter(e){let n=o(this,ht,qn).get(e);if(n)return n;const[r]=x(this,ht,Jm).call(this,[e]),a=`alpha_${r}`;if(n=o(this,ht,qn).get(a),n)return o(this,ht,qn).set(e,n),n;const l=`g_${o(this,uo)}_alpha_map_${fn(this,Zl)._++}`,u=x(this,ht,Su).call(this,l);o(this,ht,qn).set(e,u),o(this,ht,qn).set(a,u);const h=x(this,ht,bu).call(this,l);return x(this,ht,Nw).call(this,r,h),u}addLuminosityFilter(e){let n=o(this,ht,qn).get(e||"luminosity");if(n)return n;let r,a;if(e?([r]=x(this,ht,Jm).call(this,[e]),a=`luminosity_${r}`):a="luminosity",n=o(this,ht,qn).get(a),n)return o(this,ht,qn).set(e,n),n;const l=`g_${o(this,uo)}_luminosity_map_${fn(this,Zl)._++}`,u=x(this,ht,Su).call(this,l);o(this,ht,qn).set(e,u),o(this,ht,qn).set(a,u);const h=x(this,ht,bu).call(this,l);return x(this,ht,sE).call(this,h),e&&x(this,ht,Nw).call(this,r,h),u}addHighlightHCMFilter(e,n,r,a,l){var L;const u=`${n}-${r}-${a}-${l}`;let h=o(this,ht,hf).get(e);if((h==null?void 0:h.key)===u||(h?((L=h.filter)==null||L.remove(),h.key=u,h.url="none",h.filter=null):(h={key:u,url:"none",filter:null},o(this,ht,hf).set(e,h)),!n||!r))return h.url;const[f,p]=[n,r].map(x(this,ht,pf).bind(this));let y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),v=Math.round(.2126*p[0]+.7152*p[1]+.0722*p[2]),[S,C]=[a,l].map(x(this,ht,pf).bind(this));v<y&&([y,v,S,C]=[v,y,C,S]),o(this,ht,Au).style.color="";const E=(P,M,D)=>{const I=new Array(256),U=(v-y)/D,$=P/255,G=(M-P)/(255*D);let nt=0;for(let et=0;et<=D;et++){const Ct=Math.round(y+et*U),_t=$+et*G;for(let wt=nt;wt<=Ct;wt++)I[wt]=_t;nt=Ct+1}for(let et=nt;et<256;et++)I[et]=I[nt-1];return I.join(",")},k=`g_${o(this,uo)}_hcm_${e}_filter`,T=h.filter=x(this,ht,bu).call(this,k);return x(this,ht,Dw).call(this,T),x(this,ht,ff).call(this,E(S[0],C[0],5),E(S[1],C[1],5),E(S[2],C[2],5),T),h.url=x(this,ht,Su).call(this,k),h.url}destroy(e=!1){var n,r,a,l;e&&((n=o(this,Ql))!=null&&n.size)||((r=o(this,co))==null||r.parentNode.parentNode.remove(),w(this,co,null),(a=o(this,uh))==null||a.clear(),w(this,uh,null),(l=o(this,Ql))==null||l.clear(),w(this,Ql,null),w(this,Zl,0))}}Kl=new WeakMap,uh=new WeakMap,co=new WeakMap,uo=new WeakMap,Zn=new WeakMap,Ql=new WeakMap,Zl=new WeakMap,ht=new WeakSet,qn=function(){return o(this,uh)||w(this,uh,new Map)},hf=function(){return o(this,Ql)||w(this,Ql,new Map)},Au=function(){if(!o(this,co)){const e=o(this,Zn).createElement("div"),{style:n}=e;n.visibility="hidden",n.contain="strict",n.width=n.height=0,n.position="absolute",n.top=n.left=0,n.zIndex=-1;const r=o(this,Zn).createElementNS(Gr,"svg");r.setAttribute("width",0),r.setAttribute("height",0),w(this,co,o(this,Zn).createElementNS(Gr,"defs")),e.append(r),r.append(o(this,co)),o(this,Zn).body.append(e)}return o(this,co)},Jm=function(e){if(e.length===1){const f=e[0],p=new Array(256);for(let v=0;v<256;v++)p[v]=f[v]/255;const y=p.join(",");return[y,y,y]}const[n,r,a]=e,l=new Array(256),u=new Array(256),h=new Array(256);for(let f=0;f<256;f++)l[f]=n[f]/255,u[f]=r[f]/255,h[f]=a[f]/255;return[l.join(","),u.join(","),h.join(",")]},Su=function(e){if(o(this,Kl)===void 0){w(this,Kl,"");const n=o(this,Zn).URL;n!==o(this,Zn).baseURI&&(r0(n)?Bt('#createUrl: ignore "data:"-URL for performance reasons.'):w(this,Kl,ux(n,"")))}return`url(${o(this,Kl)}#${e})`},sE=function(e){const n=o(this,Zn).createElementNS(Gr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(n)},Dw=function(e){const n=o(this,Zn).createElementNS(Gr,"feColorMatrix");n.setAttribute("type","matrix"),n.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(n)},bu=function(e){const n=o(this,Zn).createElementNS(Gr,"filter");return n.setAttribute("color-interpolation-filters","sRGB"),n.setAttribute("id",e),o(this,ht,Au).append(n),n},df=function(e,n,r){const a=o(this,Zn).createElementNS(Gr,n);a.setAttribute("type","discrete"),a.setAttribute("tableValues",r),e.append(a)},ff=function(e,n,r,a){const l=o(this,Zn).createElementNS(Gr,"feComponentTransfer");a.append(l),x(this,ht,df).call(this,l,"feFuncR",e),x(this,ht,df).call(this,l,"feFuncG",n),x(this,ht,df).call(this,l,"feFuncB",r)},Nw=function(e,n){const r=o(this,Zn).createElementNS(Gr,"feComponentTransfer");n.append(r),x(this,ht,df).call(this,r,"feFuncA",e)},pf=function(e){return o(this,ht,Au).style.color=e,Sg(getComputedStyle(o(this,ht,Au)).getPropertyValue("color"))};class iE{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class H1 extends iE{async _fetch(t){const e=await wg(t,"arraybuffer");return new Uint8Array(e)}}class rE{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(n=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Ee("Abstract method `_fetch` called.")}}class $1 extends rE{async _fetch(t){const e=await wg(t,"arraybuffer");return new Uint8Array(e)}}us&&Bt("Please use the `legacy` build in Node.js environments.");async function jA(g){const e=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(e)}class Qk extends nE{}class Zk extends tE{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class Jk extends eE{async _fetch(t){return jA(t)}}class tT extends iE{async _fetch(t){return jA(t)}}class eT extends rE{async _fetch(t){return jA(t)}}const yu="__forcedDependency",{floor:W1,ceil:V1}=Math;function Om(g,t,e,n,r,a){g[t*4+0]=Math.min(g[t*4+0],e),g[t*4+1]=Math.min(g[t*4+1],n),g[t*4+2]=Math.max(g[t*4+2],r),g[t*4+3]=Math.max(g[t*4+3],a)}const Iw=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var hh,Ra;class nT{constructor(t,e){b(this,hh);b(this,Ra);w(this,hh,t),w(this,Ra,e)}get length(){return o(this,hh).length}isEmpty(t){return o(this,hh)[t]===Iw}minX(t){return o(this,Ra)[t*4+0]/256}minY(t){return o(this,Ra)[t*4+1]/256}maxX(t){return(o(this,Ra)[t*4+2]+1)/256}maxY(t){return(o(this,Ra)[t*4+3]+1)/256}}hh=new WeakMap,Ra=new WeakMap;const Bm=(g,t)=>{if(!g)return;let e=g.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},g.set(t,e)),e};var Cs,_s,Jl,Vi,tc,ho,pe,ve,fo,ks,fp,dh,ec,nc,po,Jn,Sr,pp,Fw;class sT{constructor(t,e,n=!1){b(this,pp);b(this,Cs,{__proto__:null});b(this,_s,{__proto__:null,transform:[],moveText:[],sameLineText:[],[yu]:[]});b(this,Jl,new Map);b(this,Vi,[]);b(this,tc,[]);b(this,ho,[[1,0,0,1,0,0]]);b(this,pe,[-1/0,-1/0,1/0,1/0]);b(this,ve,new Float64Array([1/0,1/0,-1/0,-1/0]));b(this,fo,-1);b(this,ks,new Set);b(this,fp,new Map);b(this,dh,new Map);b(this,ec);b(this,nc);b(this,po);b(this,Jn);b(this,Sr);w(this,ec,t.width),w(this,nc,t.height),x(this,pp,Fw).call(this,e),n&&w(this,Sr,new Map)}growOperationsCount(t){t>=o(this,Jn).length&&x(this,pp,Fw).call(this,t,o(this,Jn))}save(t){return w(this,Cs,{__proto__:o(this,Cs)}),w(this,_s,{__proto__:o(this,_s),transform:{__proto__:o(this,_s).transform},moveText:{__proto__:o(this,_s).moveText},sameLineText:{__proto__:o(this,_s).sameLineText},[yu]:{__proto__:o(this,_s)[yu]}}),w(this,pe,{__proto__:o(this,pe)}),o(this,Vi).push(t),this}restore(t){var r;const e=Object.getPrototypeOf(o(this,Cs));if(e===null)return this;w(this,Cs,e),w(this,_s,Object.getPrototypeOf(o(this,_s))),w(this,pe,Object.getPrototypeOf(o(this,pe)));const n=o(this,Vi).pop();return n!==void 0&&((r=Bm(o(this,Sr),t))==null||r.dependencies.add(n),o(this,Jn)[t]=o(this,Jn)[n]),this}recordOpenMarker(t){return o(this,Vi).push(t),this}getOpenMarker(){return o(this,Vi).length===0?null:o(this,Vi).at(-1)}recordCloseMarker(t){var n;const e=o(this,Vi).pop();return e!==void 0&&((n=Bm(o(this,Sr),t))==null||n.dependencies.add(e),o(this,Jn)[t]=o(this,Jn)[e]),this}beginMarkedContent(t){return o(this,tc).push(t),this}endMarkedContent(t){var n;const e=o(this,tc).pop();return e!==void 0&&((n=Bm(o(this,Sr),t))==null||n.dependencies.add(e),o(this,Jn)[t]=o(this,Jn)[e]),this}pushBaseTransform(t){return o(this,ho).push(at.multiplyByDOMMatrix(o(this,ho).at(-1),t.getTransform())),this}popBaseTransform(){return o(this,ho).length>1&&o(this,ho).pop(),this}recordSimpleData(t,e){return o(this,Cs)[t]=e,this}recordIncrementalData(t,e){return o(this,_s)[t].push(e),this}resetIncrementalData(t,e){return o(this,_s)[t].length=0,this}recordNamedData(t,e){return o(this,Jl).set(t,e),this}recordSimpleDataFromNamed(t,e,n){o(this,Cs)[t]=o(this,Jl).get(e)??n}recordFutureForcedDependency(t,e){return this.recordIncrementalData(yu,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in o(this,Cs)&&this.recordFutureForcedDependency(e,o(this,Cs)[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of o(this,ks))this.recordFutureForcedDependency(yu,t);return this}resetBBox(t){return o(this,fo)!==t&&(w(this,fo,t),o(this,ve)[0]=1/0,o(this,ve)[1]=1/0,o(this,ve)[2]=-1/0,o(this,ve)[3]=-1/0),this}recordClipBox(t,e,n,r,a,l){const u=at.multiplyByDOMMatrix(o(this,ho).at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];at.axialAlignedBoundingBox([n,a,r,l],u,h);const f=at.intersect(o(this,pe),h);return f?(o(this,pe)[0]=f[0],o(this,pe)[1]=f[1],o(this,pe)[2]=f[2],o(this,pe)[3]=f[3]):(o(this,pe)[0]=o(this,pe)[1]=1/0,o(this,pe)[2]=o(this,pe)[3]=-1/0),this}recordBBox(t,e,n,r,a,l){const u=o(this,pe);if(u[0]===1/0)return this;const h=at.multiplyByDOMMatrix(o(this,ho).at(-1),e.getTransform());if(u[0]===-1/0)return at.axialAlignedBoundingBox([n,a,r,l],h,o(this,ve)),this;const f=[1/0,1/0,-1/0,-1/0];return at.axialAlignedBoundingBox([n,a,r,l],h,f),o(this,ve)[0]=Math.min(o(this,ve)[0],Math.max(f[0],u[0])),o(this,ve)[1]=Math.min(o(this,ve)[1],Math.max(f[1],u[1])),o(this,ve)[2]=Math.max(o(this,ve)[2],Math.min(f[2],u[2])),o(this,ve)[3]=Math.max(o(this,ve)[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,n,r=1,a=0,l=0,u){const h=n.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&o(this,dh).get(n),f!==!1&&(p=[0,0,0,0],at.axialAlignedBoundingBox(h,n.fontMatrix,p),(r!==1||a!==0||l!==0)&&at.scaleMinMax([r,0,0,-r,a,l],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return h&&p&&f===void 0&&(f=p[0]<=a-y.actualBoundingBoxLeft&&p[2]>=a+y.actualBoundingBoxRight&&p[1]<=l-y.actualBoundingBoxAscent&&p[3]>=l+y.actualBoundingBoxDescent,o(this,dh).set(n,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-y.actualBoundingBoxLeft,a+y.actualBoundingBoxRight,l-y.actualBoundingBoxAscent,l+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return o(this,ve)[0]=Math.max(0,o(this,pe)[0]),o(this,ve)[1]=Math.max(0,o(this,pe)[1]),o(this,ve)[2]=Math.min(o(this,ec),o(this,pe)[2]),o(this,ve)[3]=Math.min(o(this,nc),o(this,pe)[3]),this}getSimpleIndex(t){return o(this,Cs)[t]}recordDependencies(t,e){const n=o(this,ks),r=o(this,Cs),a=o(this,_s);for(const l of e)l in o(this,Cs)?n.add(r[l]):l in a&&a[l].forEach(n.add,n);return this}recordNamedDependency(t,e){return o(this,Jl).has(e)&&o(this,ks).add(o(this,Jl).get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[yu]),o(this,Sr)){const n=Bm(o(this,Sr),t),{dependencies:r}=n;o(this,ks).forEach(r.add,r),o(this,Vi).forEach(r.add,r),o(this,tc).forEach(r.add,r),r.delete(t),n.isRenderingOperation=!0}if(o(this,fo)===t){const n=W1(o(this,ve)[0]*256/o(this,ec)),r=W1(o(this,ve)[1]*256/o(this,nc)),a=V1(o(this,ve)[2]*256/o(this,ec)),l=V1(o(this,ve)[3]*256/o(this,nc));Om(o(this,po),t,n,r,a,l);for(const u of o(this,ks))u!==t&&Om(o(this,po),u,n,r,a,l);for(const u of o(this,Vi))u!==t&&Om(o(this,po),u,n,r,a,l);for(const u of o(this,tc))u!==t&&Om(o(this,po),u,n,r,a,l);e||(o(this,ks).clear(),w(this,fo,-1))}return this}recordShowTextOperation(t,e=!1){const n=Array.from(o(this,ks));this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const r of n)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,e=!1){return o(this,fo)===t&&(w(this,fo,-1),o(this,pe)[0]=Math.max(o(this,pe)[0],o(this,ve)[0]),o(this,pe)[1]=Math.max(o(this,pe)[1],o(this,ve)[1]),o(this,pe)[2]=Math.min(o(this,pe)[2],o(this,ve)[2]),o(this,pe)[3]=Math.min(o(this,pe)[3],o(this,ve)[3]),e||o(this,ks).clear()),this}_takePendingDependencies(){const t=o(this,ks);return w(this,ks,new Set),t}_extractOperation(t){const e=o(this,fp).get(t);return o(this,fp).delete(t),e}_pushPendingDependencies(t){for(const e of t)o(this,ks).add(e)}take(){return o(this,dh).clear(),new nT(o(this,Jn),o(this,po))}takeDebugMetadata(){return o(this,Sr)}}Cs=new WeakMap,_s=new WeakMap,Jl=new WeakMap,Vi=new WeakMap,tc=new WeakMap,ho=new WeakMap,pe=new WeakMap,ve=new WeakMap,fo=new WeakMap,ks=new WeakMap,fp=new WeakMap,dh=new WeakMap,ec=new WeakMap,nc=new WeakMap,po=new WeakMap,Jn=new WeakMap,Sr=new WeakMap,pp=new WeakSet,Fw=function(t,e){const n=new ArrayBuffer(t*4);w(this,po,new Uint8ClampedArray(n)),w(this,Jn,new Uint32Array(n)),e&&e.length>0?(o(this,Jn).set(e),o(this,Jn).fill(Iw,e.length)):o(this,Jn).fill(Iw)};var be,Xe,Gi,fh,ph;const YA=class YA{constructor(t,e,n){b(this,be);b(this,Xe);b(this,Gi);b(this,fh,0);b(this,ph,0);if(t instanceof YA&&o(t,Gi)===!!n)return t;w(this,be,t),w(this,Xe,e),w(this,Gi,!!n)}growOperationsCount(){throw new Error("Unreachable")}save(t){return fn(this,ph)._++,o(this,be).save(o(this,Xe)),this}restore(t){return o(this,ph)>0&&(o(this,be).restore(o(this,Xe)),fn(this,ph)._--),this}recordOpenMarker(t){return fn(this,fh)._++,this}getOpenMarker(){return o(this,fh)>0?o(this,Xe):o(this,be).getOpenMarker()}recordCloseMarker(t){return fn(this,fh)._--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return o(this,be).pushBaseTransform(t),this}popBaseTransform(){return o(this,be).popBaseTransform(),this}recordSimpleData(t,e){return o(this,be).recordSimpleData(t,o(this,Xe)),this}recordIncrementalData(t,e){return o(this,be).recordIncrementalData(t,o(this,Xe)),this}resetIncrementalData(t,e){return o(this,be).resetIncrementalData(t,o(this,Xe)),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,n){return o(this,be).recordSimpleDataFromNamed(t,e,o(this,Xe)),this}recordFutureForcedDependency(t,e){return o(this,be).recordFutureForcedDependency(t,o(this,Xe)),this}inheritSimpleDataAsFutureForcedDependencies(t){return o(this,be).inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return o(this,be).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return o(this,Gi)||o(this,be).resetBBox(o(this,Xe)),this}recordClipBox(t,e,n,r,a,l){return o(this,Gi)||o(this,be).recordClipBox(o(this,Xe),e,n,r,a,l),this}recordBBox(t,e,n,r,a,l){return o(this,Gi)||o(this,be).recordBBox(o(this,Xe),e,n,r,a,l),this}recordCharacterBBox(t,e,n,r,a,l,u){return o(this,Gi)||o(this,be).recordCharacterBBox(o(this,Xe),e,n,r,a,l,u),this}recordFullPageBBox(t){return o(this,Gi)||o(this,be).recordFullPageBBox(o(this,Xe)),this}getSimpleIndex(t){return o(this,be).getSimpleIndex(t)}recordDependencies(t,e){return o(this,be).recordDependencies(o(this,Xe),e),this}recordNamedDependency(t,e){return o(this,be).recordNamedDependency(o(this,Xe),e),this}recordOperation(t){return o(this,be).recordOperation(o(this,Xe),!0),this}recordShowTextOperation(t){return o(this,be).recordShowTextOperation(o(this,Xe),!0),this}bboxToClipBoxDropOperation(t){return o(this,Gi)||o(this,be).bboxToClipBoxDropOperation(o(this,Xe),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};be=new WeakMap,Xe=new WeakMap,Gi=new WeakMap,fh=new WeakMap,ph=new WeakMap;let Py=YA;const gi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},zn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function Ow(g,t){if(!t)return;const e=t[2]-t[0],n=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,n),g.clip(r)}class HA{isModifyingCurrentTransform(){return!1}getPattern(){Ee("Abstract method `getPattern` called.")}}class iT extends HA{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let n,r=this._p0,a=this._p1;if(e&&(r=r.slice(),a=a.slice(),at.applyTransform(r,e),at.applyTransform(a,e)),this._type==="axial")n=t.createLinearGradient(r[0],r[1],a[0],a[1]);else if(this._type==="radial"){let l=this._r0,u=this._r1;if(e){const h=new Float32Array(2);at.singularValueDecompose2dScale(e,h),l*=h[0],u*=h[0]}n=t.createRadialGradient(r[0],r[1],l,a[0],a[1],u)}for(const l of this._colorStops)n.addColorStop(l[0],l[1]);return n}getPattern(t,e,n,r){let a;if(r===zn.STROKE||r===zn.FILL){if(this.isOriginBased()){let v=at.transform(n,e.baseTransform);this.matrix&&(v=at.transform(v,this.matrix));const S=.001,C=Math.hypot(v[0],v[1]),E=Math.hypot(v[2],v[3]),k=(v[0]*v[2]+v[1]*v[3])/(C*E);if(Math.abs(k)<S)if(this.isRadial()){if(Math.abs(C-E)<S)return this._createGradient(t,v)}else return this._createGradient(t,v)}const l=e.current.getClippedPathBoundingBox(r,He(t))||[0,0,0,0],u=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=at.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),Ow(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(n);a.setTransform(y)}else Ow(t,this._bbox),a=this._createGradient(t);return a}}function ew(g,t,e,n,r,a,l,u){const h=t.coords,f=t.colors,p=g.data,y=g.width*4;let v;h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v),h[n+1]>h[r+1]&&(v=n,n=r,r=v,v=l,l=u,u=v),h[e+1]>h[n+1]&&(v=e,e=n,n=v,v=a,a=l,l=v);const S=(h[e]+t.offsetX)*t.scaleX,C=(h[e+1]+t.offsetY)*t.scaleY,E=(h[n]+t.offsetX)*t.scaleX,k=(h[n+1]+t.offsetY)*t.scaleY,T=(h[r]+t.offsetX)*t.scaleX,L=(h[r+1]+t.offsetY)*t.scaleY;if(C>=L)return;const P=f[a],M=f[a+1],D=f[a+2],I=f[l],U=f[l+1],$=f[l+2],G=f[u],nt=f[u+1],et=f[u+2],Ct=Math.round(C),_t=Math.round(L);let wt,kt,ot,st,V,dt,Z,O;for(let H=Ct;H<=_t;H++){if(H<k){const Pt=H<C?0:(C-H)/(C-k);wt=S-(S-E)*Pt,kt=P-(P-I)*Pt,ot=M-(M-U)*Pt,st=D-(D-$)*Pt}else{let Pt;H>L?Pt=1:k===L?Pt=0:Pt=(k-H)/(k-L),wt=E-(E-T)*Pt,kt=I-(I-G)*Pt,ot=U-(U-nt)*Pt,st=$-($-et)*Pt}let lt;H<C?lt=0:H>L?lt=1:lt=(C-H)/(C-L),V=S-(S-T)*lt,dt=P-(P-G)*lt,Z=M-(M-nt)*lt,O=D-(D-et)*lt;const Tt=Math.round(Math.min(wt,V)),bt=Math.round(Math.max(wt,V));let Mt=y*H+Tt*4;for(let Pt=Tt;Pt<=bt;Pt++)lt=(wt-Pt)/(wt-V),lt<0?lt=0:lt>1&&(lt=1),p[Mt++]=kt-(kt-dt)*lt|0,p[Mt++]=ot-(ot-Z)*lt|0,p[Mt++]=st-(st-O)*lt|0,p[Mt++]=255}}function rT(g,t,e){const n=t.coords,r=t.colors;let a,l;switch(t.type){case lw.LATTICE:const u=t.verticesPerRow,h=Math.floor(n.length/u)-1,f=u-1;for(a=0;a<h;a++){let p=a*u;for(let y=0;y<f;y++,p++)ew(g,e,n[p],n[p+1],n[p+u],r[p],r[p+1],r[p+u]),ew(g,e,n[p+u+1],n[p+1],n[p+u],r[p+u+1],r[p+1],r[p+u])}break;case lw.TRIANGLES:for(a=0,l=n.length;a<l;a+=3)ew(g,e,n[a],n[a+1],n[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class oT extends HA{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,n){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-h,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),S=f/y,C=p/v,E={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/S,scaleY:1/C},k=y+4,T=v+4,L=n.getCanvas("mesh",k,T),P=L.context,M=P.createImageData(y,v);if(e){const I=M.data;for(let U=0,$=I.length;U<$;U+=4)I[U]=e[0],I[U+1]=e[1],I[U+2]=e[2],I[U+3]=255}for(const I of this._figures)rT(M,I,E);return P.putImageData(M,2,2),{canvas:L.canvas,offsetX:u-2*S,offsetY:h-2*C,scaleX:S,scaleY:C}}isModifyingCurrentTransform(){return!0}getPattern(t,e,n,r){Ow(t,this._bbox);const a=new Float32Array(2);if(r===zn.SHADING)at.singularValueDecompose2dScale(He(t),a);else if(this.matrix){at.singularValueDecompose2dScale(this.matrix,a);const[u,h]=a;at.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=h}else at.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,r===zn.SHADING?null:this._background,e.cachedCanvases);return r!==zn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class aT extends HA{getPattern(){return"hotpink"}}function lT(g){switch(g[0]){case"RadialAxial":return new iT(g);case"Mesh":return new oT(g);case"Dummy":return new aT}throw new Error(`Unknown IR type: ${g[0]}`)}const G1={COLORED:1,UNCOLORED:2},Vy=class Vy{constructor(t,e,n,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(t,e){var dt,Z;const{bbox:n,operatorList:r,paintType:a,tilingType:l,color:u,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),i0("TilingType: "+l);const y=n[0],v=n[1],S=n[2],C=n[3],E=S-y,k=C-v,T=new Float32Array(2);at.singularValueDecompose2dScale(this.matrix,T);const[L,P]=T;at.singularValueDecompose2dScale(this.baseTransform,T);const M=L*T[0],D=P*T[1];let I=E,U=k,$=!1,G=!1;const nt=Math.ceil(f*M),et=Math.ceil(p*D),Ct=Math.ceil(E*M),_t=Math.ceil(k*D);nt>=Ct?I=f:$=!0,et>=_t?U=p:G=!0;const wt=this.getSizeAndScale(I,this.ctx.canvas.width,M),kt=this.getSizeAndScale(U,this.ctx.canvas.height,D),ot=t.cachedCanvases.getCanvas("pattern",wt.size,kt.size),st=ot.context,V=h.createCanvasGraphics(st,e);if(V.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(V,a,u),st.translate(-wt.scale*y,-kt.scale*v),V.transform(0,wt.scale,0,0,kt.scale,0,0),st.save(),(dt=V.dependencyTracker)==null||dt.save(),this.clipBbox(V,y,v,S,C),V.baseTransform=He(V.ctx),V.executeOperatorList(r),V.endDrawing(),(Z=V.dependencyTracker)==null||Z.restore(),st.restore(),$||G){const O=ot.canvas;$&&(I=f),G&&(U=p);const H=this.getSizeAndScale(I,this.ctx.canvas.width,M),lt=this.getSizeAndScale(U,this.ctx.canvas.height,D),Tt=H.size,bt=lt.size,Mt=t.cachedCanvases.getCanvas("pattern-workaround",Tt,bt),Pt=Mt.context,Et=$?Math.floor(E/f):0,ae=G?Math.floor(k/p):0;for(let We=0;We<=Et;We++)for(let es=0;es<=ae;es++)Pt.drawImage(O,Tt*We,bt*es,Tt,bt,0,0,Tt,bt);return{canvas:Mt.canvas,scaleX:H.scale,scaleY:lt.scale,offsetX:y,offsetY:v}}return{canvas:ot.canvas,scaleX:wt.scale,scaleY:kt.scale,offsetX:y,offsetY:v}}getSizeAndScale(t,e,n){const r=Math.max(Vy.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*n);return a>=r?a=r:n=a/t,{scale:n,size:a}}clipBbox(t,e,n,r,a){const l=r-e,u=a-n;t.ctx.rect(e,n,l,u),at.axialAlignedBoundingBox([e,n,r,a],He(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,n){const r=t.ctx,a=t.current;switch(e){case G1.COLORED:const{fillStyle:l,strokeStyle:u}=this.ctx;r.fillStyle=a.fillColor=l,r.strokeStyle=a.strokeColor=u;break;case G1.UNCOLORED:r.fillStyle=r.strokeStyle=n,a.fillColor=a.strokeColor=n;break;default:throw new Ak(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,n,r,a){let l=n;r!==zn.SHADING&&(l=at.transform(l,e.baseTransform),this.matrix&&(l=at.transform(l,this.matrix)));const u=this.createPatternCanvas(e,a);let h=new DOMMatrix(l);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(h),f}};K(Vy,"MAX_PATTERN_SIZE",3e3);let Bw=Vy;function cT({src:g,srcPos:t=0,dest:e,width:n,height:r,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const u=wn.isLittleEndian?4278190080:255,[h,f]=l?[a,u]:[u,a],p=n>>3,y=n&7,v=g.length;e=new Uint32Array(e.buffer);let S=0;for(let C=0;C<r;C++){for(const k=t+p;t<k;t++){const T=t<v?g[t]:255;e[S++]=T&128?f:h,e[S++]=T&64?f:h,e[S++]=T&32?f:h,e[S++]=T&16?f:h,e[S++]=T&8?f:h,e[S++]=T&4?f:h,e[S++]=T&2?f:h,e[S++]=T&1?f:h}if(y===0)continue;const E=t<v?g[t++]:255;for(let k=0;k<y;k++)e[S++]=E&1<<7-k?f:h}return{srcPos:t,destPos:S}}const X1=16,q1=100,uT=15,Y1=10,Rs=16,nw=new DOMMatrix,ri=new Float32Array(2),ku=new Float32Array([1/0,1/0,-1/0,-1/0]);function hT(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},g.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},g.transform=function(e,n,r,a,l,u){t.transform(e,n,r,a,l,u),this.__originalTransform(e,n,r,a,l,u)},g.setTransform=function(e,n,r,a,l,u){t.setTransform(e,n,r,a,l,u),this.__originalSetTransform(e,n,r,a,l,u)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(e){t.rotate(e),this.__originalRotate(e)},g.clip=function(e){t.clip(e),this.__originalClip(e)},g.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},g.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},g.bezierCurveTo=function(e,n,r,a,l,u){t.bezierCurveTo(e,n,r,a,l,u),this.__originalBezierCurveTo(e,n,r,a,l,u)},g.rect=function(e,n,r,a){t.rect(e,n,r,a),this.__originalRect(e,n,r,a)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class dT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,n){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,n)):(r=this.canvasFactory.create(e,n),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Um(g,t,e,n,r,a,l,u,h,f){const[p,y,v,S,C,E]=He(g);if(y===0&&v===0){const L=l*p+C,P=Math.round(L),M=u*S+E,D=Math.round(M),I=(l+h)*p+C,U=Math.abs(Math.round(I)-P)||1,$=(u+f)*S+E,G=Math.abs(Math.round($)-D)||1;return g.setTransform(Math.sign(p),0,0,Math.sign(S),P,D),g.drawImage(t,e,n,r,a,0,0,U,G),g.setTransform(p,y,v,S,C,E),[U,G]}if(p===0&&S===0){const L=u*v+C,P=Math.round(L),M=l*y+E,D=Math.round(M),I=(u+f)*v+C,U=Math.abs(Math.round(I)-P)||1,$=(l+h)*y+E,G=Math.abs(Math.round($)-D)||1;return g.setTransform(0,Math.sign(y),Math.sign(v),0,P,D),g.drawImage(t,e,n,r,a,0,0,G,U),g.setTransform(p,y,v,S,C,E),[G,U]}g.drawImage(t,e,n,r,a,l,u,h,f);const k=Math.hypot(p,y),T=Math.hypot(v,S);return[k*h,T*f]}class K1{constructor(t,e,n){K(this,"alphaIsShape",!1);K(this,"fontSize",0);K(this,"fontSizeScale",1);K(this,"textMatrix",null);K(this,"textMatrixScale",1);K(this,"fontMatrix",aw);K(this,"leading",0);K(this,"x",0);K(this,"y",0);K(this,"lineX",0);K(this,"lineY",0);K(this,"charSpacing",0);K(this,"wordSpacing",0);K(this,"textHScale",1);K(this,"textRenderingMode",pn.FILL);K(this,"textRise",0);K(this,"fillColor","#000000");K(this,"strokeColor","#000000");K(this,"patternFill",!1);K(this,"patternStroke",!1);K(this,"fillAlpha",1);K(this,"strokeAlpha",1);K(this,"lineWidth",1);K(this,"activeSMask",null);K(this,"transferMaps","none");n==null||n(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=ku.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=zn.FILL,e=null){const n=this.minMax.slice();if(t===zn.STROKE){e||Ee("Stroke bounding box must include transform."),at.singularValueDecompose2dScale(e,ri);const r=ri[0]*this.lineWidth/2,a=ri[1]*this.lineWidth/2;n[0]-=r,n[1]-=a,n[2]+=r,n[3]+=a}return n}updateClipFromPath(){const t=at.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ku,0)}getClippedPathBoundingBox(t=zn.FILL,e=null){return at.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function Q1(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const e=t.height,n=t.width,r=e%Rs,a=(e-r)/Rs,l=r===0?a:a+1,u=g.createImageData(n,Rs);let h=0,f;const p=t.data,y=u.data;let v,S,C,E;if(t.kind===$m.GRAYSCALE_1BPP){const k=p.byteLength,T=new Uint32Array(y.buffer,0,y.byteLength>>2),L=T.length,P=n+7>>3,M=4294967295,D=wn.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(C=v<a?Rs:r,f=0,S=0;S<C;S++){const I=k-h;let U=0;const $=I>P?n:I*8-7,G=$&-8;let nt=0,et=0;for(;U<G;U+=8)et=p[h++],T[f++]=et&128?M:D,T[f++]=et&64?M:D,T[f++]=et&32?M:D,T[f++]=et&16?M:D,T[f++]=et&8?M:D,T[f++]=et&4?M:D,T[f++]=et&2?M:D,T[f++]=et&1?M:D;for(;U<$;U++)nt===0&&(et=p[h++],nt=128),T[f++]=et&nt?M:D,nt>>=1}for(;f<L;)T[f++]=0;g.putImageData(u,0,v*Rs)}}else if(t.kind===$m.RGBA_32BPP){for(S=0,E=n*Rs*4,v=0;v<a;v++)y.set(p.subarray(h,h+E)),h+=E,g.putImageData(u,0,S),S+=Rs;v<l&&(E=n*r*4,y.set(p.subarray(h,h+E)),g.putImageData(u,0,S))}else if(t.kind===$m.RGB_24BPP)for(C=Rs,E=n*C,v=0;v<l;v++){for(v>=a&&(C=r,E=n*C),f=0,S=E;S--;)y[f++]=p[h++],y[f++]=p[h++],y[f++]=p[h++],y[f++]=255;g.putImageData(u,0,v*Rs)}else throw new Error(`bad image kind: ${t.kind}`)}function Z1(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const e=t.height,n=t.width,r=e%Rs,a=(e-r)/Rs,l=r===0?a:a+1,u=g.createImageData(n,Rs);let h=0;const f=t.data,p=u.data;for(let y=0;y<l;y++){const v=y<a?Rs:r;({srcPos:h}=cT({src:f,srcPos:h,dest:p,width:n,height:v,nonBlackColor:0})),g.putImageData(u,0,y*Rs)}}function Qd(g,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of e)g[n]!==void 0&&(t[n]=g[n]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function zm(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function J1(g,t){if(t)return!0;at.singularValueDecompose2dScale(g,ri);const e=Math.fround(Dr.pixelRatio*nl.PDF_TO_CSS_UNITS);return ri[0]<=e&&ri[1]<=e}const fT=["butt","round","square"],pT=["miter","round","bevel"],gT={},tx={};var er,Uw,zw,jw;const KA=class KA{constructor(t,e,n,r,a,{optionalContentConfig:l,markedContentStack:u=null},h,f,p){b(this,er);this.ctx=t,this.current=new K1(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=n,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=l,this.cachedCanvases=new dT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,n=null){var r;return typeof e=="string"?((r=this.dependencyTracker)==null||r.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):n}beginDrawing({transform:t,viewport:e,transparency:n=!1,background:r=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=u,n){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...He(this.compositeCtx))}this.ctx.save(),zm(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=He(this.ctx)}executeOperatorList(t,e,n,r,a){var T;const l=t.argsArray,u=t.fnArray;let h=e||0;const f=l.length;if(f===h)return h;const p=f-h>Y1&&typeof n=="function",y=p?Date.now()+uT:0;let v=0;const S=this.commonObjs,C=this.objs;let E,k;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,n),h;if(!a||a(h))if(E=u[h],k=l[h]??null,E!==Ef.dependency)k===null?this[E](h):this[E](h,...k);else for(const L of k){(T=this.dependencyTracker)==null||T.recordNamedData(L,h);const P=L.startsWith("g_")?S:C;if(!P.has(L))return P.get(L,n),h}if(h++,h===f)return h;if(p&&++v>Y1){if(Date.now()>y)return n(),h;v=0}}}endDrawing(){x(this,er,Uw).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),x(this,er,zw).call(this)}_scaleImage(t,e){const n=t.width??t.displayWidth,r=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),u=n,h=r,f="prescale1",p,y;for(;a>2&&u>1||l>2&&h>1;){let v=u,S=h;a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/v),l>2&&h>1&&(S=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/S),p=this.cachedCanvases.getCanvas(f,v,S),y=p.context,y.clearRect(0,0,v,S),y.drawImage(t,0,0,u,h,0,0,v,S),t=p.canvas,u=v,h=S,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,e){var nt,et;const n=this.ctx,{width:r,height:a}=e,l=this.current.fillColor,u=this.current.patternFill,h=He(n);let f,p,y,v;if((e.bitmap||e.data)&&e.count>1){const Ct=e.bitmap||e.data.buffer;p=JSON.stringify(u?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(Ct),f||(f=new Map,this._cachedBitmapsMap.set(Ct,f));const _t=f.get(p);if(_t&&!u){const wt=Math.round(Math.min(h[0],h[2])+h[4]),kt=Math.round(Math.min(h[1],h[3])+h[5]);return(nt=this.dependencyTracker)==null||nt.recordDependencies(t,gi.transformAndFill),{canvas:_t,offsetX:wt,offsetY:kt}}y=_t}y||(v=this.cachedCanvases.getCanvas("maskCanvas",r,a),Z1(v.context,e));let S=at.transform(h,[1/r,0,0,-1/a,0,0]);S=at.transform(S,[1,0,0,1,0,-a]);const C=ku.slice();at.axialAlignedBoundingBox([0,0,r,a],S,C);const[E,k,T,L]=C,P=Math.round(T-E)||1,M=Math.round(L-k)||1,D=this.cachedCanvases.getCanvas("fillCanvas",P,M),I=D.context,U=E,$=k;I.translate(-U,-$),I.transform(...S),y||(y=this._scaleImage(v.canvas,ar(I)),y=y.img,f&&u&&f.set(p,y)),I.imageSmoothingEnabled=J1(He(I),e.interpolate),Um(I,y,0,0,y.width,y.height,0,0,r,a),I.globalCompositeOperation="source-in";const G=at.transform(ar(I),[1,0,0,1,-U,-$]);return I.fillStyle=u?l.getPattern(n,this,G,zn.FILL,t):l,I.fillRect(0,0,r,a),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,D.canvas)),(et=this.dependencyTracker)==null||et.recordDependencies(t,gi.transformAndFill),{canvas:D.canvas,offsetX:Math.round(U),offsetY:Math.round($)}}setLineWidth(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineCap",t),this.ctx.lineCap=fT[e]}setLineJoin(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("lineJoin",t),this.ctx.lineJoin=pT[e]}setMiterLimit(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,n){var a;(a=this.dependencyTracker)==null||a.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=n)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){var n,r,a,l,u;for(const[h,f]of e)switch(h){case"LW":this.setLineWidth(t,f);break;case"LC":this.setLineCap(t,f);break;case"LJ":this.setLineJoin(t,f);break;case"ML":this.setMiterLimit(t,f);break;case"D":this.setDash(t,f[0],f[1]);break;case"RI":this.setRenderingIntent(t,f);break;case"FL":this.setFlatness(t,f);break;case"Font":this.setFont(t,f[0],f[1]);break;case"CA":(n=this.dependencyTracker)==null||n.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=f;break;case"ca":(r=this.dependencyTracker)==null||r.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=f;break;case"BM":(a=this.dependencyTracker)==null||a.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=f;break;case"SMask":(l=this.dependencyTracker)==null||l.recordSimpleData("SMask",t),this.current.activeSMask=f?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(u=this.dependencyTracker)==null||u.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(f);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,n=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(r,e,n);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),Qd(this.suspendedCtx,l),hT(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Qd(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,n,r){const a=r[0],l=r[1],u=r[2]-a,h=r[3]-l;u===0||h===0||(this.genericComposeSMask(e.context,n,u,h,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(n.canvas,0,0),t.restore())}genericComposeSMask(t,e,n,r,a,l,u,h,f,p,y){let v=t.canvas,S=h-p,C=f-y;if(l)if(S<0||C<0||S+n>v.width||C+r>v.height){const k=this.cachedCanvases.getCanvas("maskExtension",n,r),T=k.context;T.drawImage(v,-S,-C),T.globalCompositeOperation="destination-atop",T.fillStyle=l,T.fillRect(0,0,n,r),T.globalCompositeOperation="source-over",v=k.canvas,S=C=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const k=new Path2D;k.rect(S,C,n,r),t.clip(k),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(S,C,n,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const E=new Path2D;E.rect(h,f,n,r),e.clip(E),e.globalCompositeOperation="destination-in",e.drawImage(v,S,C,n,r,h,f,n,r),e.restore()}save(t){var n;this.inSMaskMode&&Qd(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),(n=this.dependencyTracker)==null||n.save(t)}restore(t){var e;if((e=this.dependencyTracker)==null||e.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Qd(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,n,r,a,l,u){var h;(h=this.dependencyTracker)==null||h.recordIncrementalData("transform",t),this.ctx.transform(e,n,r,a,l,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,n,r){let[a]=n;if(!r){a||(a=n[0]=new Path2D),this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===Ef.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-l,r[2]+l,r[1]-l,r[3]+l).recordDependencies(t,["transform"])}a instanceof Path2D||(a=n[0]=mx(a)),at.axialAlignedBoundingBox(r,He(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,n=!0){var l;const r=this.ctx,a=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&(a!=null&&a.getPattern)){const u=a.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=a.getPattern(r,this,ar(r),zn.STROKE,t),u){const h=new Path2D;h.addPath(e,r.getTransform().invertSelf().multiplySelf(u)),e=h}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);(l=this.dependencyTracker)==null||l.recordDependencies(t,gi.stroke),n&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(zn.STROKE,He(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,n=!0){var f,p,y;const r=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let u=!1;if(l){const v=a.isModifyingCurrentTransform()?r.getTransform():null;if((f=this.dependencyTracker)==null||f.save(t),r.save(),r.fillStyle=a.getPattern(r,this,ar(r),zn.FILL,t),v){const S=new Path2D;S.addPath(e,r.getTransform().invertSelf().multiplySelf(v)),e=S}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),(p=this.dependencyTracker)==null||p.recordDependencies(t,gi.fill),u&&(r.restore(),(y=this.dependencyTracker)==null||y.restore(t)),n&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){var n;this.ctx.fill(e),(n=this.dependencyTracker)==null||n.recordDependencies(t,gi.rawFillPath).recordOperation(t)}clip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=gT}eoClip(t){var e;(e=this.dependencyTracker)==null||e.recordFutureForcedDependency("clipMode",t),this.pendingClip=tx}beginText(t){var e;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(e=this.dependencyTracker)==null||e.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;e!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(e!==void 0){const r=new Path2D,a=n.getTransform().invertSelf();for(const{transform:l,x:u,y:h,fontSize:f,path:p}of e)p&&r.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(u,h).scale(f,-f));n.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,n){var y,v;(y=this.dependencyTracker)==null||y.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const r=this.commonObjs.get(e),a=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=r.fontMatrix||aw,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&Bt("Invalid font matrix for font "+e),n<0?(n=-n,a.fontDirection=-1):a.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;const l=r.loadedName||"sans-serif",u=((v=r.systemFontInfo)==null?void 0:v.css)||`"${l}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let p=n;n<X1?p=X1:n>q1&&(p=q1),this.current.fontSizeScale=n/p,this.ctx.font=`${f} ${h} ${p}px ${u}`}setTextRenderingMode(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,n){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=n}setLeadingMoveText(t,e,n){this.setLeading(t,-n),this.moveText(t,e,n)}setTextMatrix(t,e){var r;(r=this.dependencyTracker)==null||r.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:n}=this;n.textMatrix=e,n.textMatrixScale=Math.hypot(e[0],e[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(t){var e;this.moveText(t,0,this.current.leading),(e=this.dependencyTracker)==null||e.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}paintChar(t,e,n,r,a,l){var T,L,P,M;const u=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,y=h.fontSize/h.fontSizeScale,v=p&pn.FILL_STROKE_MASK,S=!!(p&pn.ADD_TO_PATH_FLAG),C=h.patternFill&&!f.missingFile,E=h.patternStroke&&!f.missingFile;let k;if((f.disableFontFace||S||C||E)&&!f.missingFile&&(k=f.getPathGenerator(this.commonObjs,e)),k&&(f.disableFontFace||C||E)){u.save(),u.translate(n,r),u.scale(y,-y),(T=this.dependencyTracker)==null||T.recordCharacterBBox(t,u,f);let D;if(v===pn.FILL||v===pn.FILL_STROKE)if(a){D=u.getTransform(),u.setTransform(...a);const I=x(this,er,jw).call(this,k,D,a);u.fill(I)}else u.fill(k);if(v===pn.STROKE||v===pn.FILL_STROKE)if(l){D||(D=u.getTransform()),u.setTransform(...l);const{a:I,b:U,c:$,d:G}=D,nt=at.inverseTransform(l),et=at.transform([I,U,$,G,0,0],nt);at.singularValueDecompose2dScale(et,ri),u.lineWidth*=Math.max(ri[0],ri[1])/y,u.stroke(x(this,er,jw).call(this,k,D,l))}else u.lineWidth/=y,u.stroke(k);u.restore()}else(v===pn.FILL||v===pn.FILL_STROKE)&&(u.fillText(e,n,r),(L=this.dependencyTracker)==null||L.recordCharacterBBox(t,u,f,y,n,r,()=>u.measureText(e))),(v===pn.STROKE||v===pn.FILL_STROKE)&&(this.dependencyTracker&&((P=this.dependencyTracker)==null||P.recordCharacterBBox(t,u,f,y,n,r,()=>u.measureText(e)).recordDependencies(t,gi.stroke)),u.strokeText(e,n,r));S&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:He(u),x:n,y:r,fontSize:y,path:k}),(M=this.dependencyTracker)==null||M.recordCharacterBBox(t,u,f,y,n,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let n=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){n=!0;break}return Ut(this,"isFontSubpixelAAEnabled",n)}showText(t,e){var et,Ct,_t,wt;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,gi.showText).resetBBox(t),this.current.textRenderingMode&pn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(t,e),(et=this.dependencyTracker)==null||et.recordShowTextOperation(t);return}const a=n.fontSize;if(a===0){(Ct=this.dependencyTracker)==null||Ct.recordOperation(t);return}const l=this.ctx,u=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,p=n.fontDirection,y=n.textHScale*p,v=e.length,S=r.vertical,C=S?1:-1,E=r.defaultVMetrics,k=a*n.fontMatrix[0],T=n.textRenderingMode===pn.FILL&&!r.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(y,-1):l.scale(y,1);let L,P;const M=n.textRenderingMode&pn.FILL_STROKE_MASK,D=M===pn.FILL||M===pn.FILL_STROKE,I=M===pn.STROKE||M===pn.FILL_STROKE;if(D&&n.patternFill){l.save();const kt=n.fillColor.getPattern(l,this,ar(l),zn.FILL,t);L=He(l),l.restore(),l.fillStyle=kt}if(I&&n.patternStroke){l.save();const kt=n.strokeColor.getPattern(l,this,ar(l),zn.STROKE,t);P=He(l),l.restore(),l.strokeStyle=kt}let U=n.lineWidth;const $=n.textMatrixScale;if($===0||U===0?I&&(U=this.getSinglePixelWidth()):U/=$,u!==1&&(l.scale(u,u),U/=u),l.lineWidth=U,r.isInvalidPDFjsFont){const kt=[];let ot=0;for(const V of e)kt.push(V.unicode),ot+=V.width;const st=kt.join("");if(l.fillText(st,0,0),this.dependencyTracker!==null){const V=l.measureText(st);this.dependencyTracker.recordBBox(t,this.ctx,-V.actualBoundingBoxLeft,V.actualBoundingBoxRight,-V.actualBoundingBoxAscent,V.actualBoundingBoxDescent).recordShowTextOperation(t)}n.x+=ot*k*y,l.restore(),this.compose();return}let G=0,nt;for(nt=0;nt<v;++nt){const kt=e[nt];if(typeof kt=="number"){G+=C*kt*a/1e3;continue}let ot=!1;const st=(kt.isSpace?f:0)+h,V=kt.fontChar,dt=kt.accent;let Z,O,H=kt.width;if(S){const bt=kt.vmetric||E,Mt=-(kt.vmetric?bt[1]:H*.5)*k,Pt=bt[2]*k;H=bt?-bt[0]:H,Z=Mt/u,O=(G+Pt)/u}else Z=G/u,O=0;let lt;if(r.remeasure&&H>0){lt=l.measureText(V);const bt=lt.width*1e3/a*u;if(H<bt&&this.isFontSubpixelAAEnabled){const Mt=H/bt;ot=!0,l.save(),l.scale(Mt,1),Z/=Mt}else H!==bt&&(Z+=(H-bt)/2e3*a/u)}if(this.contentVisible&&(kt.isInFont||r.missingFile)){if(T&&!dt)l.fillText(V,Z,O),(_t=this.dependencyTracker)==null||_t.recordCharacterBBox(t,l,lt?{bbox:null}:r,a/u,Z,O,()=>lt??l.measureText(V));else if(this.paintChar(t,V,Z,O,L,P),dt){const bt=Z+a*dt.offset.x/u,Mt=O-a*dt.offset.y/u;this.paintChar(t,dt.fontChar,bt,Mt,L,P)}}const Tt=S?H*k-st*p:H*k+st*p;G+=Tt,ot&&l.restore()}S?n.y-=G:n.x+=G*y,l.restore(),this.compose(),(wt=this.dependencyTracker)==null||wt.recordShowTextOperation(t)}showType3Text(t,e){const n=this.ctx,r=this.current,a=r.font,l=r.fontSize,u=r.fontDirection,h=a.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,y=r.textHScale*u,v=r.fontMatrix||aw,S=e.length,C=r.textRenderingMode===pn.INVISIBLE;let E,k,T,L;if(C||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(y,u);const P=this.dependencyTracker;for(this.dependencyTracker=P?new Py(P,t):null,E=0;E<S;++E){if(k=e[E],typeof k=="number"){L=h*k*l/1e3,this.ctx.translate(L,0),r.x+=L*y;continue}const M=(k.isSpace?p:0)+f,D=a.charProcOperatorList[k.operatorListId];D?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...v),this.executeOperatorList(D),this.restore()):Bt(`Type3 character "${k.operatorListId}" is not available.`);const I=[k.width,0];at.applyTransform(I,v),T=I[0]*l+M,n.translate(T,0),r.x+=T*y}n.restore(),P&&(this.dependencyTracker=P)}setCharWidth(t,e,n){}setCharWidthAndBounds(t,e,n,r,a,l,u){var f;const h=new Path2D;h.rect(r,a,l-r,u-a),this.ctx.clip(h),(f=this.dependencyTracker)==null||f.recordBBox(t,this.ctx,r,l,a,u).recordClipBox(t,this.ctx,r,l,a,u),this.endPath(t)}getColorN_Pattern(t,e){let n;if(e[0]==="TilingPattern"){const r=this.baseTransform||He(this.ctx),a={createCanvasGraphics:(l,u)=>new KA(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Py(this.dependencyTracker,u,!0):null)};n=new Bw(e,this.ctx,a,r)}else n=this._getPattern(t,e[1],e[2]);return n}setStrokeColorN(t,...e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){var n;(n=this.dependencyTracker)==null||n.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){var e;(e=this.dependencyTracker)==null||e.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,n=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=lT(this.getObject(t,e)),this.cachedPatterns.set(e,r)),n&&(r.matrix=n),r}shadingFill(t,e){var l;if(!this.contentVisible)return;const n=this.ctx;this.save(t);const r=this._getPattern(t,e);n.fillStyle=r.getPattern(n,this,ar(n),zn.SHADING,t);const a=ar(n);if(a){const{width:u,height:h}=n.canvas,f=ku.slice();at.axialAlignedBoundingBox([0,0,u,h],a,f);const[p,y,v,S]=f;this.ctx.fillRect(p,y,v-p,S-y)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(l=this.dependencyTracker)==null||l.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,gi.transform).recordDependencies(t,gi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Ee("Should not call beginInlineImage")}beginImageData(){Ee("Should not call beginImageData")}paintFormXObjectBegin(t,e,n){var r;if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=He(this.ctx),n)){at.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[a,l,u,h]=n,f=new Path2D;f.rect(a,l,u-a,h-l),this.ctx.clip(f),(r=this.dependencyTracker)==null||r.recordClipBox(t,this.ctx,a,u,l,h),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){var P;if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;e.isolated||i0("TODO: Support non-isolated groups."),e.knockout&&Bt("Knockout groups not supported.");const r=He(n);if(e.matrix&&n.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=ku.slice();at.axialAlignedBoundingBox(e.bbox,He(n),a);const l=[0,0,n.canvas.width,n.canvas.height];a=at.intersect(a,l)||[0,0,0,0];const u=Math.floor(a[0]),h=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-u,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(y,f,p),S=v.context;S.translate(-u,-h),S.transform(...r);let C=new Path2D;const[E,k,T,L]=e.bbox;if(C.rect(E,k,T-E,L-k),e.matrix){const M=new Path2D;M.addPath(C,new DOMMatrix(e.matrix)),C=M}S.clip(C),e.smask&&this.smaskStack.push({canvas:v.canvas,context:S,offsetX:u,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(u,h),n.save()),Qd(n,S),this.ctx=S,(P=this.dependencyTracker)==null||P.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(t,e){var a;if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,(a=this.dependencyTracker)==null||a.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=He(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const u=ku.slice();at.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],l,u),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(u)}}beginAnnotation(t,e,n,r,a,l){if(x(this,er,Uw).call(this),zm(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const u=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=u,n[3]=h,at.singularValueDecompose2dScale(He(this.ctx),ri);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:v,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(ri[0],0,0,-ri[1],0,h*ri[1]),zm(this.ctx)}else{zm(this.ctx),this.endPath(t);const f=new Path2D;f.rect(n[0],n[1],u,h),this.ctx.clip(f)}}this.current=new K1(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),x(this,er,zw).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){var u;if(!this.contentVisible)return;const n=e.count;e=this.getObject(t,e.data,e),e.count=n;const r=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,a.offsetX,a.offsetY),(u=this.dependencyTracker)==null||u.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,n,r=0,a=0,l,u){var y,v,S;if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const f=He(h);h.transform(n,r,a,l,0,0);const p=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),(y=this.dependencyTracker)==null||y.resetBBox(t);for(let C=0,E=u.length;C<E;C+=2){const k=at.transform(f,[n,r,a,l,u[C],u[C+1]]);h.drawImage(p.canvas,k[4],k[5]),(v=this.dependencyTracker)==null||v.recordBBox(t,this.ctx,k[4],k[4]+p.canvas.width,k[5],k[5]+p.canvas.height)}h.restore(),this.compose(),(S=this.dependencyTracker)==null||S.recordOperation(t)}paintImageMaskXObjectGroup(t,e){var l,u,h;if(!this.contentVisible)return;const n=this.ctx,r=this.current.fillColor,a=this.current.patternFill;(l=this.dependencyTracker)==null||l.resetBBox(t).recordDependencies(t,gi.transformAndFill);for(const f of e){const{data:p,width:y,height:v,transform:S}=f,C=this.cachedCanvases.getCanvas("maskCanvas",y,v),E=C.context;E.save();const k=this.getObject(t,p,f);Z1(E,k),E.globalCompositeOperation="source-in",E.fillStyle=a?r.getPattern(E,this,ar(n),zn.FILL,t):r,E.fillRect(0,0,y,v),E.restore(),n.save(),n.transform(...S),n.scale(1,-1),Um(n,C.canvas,0,0,y,v,0,-1,1,1),(u=this.dependencyTracker)==null||u.recordBBox(t,n,0,y,0,v),n.restore()}this.compose(),(h=this.dependencyTracker)==null||h.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const n=this.getObject(t,e);if(!n){Bt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,n)}paintImageXObjectRepeat(t,e,n,r,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){Bt("Dependent image isn't ready yet");return}const u=l.width,h=l.height,f=[];for(let p=0,y=a.length;p<y;p+=2)f.push({transform:[n,0,0,r,a[p],a[p+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:n,height:r}=t,a=this.cachedCanvases.getCanvas("inlineImage",n,r),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){var f;if(!this.contentVisible)return;const n=e.width,r=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/n,-1/r);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const y=this.cachedCanvases.getCanvas("inlineImage",n,r).context;Q1(y,e),u=this.applyTransferMapsToCanvas(y)}const h=this._scaleImage(u,ar(a));a.imageSmoothingEnabled=J1(He(a),e.interpolate),(f=this.dependencyTracker)==null||f.resetBBox(t).recordBBox(t,a,0,n,-r,0).recordDependencies(t,gi.imageXObject).recordOperation(t),Um(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,n,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,n){var l,u,h;if(!this.contentVisible)return;const r=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const f=e.width,p=e.height,v=this.cachedCanvases.getCanvas("inlineImage",f,p).context;Q1(v,e),a=this.applyTransferMapsToCanvas(v)}(l=this.dependencyTracker)==null||l.resetBBox(t);for(const f of n)r.save(),r.transform(...f.transform),r.scale(1,-1),Um(r,a,f.x,f.y,f.w,f.h,0,-1,1,1),(u=this.dependencyTracker)==null||u.recordBBox(t,r,0,1,-1,0),r.restore();(h=this.dependencyTracker)==null||h.recordOperation(t),this.compose()}paintSolidColorImageMask(t){var e;this.contentVisible&&((e=this.dependencyTracker)==null||e.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,gi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,n){}beginMarkedContent(t,e){var n;(n=this.dependencyTracker)==null||n.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,n){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){var e;(e=this.dependencyTracker)==null||e.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,n){var l,u;const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const a=this.ctx;this.pendingClip?(r||(this.pendingClip===tx?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,(l=this.dependencyTracker)==null||l.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):(u=this.dependencyTracker)==null||u.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=He(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),n=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:n,c:r,d:a}=this.ctx.getTransform();let l,u;if(n===0&&r===0){const h=Math.abs(e),f=Math.abs(a);if(h===f)if(t===0)l=u=1/h;else{const p=h*t;l=u=p<1?1/p:1}else if(t===0)l=1/h,u=1/f;else{const p=h*t,y=f*t;l=p<1?1/p:1,u=y<1?1/y:1}}else{const h=Math.abs(e*a-n*r),f=Math.hypot(e,n),p=Math.hypot(r,a);if(t===0)l=p/h,u=f/h;else{const y=t*h;l=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:n,current:{lineWidth:r}}=this,[a,l]=this.getScaleForStroking();if(a===l){n.lineWidth=(r||1)*a,n.stroke(t);return}const u=n.getLineDash();e&&n.save(),n.scale(a,l),nw.a=1/a,nw.d=1/l;const h=new Path2D;if(h.addPath(t,nw),u.length>0){const f=Math.max(a,l);n.setLineDash(u.map(p=>p/f)),n.lineDashOffset/=f}n.lineWidth=r||1,n.stroke(h),e&&n.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}};er=new WeakSet,Uw=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},zw=function(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}},jw=function(t,e,n){const r=new Path2D;return r.addPath(t,new DOMMatrix(n).invertSelf().multiplySelf(e)),r};let Mu=KA;for(const g in Ef)Mu.prototype[g]!==void 0&&(Mu.prototype[Ef[g]]=Mu.prototype[g]);var gp,mp;class Mr{static get workerPort(){return o(this,gp)}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");w(this,gp,t)}static get workerSrc(){return o(this,mp)}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");w(this,mp,t)}}gp=new WeakMap,mp=new WeakMap,b(Mr,gp,null),b(Mr,mp,"");var gh,yp;class mT{constructor({parsedData:t,rawData:e}){b(this,gh);b(this,yp);w(this,gh,t),w(this,yp,e)}getRaw(){return o(this,yp)}get(t){return o(this,gh).get(t)??null}[Symbol.iterator](){return o(this,gh).entries()}}gh=new WeakMap,yp=new WeakMap;const xu=Symbol("INTERNAL");var vp,wp,Ap,mh;class yT{constructor(t,{name:e,intent:n,usage:r,rbGroups:a}){b(this,vp,!1);b(this,wp,!1);b(this,Ap,!1);b(this,mh,!0);w(this,vp,!!(t&ii.DISPLAY)),w(this,wp,!!(t&ii.PRINT)),this.name=e,this.intent=n,this.usage=r,this.rbGroups=a}get visible(){if(o(this,Ap))return o(this,mh);if(!o(this,mh))return!1;const{print:t,view:e}=this.usage;return o(this,vp)?(e==null?void 0:e.viewState)!=="OFF":o(this,wp)?(t==null?void 0:t.printState)!=="OFF":!0}_setVisible(t,e,n=!1){t!==xu&&Ee("Internal method `_setVisible` called."),w(this,Ap,n),w(this,mh,e)}}vp=new WeakMap,wp=new WeakMap,Ap=new WeakMap,mh=new WeakMap;var La,we,yh,vh,Sp,Hw;class vT{constructor(t,e=ii.DISPLAY){b(this,Sp);b(this,La,null);b(this,we,new Map);b(this,yh,null);b(this,vh,null);if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,w(this,vh,t.order);for(const n of t.groups)o(this,we).set(n.id,new yT(e,n));if(t.baseState==="OFF")for(const n of o(this,we).values())n._setVisible(xu,!1);for(const n of t.on)o(this,we).get(n)._setVisible(xu,!0);for(const n of t.off)o(this,we).get(n)._setVisible(xu,!1);w(this,yh,this.getHash())}}isVisible(t){if(o(this,we).size===0)return!0;if(!t)return i0("Optional content group not defined."),!0;if(t.type==="OCG")return o(this,we).has(t.id)?o(this,we).get(t.id).visible:(Bt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return x(this,Sp,Hw).call(this,t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!o(this,we).has(e))return Bt(`Optional content group not found: ${e}`),!0;if(o(this,we).get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!o(this,we).has(e))return Bt(`Optional content group not found: ${e}`),!0;if(!o(this,we).get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!o(this,we).has(e))return Bt(`Optional content group not found: ${e}`),!0;if(!o(this,we).get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!o(this,we).has(e))return Bt(`Optional content group not found: ${e}`),!0;if(o(this,we).get(e).visible)return!1}return!0}return Bt(`Unknown optional content policy ${t.policy}.`),!0}return Bt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,n=!0){var a;const r=o(this,we).get(t);if(!r){Bt(`Optional content group not found: ${t}`);return}if(n&&e&&r.rbGroups.length)for(const l of r.rbGroups)for(const u of l)u!==t&&((a=o(this,we).get(u))==null||a._setVisible(xu,!1,!0));r._setVisible(xu,!!e,!0),w(this,La,null)}setOCGState({state:t,preserveRB:e}){let n;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":n=r;continue}const a=o(this,we).get(r);if(a)switch(n){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!a.visible,e);break}}w(this,La,null)}get hasInitialVisibility(){return o(this,yh)===null||this.getHash()===o(this,yh)}getOrder(){return o(this,we).size?o(this,vh)?o(this,vh).slice():[...o(this,we).keys()]:null}getGroup(t){return o(this,we).get(t)||null}getHash(){if(o(this,La)!==null)return o(this,La);const t=new qx;for(const[e,n]of o(this,we))t.update(`${e}:${n.visible}`);return w(this,La,t.hexdigest())}[Symbol.iterator](){return o(this,we).entries()}}La=new WeakMap,we=new WeakMap,yh=new WeakMap,vh=new WeakMap,Sp=new WeakSet,Hw=function(t){const e=t.length;if(e<2)return!0;const n=t[0];for(let r=1;r<e;r++){const a=t[r];let l;if(Array.isArray(a))l=x(this,Sp,Hw).call(this,a);else if(o(this,we).has(a))l=o(this,we).get(a).visible;else return Bt(`Optional content group not found: ${a}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"};class wT{constructor(t,{disableRange:e=!1,disableStream:n=!1}){Zt(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:a,progressiveDone:l,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=u,(a==null?void 0:a.length)>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!n,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const n=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const r=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(n),!0)});Zt(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}_onProgress(t){var e,n,r,a;t.total===void 0?(n=(e=this._rangeReaders[0])==null?void 0:e.onProgress)==null||n.call(e,{loaded:t.loaded}):(a=(r=this._fullRequestReader)==null?void 0:r.onProgress)==null||a.call(r,{loaded:t.loaded,total:t.total})}_onProgressiveDone(){var t;(t=this._fullRequestReader)==null||t.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Zt(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new AT(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new ST(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeReaders.slice(0))n.cancel(t);this._pdfDataRangeTransport.abort()}}class AT{constructor(t,e,n=!1,r=null){this._stream=t,this._done=n||!1,this._filename=UA(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ST{constructor(t,e,n){this._stream=t,this._begin=e,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function bT(g){let t=!0,e=n("filename\\*","i").exec(g);if(e){e=e[1];let p=u(e);return p=unescape(p),p=h(p),p=f(p),a(p)}if(e=l(g),e){const p=f(e);return a(p)}if(e=n("filename","i").exec(g),e){e=e[1];let p=u(e);return p=f(p),a(p)}function n(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const v=new TextDecoder(p,{fatal:!0}),S=vg(y);y=v.decode(S),t=!1}catch{}}return y}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function l(p){const y=[];let v;const S=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=S.exec(p))!==null;){let[,E,k,T]=v;if(E=parseInt(E,10),E in y){if(E===0)break;continue}y[E]=[k,T]}const C=[];for(let E=0;E<y.length&&E in y;++E){let[k,T]=y[E];T=u(T),k&&(T=unescape(T),E===0&&(T=h(T))),C.push(T)}return C.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let v=0;v<y.length;++v){const S=y[v].indexOf('"');S!==-1&&(y[v]=y[v].slice(0,S),y.length=v+1),y[v]=y[v].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function h(p){const y=p.indexOf("'");if(y===-1)return p;const v=p.slice(0,y),C=p.slice(y+1).replace(/^[^']*'/,"");return r(v,C)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,v,S,C){if(S==="q"||S==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,k){return String.fromCharCode(parseInt(k,16))}),r(v,C);try{C=atob(C)}catch{}return r(v,C)})}return""}function oE(g,t){const e=new Headers;if(!g||!t||typeof t!="object")return e;for(const n in t){const r=t[n];r!==void 0&&e.append(n,r)}return e}function o0(g){var t;return((t=URL.parse(g))==null?void 0:t.origin)??null}function aE({responseHeaders:g,isHttp:t,rangeChunkSize:e,disableRange:n}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(g.get("Content-Length"),10);return!Number.isInteger(a)||(r.suggestedLength=a,a<=2*e)||n||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function lE(g){const t=g.get("Content-Disposition");if(t){let e=bT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(UA(e))return e}return null}function xg(g,t){return new xy(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function cE(g){return g===200||g===206}function uE(g,t,e){return{method:"GET",headers:g,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function hE(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(Bt(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class xT{constructor(t){K(this,"_responseOrigin",null);this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=oE(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Zt(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new ET(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new CT(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class ET{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const n=new Headers(t.headers),r=e.url;fetch(r,uE(n,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=o0(a.url),!cE(a.status))throw xg(a.status,r);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:u,suggestedLength:h}=aE({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=lE(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new el("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:hE(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}class CT{constructor(t,e,n){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${n-1}`);const l=r.url;fetch(l,uE(a,this._withCredentials,this._abortController)).then(u=>{const h=o0(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!cE(u.status))throw xg(u.status,l);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:hE(t),done:!1})}cancel(t){var e;(e=this._reader)==null||e.cancel(t),this._abortController.abort()}}const sw=200,iw=206;function _T(g){const t=g.response;return typeof t!="string"?t:vg(t).buffer}class kT{constructor({url:t,httpHeaders:e,withCredentials:n}){K(this,"_responseOrigin",null);this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=oE(this.isHttp,e),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=iw):r.expectedStatus=sw,e.responseType="arraybuffer",Zt(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,n),e.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),n}onProgress(t,e){var r;const n=this.pendingRequests[t];n&&((r=n.onProgress)==null||r.call(n,e))}onStateChange(t,e){const n=this.pendingRequests[t];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){n.onError(r.status);return}const a=r.status||sw;if(!(a===sw&&n.expectedStatus===iw)&&a!==n.expectedStatus){n.onError(r.status);return}const u=_T(r);if(a===iw){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:u}):(Bt('Missing or invalid "Content-Range" header.'),n.onError(0))}else u?n.onDone({begin:0,chunk:u}):n.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class TT{constructor(t){this._source=t,this._manager=new kT(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Zt(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PT(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const n=new RT(this._manager,t,e);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class PT{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=o0(e.responseURL);const n=e.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...f]=u.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=aE({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=lE(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=xg(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){var e;(e=this.onProgress)==null||e.call(this,{loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class RT{constructor(t,e,n){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var e;const t=o0((e=this._manager.getRequestXhr(this._requestId))==null?void 0:e.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var t;(t=this.onClosed)==null||t.call(this,this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??(this._storedError=xg(t,this._url));for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){var e;this.isStreamingSupported||(e=this.onProgress)==null||e.call(this,{loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const LT=/^[a-z][a-z0-9\-+.]+:/i;function MT(g){if(LT.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class DT{constructor(t){this.source=t,this.url=MT(t.url),Zt(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var t;return((t=this._fullRequestReader)==null?void 0:t._loaded)??0}getFullReader(){return Zt(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new NT(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const n=new IT(this,t,e);return this._rangeRequestReaders.push(n),n}cancelAllRequests(t){var e;(e=this._fullRequestReader)==null||e.cancel(t);for(const n of this._rangeRequestReaders.slice(0))n.cancel(t)}}class NT{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=xg(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new el("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class IT{constructor(t,e,n){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var n;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,(n=this.onProgress)==null||n.call(this,{loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Zd=Symbol("INITIAL_DATA");var $s,bp,$w;class dE{constructor(){b(this,bp);b(this,$s,Object.create(null))}get(t,e=null){if(e){const r=x(this,bp,$w).call(this,t);return r.promise.then(()=>e(r.data)),null}const n=o(this,$s)[t];if(!n||n.data===Zd)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){const e=o(this,$s)[t];return!!e&&e.data!==Zd}delete(t){const e=o(this,$s)[t];return!e||e.data===Zd?!1:(delete o(this,$s)[t],!0)}resolve(t,e=null){const n=x(this,bp,$w).call(this,t);n.data=e,n.resolve()}clear(){var t;for(const e in o(this,$s)){const{data:n}=o(this,$s)[e];(t=n==null?void 0:n.bitmap)==null||t.close()}w(this,$s,Object.create(null))}*[Symbol.iterator](){for(const t in o(this,$s)){const{data:e}=o(this,$s)[t];e!==Zd&&(yield[t,e])}}}$s=new WeakMap,bp=new WeakSet,$w=function(t){var e;return(e=o(this,$s))[t]||(e[t]={...Promise.withResolvers(),data:Zd})};const FT=1e5,ex=30;var ax,Ma,Ws,xp,Ep,sc,go,Cp,_p,ic,kp,wh,Da,Ah,Tp,Sh,rc,Pp,Rp,bh,oc,Lp,xh,Eh,Oo,fE,pE,Ww,ai,ty,Vw,gE,mE;const Nn=class Nn{constructor({textContentSource:t,container:e,viewport:n}){b(this,Oo);b(this,Ma,Promise.withResolvers());b(this,Ws,null);b(this,xp,!1);b(this,Ep,!!((ax=globalThis.FontInspector)!=null&&ax.enabled));b(this,sc,null);b(this,go,null);b(this,Cp,0);b(this,_p,0);b(this,ic,null);b(this,kp,null);b(this,wh,0);b(this,Da,0);b(this,Ah,Object.create(null));b(this,Tp,[]);b(this,Sh,null);b(this,rc,[]);b(this,Pp,new WeakMap);b(this,Rp,null);var h;if(t instanceof ReadableStream)w(this,Sh,t);else if(typeof t=="object")w(this,Sh,new ReadableStream({start(f){f.enqueue(t),f.close()}}));else throw new Error('No "textContentSource" parameter specified.');w(this,Ws,w(this,kp,e)),w(this,Da,n.scale*Dr.pixelRatio),w(this,wh,n.rotation),w(this,go,{div:null,properties:null,ctx:null});const{pageWidth:r,pageHeight:a,pageX:l,pageY:u}=n.rawDims;w(this,Rp,[1,0,0,-1,-l,u+a]),w(this,_p,r),w(this,Cp,a),x(h=Nn,ai,gE).call(h),e.style.setProperty("--min-font-size",o(Nn,xh)),jc(e,n),o(this,Ma).promise.finally(()=>{o(Nn,Eh).delete(this),w(this,go,null),w(this,Ah,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=wn.platform;return Ut(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{o(this,ic).read().then(({value:e,done:n})=>{if(n){o(this,Ma).resolve();return}o(this,sc)??w(this,sc,e.lang),Object.assign(o(this,Ah),e.styles),x(this,Oo,fE).call(this,e.items),t()},o(this,Ma).reject)};return w(this,ic,o(this,Sh).getReader()),o(Nn,Eh).add(this),t(),o(this,Ma).promise}update({viewport:t,onBefore:e=null}){var a;const n=t.scale*Dr.pixelRatio,r=t.rotation;if(r!==o(this,wh)&&(e==null||e(),w(this,wh,r),jc(o(this,kp),{rotation:r})),n!==o(this,Da)){e==null||e(),w(this,Da,n);const l={div:null,properties:null,ctx:x(a=Nn,ai,ty).call(a,o(this,sc))};for(const u of o(this,rc))l.properties=o(this,Pp).get(u),l.div=u,x(this,Oo,Ww).call(this,l)}}cancel(){var e;const t=new el("TextLayer task cancelled.");(e=o(this,ic))==null||e.cancel(t).catch(()=>{}),w(this,ic,null),o(this,Ma).reject(t)}get textDivs(){return o(this,rc)}get textContentItemsStr(){return o(this,Tp)}static cleanup(){if(!(o(this,Eh).size>0)){o(this,bh).clear();for(const{canvas:t}of o(this,oc).values())t.remove();o(this,oc).clear()}}};Ma=new WeakMap,Ws=new WeakMap,xp=new WeakMap,Ep=new WeakMap,sc=new WeakMap,go=new WeakMap,Cp=new WeakMap,_p=new WeakMap,ic=new WeakMap,kp=new WeakMap,wh=new WeakMap,Da=new WeakMap,Ah=new WeakMap,Tp=new WeakMap,Sh=new WeakMap,rc=new WeakMap,Pp=new WeakMap,Rp=new WeakMap,bh=new WeakMap,oc=new WeakMap,Lp=new WeakMap,xh=new WeakMap,Eh=new WeakMap,Oo=new WeakSet,fE=function(t){var r,a;if(o(this,xp))return;(a=o(this,go)).ctx??(a.ctx=x(r=Nn,ai,ty).call(r,o(this,sc)));const e=o(this,rc),n=o(this,Tp);for(const l of t){if(e.length>FT){Bt("Ignoring additional textDivs for performance reasons."),w(this,xp,!0);return}if(l.str===void 0){if(l.type==="beginMarkedContentProps"||l.type==="beginMarkedContent"){const u=o(this,Ws);w(this,Ws,document.createElement("span")),o(this,Ws).classList.add("markedContent"),l.id&&o(this,Ws).setAttribute("id",`${l.id}`),u.append(o(this,Ws))}else l.type==="endMarkedContent"&&w(this,Ws,o(this,Ws).parentNode);continue}n.push(l.str),x(this,Oo,pE).call(this,l)}},pE=function(t){var C;const e=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};o(this,rc).push(e);const r=at.transform(o(this,Rp),t.transform);let a=Math.atan2(r[1],r[0]);const l=o(this,Ah)[t.fontName];l.vertical&&(a+=Math.PI/2);let u=o(this,Ep)&&l.fontSubstitution||l.fontFamily;u=Nn.fontFamilyMap.get(u)||u;const h=Math.hypot(r[2],r[3]),f=h*x(C=Nn,ai,mE).call(C,u,l,o(this,sc));let p,y;a===0?(p=r[4],y=r[5]-f):(p=r[4]+f*Math.sin(a),y=r[5]-f*Math.cos(a));const v=e.style;v.left=`${(100*p/o(this,_p)).toFixed(2)}%`,v.top=`${(100*y/o(this,Cp)).toFixed(2)}%`,v.setProperty("--font-height",`${h.toFixed(2)}px`),v.fontFamily=u,n.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,o(this,Ep)&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(n.angle=a*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const E=Math.abs(t.transform[0]),k=Math.abs(t.transform[3]);E!==k&&Math.max(E,k)/Math.min(E,k)>1.5&&(S=!0)}if(S&&(n.canvasWidth=l.vertical?t.height:t.width),o(this,Pp).set(e,n),o(this,go).div=e,o(this,go).properties=n,x(this,Oo,Ww).call(this,o(this,go)),n.hasText&&o(this,Ws).append(e),n.hasEOL){const E=document.createElement("br");E.setAttribute("role","presentation"),o(this,Ws).append(E)}},Ww=function(t){var l;const{div:e,properties:n,ctx:r}=t,{style:a}=e;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:u}=a,{canvasWidth:h,fontSize:f}=n;x(l=Nn,ai,Vw).call(l,r,f*o(this,Da),u);const{width:p}=r.measureText(e.textContent);p>0&&a.setProperty("--scale-x",h*o(this,Da)/p)}n.angle!==0&&a.setProperty("--rotate",`${n.angle}deg`)},ai=new WeakSet,ty=function(t=null){let e=o(this,oc).get(t||(t=""));if(!e){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=t,document.body.append(n),e=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),o(this,oc).set(t,e),o(this,Lp).set(e,{size:0,family:""})}return e},Vw=function(t,e,n){const r=o(this,Lp).get(t);e===r.size&&n===r.family||(t.font=`${e}px ${n}`,r.size=e,r.family=n)},gE=function(){if(o(this,xh)!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),w(this,xh,t.getBoundingClientRect().height),t.remove()},mE=function(t,e,n){const r=o(this,bh).get(t);if(r)return r;const a=x(this,ai,ty).call(this,n);a.canvas.width=a.canvas.height=ex,x(this,ai,Vw).call(this,a,ex,t);const l=a.measureText(""),u=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return u?f=u/(u+h):(wn.platform.isFirefox&&Bt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),o(this,bh).set(t,f),f},b(Nn,ai),b(Nn,bh,new Map),b(Nn,oc,new Map),b(Nn,Lp,new WeakMap),b(Nn,xh,null),b(Nn,Eh,new Set);let _f=Nn;const OT=100;function yE(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new Gw,{docId:e}=t,n=g.url?Wk(g.url):null,r=g.data?Vk(g.data):null,a=g.httpHeaders||null,l=g.withCredentials===!0,u=g.password??null,h=g.range instanceof vE?g.range:null,f=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let p=g.worker instanceof kf?g.worker:null;const y=g.verbosity,v=typeof g.docBaseUrl=="string"&&!r0(g.docBaseUrl)?g.docBaseUrl:null,S=Im(g.cMapUrl),C=g.cMapPacked!==!1,E=g.CMapReaderFactory||(us?Jk:j1),k=Im(g.iccUrl),T=Im(g.standardFontDataUrl),L=g.StandardFontDataFactory||(us?tT:H1),P=Im(g.wasmUrl),M=g.WasmFactory||(us?eT:$1),D=g.stopAtErrors!==!0,I=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,U=g.isEvalSupported!==!1,$=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!us,G=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!us&&(wn.platform.isFirefox||!globalThis.chrome),nt=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,et=typeof g.disableFontFace=="boolean"?g.disableFontFace:us,Ct=g.fontExtraProperties===!0,_t=g.enableXfa===!0,wt=g.ownerDocument||globalThis.document,kt=g.disableRange===!0,ot=g.disableStream===!0,st=g.disableAutoFetch===!0,V=g.pdfBug===!0,dt=g.CanvasFactory||(us?Zk:Yk),Z=g.FilterFactory||(us?Qk:Kk),O=g.enableHWA===!0,H=g.useWasm!==!1,lt=h?h.length:g.length??NaN,Tt=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!us&&!et,bt=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(E===j1&&L===H1&&M===$1&&S&&T&&P&&ef(S,document.baseURI)&&ef(T,document.baseURI)&&ef(P,document.baseURI)),Mt=null;yk(y);const Pt={canvasFactory:new dt({ownerDocument:wt,enableHWA:O}),filterFactory:new Z({docId:e,ownerDocument:wt}),cMapReaderFactory:bt?null:new E({baseUrl:S,isCompressed:C}),standardFontDataFactory:bt?null:new L({baseUrl:T}),wasmFactory:bt?null:new M({baseUrl:P})};p||(p=kf.create({verbosity:y,port:Mr.workerPort}),t._worker=p);const Et={docId:e,apiVersion:"5.4.530",data:r,password:u,disableAutoFetch:st,rangeChunkSize:f,length:lt,docBaseUrl:v,enableXfa:_t,evaluatorOptions:{maxImageSize:I,disableFontFace:et,ignoreErrors:D,isEvalSupported:U,isOffscreenCanvasSupported:$,isImageDecoderSupported:G,canvasMaxAreaInBytes:nt,fontExtraProperties:Ct,useSystemFonts:Tt,useWasm:H,useWorkerFetch:bt,cMapUrl:S,iccUrl:k,standardFontDataUrl:T,wasmUrl:P}},ae={ownerDocument:wt,pdfBug:V,styleElement:Mt,loadingParams:{disableAutoFetch:st,enableXfa:_t}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const We=p.messageHandler.sendWithPromise("GetDocRequest",Et,r?[r.buffer]:null);let es;if(h)es=new wT(h,{disableRange:kt,disableStream:ot});else if(!r){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Li=ef(n)?xT:us?DT:TT;es=new Li({url:n,length:lt,httpHeaders:a,withCredentials:l,rangeChunkSize:f,disableRange:kt,disableStream:ot})}return We.then(Li=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ir=new uf(e,Li,p.port),Bo=new zT(Ir,t,es,ae,Pt,O);t._transport=Bo,Ir.send("Ready",null)})}).catch(t._capability.reject),t}var Gy;const Xy=class Xy{constructor(){K(this,"_capability",Promise.withResolvers());K(this,"_transport",null);K(this,"_worker",null);K(this,"docId",`d${fn(Xy,Gy)._++}`);K(this,"destroyed",!1);K(this,"onPassword",null);K(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var t,e,n,r;this.destroyed=!0;try{(t=this._worker)!=null&&t.port&&(this._worker._pendingDestroy=!0),await((e=this._transport)==null?void 0:e.destroy())}catch(a){throw(n=this._worker)!=null&&n.port&&delete this._worker._pendingDestroy,a}this._transport=null,(r=this._worker)==null||r.destroy(),this._worker=null}async getData(){return this._transport.getData()}};Gy=new WeakMap,b(Xy,Gy,0);let Gw=Xy;var ac,Mp,Dp,Np,Ip;class vE{constructor(t,e,n=!1,r=null){b(this,ac,Promise.withResolvers());b(this,Mp,[]);b(this,Dp,[]);b(this,Np,[]);b(this,Ip,[]);this.length=t,this.initialData=e,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(t){o(this,Ip).push(t)}addProgressListener(t){o(this,Np).push(t)}addProgressiveReadListener(t){o(this,Dp).push(t)}addProgressiveDoneListener(t){o(this,Mp).push(t)}onDataRange(t,e){for(const n of o(this,Ip))n(t,e)}onDataProgress(t,e){o(this,ac).promise.then(()=>{for(const n of o(this,Np))n(t,e)})}onDataProgressiveRead(t){o(this,ac).promise.then(()=>{for(const e of o(this,Dp))e(t)})}onDataProgressiveDone(){o(this,ac).promise.then(()=>{for(const t of o(this,Mp))t()})}transportReady(){o(this,ac).resolve()}requestDataRange(t,e){Ee("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}ac=new WeakMap,Mp=new WeakMap,Dp=new WeakMap,Np=new WeakMap,Ip=new WeakMap;class BT{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var mo,lc,gf;class UT{constructor(t,e,n,r=!1){b(this,lc);b(this,mo,!1);this._pageIndex=t,this._pageInfo=e,this._transport=n,this._stats=r?new N1:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new dE,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:a=!1}={}){return new Ag({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:n,offsetY:r,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ut(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var t;return((t=this._transport._htmlForXfa)==null?void 0:t.children[this._pageIndex])||null}render({canvasContext:t,canvas:e=t.canvas,viewport:n,intent:r="display",annotationMode:a=ua.ENABLE,transform:l=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:v=!1,recordOperations:S=!1,operationsFilter:C=null}){var G,nt,et;(G=this._stats)==null||G.time("Overall");const E=this._transport.getRenderingIntent(r,a,y,v),{renderingIntent:k,cacheKey:T}=E;w(this,mo,!1),h||(h=this._transport.getOptionalContentConfig(k));let L=this._intentStates.get(T);L||(L=Object.create(null),this._intentStates.set(T,L)),L.streamReaderCancelTimeout&&(clearTimeout(L.streamReaderCancelTimeout),L.streamReaderCancelTimeout=null);const P=!!(k&ii.PRINT);L.displayReadyCapability||(L.displayReadyCapability=Promise.withResolvers(),L.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(nt=this._stats)==null||nt.time("Page Request"),this._pumpOperatorList(E));const M=!!(this._pdfBug&&((et=globalThis.StepperManager)!=null&&et.enabled)),D=!this.recordedBBoxes&&(S||M),I=Ct=>{var _t,wt;if(L.renderTasks.delete(U),D){const kt=(_t=U.gfx)==null?void 0:_t.dependencyTracker.take();kt&&(U.stepper&&U.stepper.setOperatorBBoxes(kt,U.gfx.dependencyTracker.takeDebugMetadata()),S&&(this.recordedBBoxes=kt))}P&&w(this,mo,!0),x(this,lc,gf).call(this),Ct?(U.capability.reject(Ct),this._abortOperatorList({intentState:L,reason:Ct instanceof Error?Ct:new Error(Ct)})):U.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(wt=globalThis.Stats)!=null&&wt.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},U=new Xw({callback:I,params:{canvas:e,canvasContext:t,dependencyTracker:D?new sT(e,L.operatorList.length,M):null,viewport:n,transform:l,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:L.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!P,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:C});(L.renderTasks||(L.renderTasks=new Set)).add(U);const $=U.task;return Promise.all([L.displayReadyCapability.promise,h]).then(([Ct,_t])=>{var wt;if(this.destroyed){I();return}if((wt=this._stats)==null||wt.time("Rendering"),!(_t.renderingIntent&k))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");U.initializeGraphics({transparency:Ct,optionalContentConfig:_t}),U.operatorListChanged()}).catch(I),$}getOperatorList({intent:t="display",annotationMode:e=ua.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){var f;function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,n,r,!0);let u=this._intentStates.get(l.cacheKey);u||(u=Object.create(null),this._intentStates.set(l.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||(u.renderTasks=new Set)).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(f=this._stats)==null||f.time("Page Request"),this._pumpOperatorList(l)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Cf.textContent(n));const e=this.streamTextContent(t);return new Promise(function(n,r){function a(){l.read().then(function({value:h,done:f}){if(f){n(u);return}u.lang??(u.lang=h.lang),Object.assign(u.styles,h.styles),u.items.push(...h.items),a()},r)}const l=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const n of e.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),w(this,mo,!1),Promise.all(t)}cleanup(t=!1){w(this,mo,!0);const e=x(this,lc,gf).call(this);return t&&e&&this._stats&&(this._stats=new N1),e}_startRenderPage(t,e){var r,a;const n=this._intentStates.get(e);n&&((r=this._stats)==null||r.timeEnd("Page Request"),(a=n.displayReadyCapability)==null||a.resolve(t))}_renderPageChunk(t,e){for(let n=0,r=t.length;n<r;n++)e.operatorList.fnArray.push(t.fnArray[n]),e.operatorList.argsArray.push(t.argsArray[n]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const n of e.renderTasks)n.operatorListChanged();t.lastChunk&&x(this,lc,gf).call(this)}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:n,modifiedIds:r}){const{map:a,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:r},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const p=()=>{h.read().then(({value:y,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();x(this,lc,gf).call(this)}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(e instanceof BA){let r=OT;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new el(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,a]of this._intentStates)if(a===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}mo=new WeakMap,lc=new WeakSet,gf=function(){if(!o(this,mo)||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),w(this,mo,!1),!0};var Na,Xi,yo,cc,qy,uc,hc,ds,ey,wE,AE,mf,Ch,ny;const Fe=class Fe{constructor({name:t=null,port:e=null,verbosity:n=vk()}={}){b(this,ds);b(this,Na,Promise.withResolvers());b(this,Xi,null);b(this,yo,null);b(this,cc,null);if(this.name=t,this.destroyed=!1,this.verbosity=n,e){if(o(Fe,hc).has(e))throw new Error("Cannot use more than one PDFWorker per port.");o(Fe,hc).set(e,this),x(this,ds,wE).call(this,e)}else x(this,ds,AE).call(this)}get promise(){return o(this,Na).promise}get port(){return o(this,yo)}get messageHandler(){return o(this,Xi)}destroy(){var t,e;this.destroyed=!0,(t=o(this,cc))==null||t.terminate(),w(this,cc,null),o(Fe,hc).delete(o(this,yo)),w(this,yo,null),(e=o(this,Xi))==null||e.destroy(),w(this,Xi,null)}static create(t){const e=o(this,hc).get(t==null?void 0:t.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Fe(t)}static get workerSrc(){if(Mr.workerSrc)return Mr.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ut(this,"_setupFakeWorkerGlobal",(async()=>o(this,Ch,ny)?o(this,Ch,ny):(await import(this.workerSrc)).WorkerMessageHandler)())}};Na=new WeakMap,Xi=new WeakMap,yo=new WeakMap,cc=new WeakMap,qy=new WeakMap,uc=new WeakMap,hc=new WeakMap,ds=new WeakSet,ey=function(){o(this,Na).resolve(),o(this,Xi).send("configure",{verbosity:this.verbosity})},wE=function(t){w(this,yo,t),w(this,Xi,new uf("main","worker",t)),o(this,Xi).on("ready",()=>{}),x(this,ds,ey).call(this)},AE=function(){if(o(Fe,uc)||o(Fe,Ch,ny)){x(this,ds,mf).call(this);return}let{workerSrc:t}=Fe;try{Fe._isSameOrigin(window.location,t)||(t=Fe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),n=new uf("main","worker",e),r=()=>{a.abort(),n.destroy(),e.terminate(),this.destroyed?o(this,Na).reject(new Error("Worker was destroyed")):x(this,ds,mf).call(this)},a=new AbortController;e.addEventListener("error",()=>{o(this,cc)||r()},{signal:a.signal}),n.on("test",u=>{if(a.abort(),this.destroyed||!u){r();return}w(this,Xi,n),w(this,yo,e),w(this,cc,e),x(this,ds,ey).call(this)}),n.on("ready",u=>{if(a.abort(),this.destroyed){r();return}try{l()}catch{x(this,ds,mf).call(this)}});const l=()=>{const u=new Uint8Array;n.send("test",u,[u.buffer])};l();return}catch{i0("The worker has been disabled.")}x(this,ds,mf).call(this)},mf=function(){o(Fe,uc)||(Bt("Setting up fake worker."),w(Fe,uc,!0)),Fe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){o(this,Na).reject(new Error("Worker was destroyed"));return}const e=new qk;w(this,yo,e);const n=`fake${fn(Fe,qy)._++}`,r=new uf(n+"_worker",n,e);t.setup(r,e),w(this,Xi,new uf(n,n+"_worker",e)),x(this,ds,ey).call(this)}).catch(t=>{o(this,Na).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ch=new WeakSet,ny=function(){var t;try{return((t=globalThis.pdfjsWorker)==null?void 0:t.WorkerMessageHandler)||null}catch{return null}},b(Fe,Ch),b(Fe,qy,0),b(Fe,uc,!1),b(Fe,hc,new WeakMap),us&&(w(Fe,uc,!0),Mr.workerSrc||(Mr.workerSrc="./pdf.worker.mjs")),Fe._isSameOrigin=(t,e)=>{const n=URL.parse(t);if(!(n!=null&&n.origin)||n.origin==="null")return!1;const r=new URL(e,n);return n.origin===r.origin},Fe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Fe.fromPort=t=>{if(Rk("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(t!=null&&t.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return Fe.create(t)};let kf=Fe;var vo,br,_h,kh,wo,dc,yf;class zT{constructor(t,e,n,r,a,l){b(this,dc);b(this,vo,new Map);b(this,br,new Map);b(this,_h,new Map);b(this,kh,new Map);b(this,wo,null);this.messageHandler=t,this.loadingTask=e,this.commonObjs=new dE,this.fontLoader=new jk({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}get annotationStorage(){return Ut(this,"annotationStorage",new zA)}getRenderingIntent(t,e=ua.ENABLE,n=null,r=!1,a=!1){let l=ii.DISPLAY,u=Pw;switch(t){case"any":l=ii.ANY;break;case"display":break;case"print":l=ii.PRINT;break;default:Bt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&ii.PRINT&&n instanceof Kx?n:this.annotationStorage;switch(e){case ua.DISABLE:l+=ii.ANNOTATIONS_DISABLE;break;case ua.ENABLE:break;case ua.ENABLE_FORMS:l+=ii.ANNOTATIONS_FORMS;break;case ua.ENABLE_STORAGE:l+=ii.ANNOTATIONS_STORAGE,u=h.serializable;break;default:Bt(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(l+=ii.IS_EDITING),a&&(l+=ii.OPLIST);const{ids:f,hash:p}=h.modifiedIds,y=[l,u.hash,p];return{renderingIntent:l,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){var n;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(n=o(this,wo))==null||n.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const r of o(this,br).values())t.push(r._destroy());o(this,br).clear(),o(this,_h).clear(),o(this,kh).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{var r,a;this.commonObjs.clear(),this.fontLoader.clear(),o(this,vo).clear(),this.filterFactory.destroy(),_f.cleanup(),(r=this._networkStream)==null||r.cancelAllRequests(new el("Worker was terminated.")),(a=this.messageHandler)==null||a.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(n,r)=>{Zt(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},r.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){r.close();return}Zt(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{this._fullReader.cancel(a),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async n=>{var u;await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:a,contentLength:l}=this._fullReader;return(!r||!a)&&(this._lastProgress&&((u=e.onProgress)==null||u.call(e,this._lastProgress)),this._fullReader.onProgress=h=>{var f;(f=e.onProgress)==null||f.call(e,{loaded:h.loaded,total:h.total})}),{isStreamingSupported:r,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(n,r)=>{Zt(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(n.begin,n.end);if(!a){r.close();return}r.onPull=()=>{a.read().then(function({value:l,done:u}){if(u){r.close();return}Zt(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{a.cancel(l),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,e._capability.resolve(new BT(n,this))}),t.on("DocException",n=>{e._capability.reject(bs(n))}),t.on("PasswordRequest",n=>{w(this,wo,Promise.withResolvers());try{if(!e.onPassword)throw bs(n);const r=a=>{a instanceof Error?o(this,wo).reject(a):o(this,wo).resolve({password:a})};e.onPassword(r,n.code)}catch(r){o(this,wo).reject(r)}return o(this,wo).promise}),t.on("DataLoaded",n=>{var r;(r=e.onProgress)==null||r.call(e,{loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;o(this,br).get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,r,a])=>{var l;if(this.destroyed||this.commonObjs.has(n))return null;switch(r){case"Font":if("error"in a){const v=a.error;Bt(`Error during font loading: ${v}`),this.commonObjs.resolve(n,v);break}const u=new Rw(a),h=this._params.pdfBug&&((l=globalThis.FontInspector)!=null&&l.enabled)?(v,S)=>globalThis.FontInspector.fontAdded(v,S):null,f=new Hk(u,h,a.extra,a.charProcOperatorList);this.fontLoader.bind(f).catch(()=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!f.fontExtraProperties&&f.data&&f.clearData(),this.commonObjs.resolve(n,f)});break;case"CopyLocalImage":const{imageRef:p}=a;Zt(p,"The imageRef must be defined.");for(const v of o(this,br).values())for(const[,S]of v.objs)if((S==null?void 0:S.ref)===p)return S.dataLen?(this.commonObjs.resolve(n,structuredClone(S)),S.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new $k(a));break;case"Image":this.commonObjs.resolve(n,a);break;case"Pattern":const y=new Lw(a);this.commonObjs.resolve(n,y.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([n,r,a,l])=>{var h;if(this.destroyed)return;const u=o(this,br).get(r);if(!u.objs.has(n)){if(u._intentStates.size===0){(h=l==null?void 0:l.bitmap)==null||h.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",n=>{var r;this.destroyed||(r=e.onProgress)==null||r.call(e,{loaded:n.loaded,total:n.total})}),t.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[n.type];if(!r)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var n;this.annotationStorage.size<=0&&Bt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:((n=this._fullReader)==null?void 0:n.filename)??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,n=o(this,_h).get(e);if(n)return n;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&o(this,kh).set(a.refStr,t);const l=new UT(e,a,this,this._params.pdfBug);return o(this,br).set(e,l),l});return o(this,_h).set(e,r),r}getPageIndex(t){return Mw(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return x(this,dc,yf).call(this,"GetFieldObjects")}hasJSActions(){return x(this,dc,yf).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return x(this,dc,yf).call(this,"GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return x(this,dc,yf).call(this,"GetOptionalContentConfig").then(e=>new vT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=o(this,vo).get(t);if(e)return e;const n=this.messageHandler.sendWithPromise(t,null).then(r=>{var a,l;return{info:r[0],metadata:r[1]?new mT(r[1]):null,contentDispositionFilename:((a=this._fullReader)==null?void 0:a.filename)??null,contentLength:((l=this._fullReader)==null?void 0:l.contentLength)??null,hasStructTree:r[2]}});return o(this,vo).set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of o(this,br).values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),o(this,vo).clear(),this.filterFactory.destroy(!0),_f.cleanup()}}cachedPageNumber(t){if(!Mw(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return o(this,kh).get(e)??null}}vo=new WeakMap,br=new WeakMap,_h=new WeakMap,kh=new WeakMap,wo=new WeakMap,dc=new WeakSet,yf=function(t,e=null){const n=o(this,vo).get(t);if(n)return n;const r=this.messageHandler.sendWithPromise(t,e);return o(this,vo).set(t,r),r};var Ia;class jT{constructor(t){b(this,Ia,null);K(this,"onContinue",null);K(this,"onError",null);w(this,Ia,t)}get promise(){return o(this,Ia).capability.promise}cancel(t=0){o(this,Ia).cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=o(this,Ia).operatorList;if(!t)return!1;const{annotationCanvasMap:e}=o(this,Ia);return t.form||t.canvas&&(e==null?void 0:e.size)>0}}Ia=new WeakMap;var Fa,fc;const El=class El{constructor({callback:t,params:e,objs:n,commonObjs:r,annotationCanvasMap:a,operatorList:l,pageIndex:u,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:v=null,enableHWA:S=!1,operationsFilter:C=null}){b(this,Fa,null);this.callback=t,this.params=e,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=y,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new jT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=S,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=C}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){var h,f;if(this.cancelled)return;if(this._canvas){if(o(El,fc).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");o(El,fc).add(this._canvas)}this._pdfBug&&((h=globalThis.StepperManager)!=null&&h.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:r,background:a,dependencyTracker:l}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Mu(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:r,viewport:n,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,(f=this.graphicsReadyCallback)==null||f.call(this)}cancel(t=null,e=0){var n,r,a;this.running=!1,this.cancelled=!0,(n=this.gfx)==null||n.endDrawing(),o(this,Fa)&&(window.cancelAnimationFrame(o(this,Fa)),w(this,Fa,null)),o(El,fc).delete(this._canvas),t||(t=new BA(`Rendering cancelled, page ${this._pageIndex+1}`,e)),this.callback(t),(a=(r=this.task).onError)==null||a.call(r,t)}operatorListChanged(){var t,e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(t=this.gfx.dependencyTracker)==null||t.growOperationsCount(this.operatorList.fnArray.length),(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?w(this,Fa,window.requestAnimationFrame(()=>{w(this,Fa,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),o(El,fc).delete(this._canvas),this.callback())))}};Fa=new WeakMap,fc=new WeakMap,b(El,fc,new WeakSet);let Xw=El;const HT="5.4.530",$T="50cc4adac";var Vs,pc,Th,yn,Fp,Ph,Ao,Op,Oa,qi,Bp,Ae,qw,Yw,Kw,Al,SE,ca;const xs=class xs{constructor({editor:t=null,uiManager:e=null}){b(this,Ae);b(this,Vs,null);b(this,pc,null);b(this,Th);b(this,yn,null);b(this,Fp,!1);b(this,Ph,!1);b(this,Ao,null);b(this,Op);b(this,Oa,null);b(this,qi,null);var n,r;t?(w(this,Ph,!1),w(this,Ao,t)):w(this,Ph,!0),w(this,qi,(t==null?void 0:t._uiManager)||e),w(this,Op,o(this,qi)._eventBus),w(this,Th,((n=t==null?void 0:t.color)==null?void 0:n.toUpperCase())||((r=o(this,qi))==null?void 0:r.highlightColors.values().next().value)||"#FFFF98"),o(xs,Bp)||w(xs,Bp,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ut(this,"_keyboardManager",new bg([[["Escape","mac+Escape"],xs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],xs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],xs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],xs.prototype._moveToPrevious],[["Home","mac+Home"],xs.prototype._moveToBeginning],[["End","mac+End"],xs.prototype._moveToEnd]]))}renderButton(){const t=w(this,Vs,document.createElement("button"));t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",o(this,Ao)&&(t.ariaControls=`${o(this,Ao).id}_colorpicker_dropdown`);const e=o(this,qi)._signal;t.addEventListener("click",x(this,Ae,Al).bind(this),{signal:e}),t.addEventListener("keydown",x(this,Ae,Kw).bind(this),{signal:e});const n=w(this,pc,document.createElement("span"));return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=o(this,Th),t.append(n),t}renderMainDropdown(){const t=w(this,yn,x(this,Ae,qw).call(this));return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}_colorSelectFromKeyboard(t){if(t.target===o(this,Vs)){x(this,Ae,Al).call(this,t);return}const e=t.target.getAttribute("data-color");e&&x(this,Ae,Yw).call(this,e,t)}_moveToNext(t){var e,n;if(!o(this,Ae,ca)){x(this,Ae,Al).call(this,t);return}if(t.target===o(this,Vs)){(e=o(this,yn).firstElementChild)==null||e.focus();return}(n=t.target.nextSibling)==null||n.focus()}_moveToPrevious(t){var e,n;if(t.target===((e=o(this,yn))==null?void 0:e.firstElementChild)||t.target===o(this,Vs)){o(this,Ae,ca)&&this._hideDropdownFromKeyboard();return}o(this,Ae,ca)||x(this,Ae,Al).call(this,t),(n=t.target.previousSibling)==null||n.focus()}_moveToBeginning(t){var e;if(!o(this,Ae,ca)){x(this,Ae,Al).call(this,t);return}(e=o(this,yn).firstElementChild)==null||e.focus()}_moveToEnd(t){var e;if(!o(this,Ae,ca)){x(this,Ae,Al).call(this,t);return}(e=o(this,yn).lastElementChild)==null||e.focus()}hideDropdown(){var t,e;(t=o(this,yn))==null||t.classList.add("hidden"),o(this,Vs).ariaExpanded="false",(e=o(this,Oa))==null||e.abort(),w(this,Oa,null)}_hideDropdownFromKeyboard(){var t;if(!o(this,Ph)){if(!o(this,Ae,ca)){(t=o(this,Ao))==null||t.unselect();return}this.hideDropdown(),o(this,Vs).focus({preventScroll:!0,focusVisible:o(this,Fp)})}}updateColor(t){if(o(this,pc)&&(o(this,pc).style.backgroundColor=t),!o(this,yn))return;const e=o(this,qi).highlightColors.values();for(const n of o(this,yn).children)n.ariaSelected=e.next().value===t.toUpperCase()}destroy(){var t,e;(t=o(this,Vs))==null||t.remove(),w(this,Vs,null),w(this,pc,null),(e=o(this,yn))==null||e.remove(),w(this,yn,null)}};Vs=new WeakMap,pc=new WeakMap,Th=new WeakMap,yn=new WeakMap,Fp=new WeakMap,Ph=new WeakMap,Ao=new WeakMap,Op=new WeakMap,Oa=new WeakMap,qi=new WeakMap,Bp=new WeakMap,Ae=new WeakSet,qw=function(){const t=document.createElement("div"),e=o(this,qi)._signal;t.addEventListener("contextmenu",Ri,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),o(this,Ao)&&(t.id=`${o(this,Ao).id}_colorpicker_dropdown`);for(const[n,r]of o(this,qi).highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",r),a.title=n,a.setAttribute("data-l10n-id",o(xs,Bp)[n]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=r,a.ariaSelected=r===o(this,Th),a.addEventListener("click",x(this,Ae,Yw).bind(this,r),{signal:e}),t.append(a)}return t.addEventListener("keydown",x(this,Ae,Kw).bind(this),{signal:e}),t},Yw=function(t,e){e.stopPropagation(),o(this,Op).dispatch("switchannotationeditorparams",{source:this,type:Qt.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)},Kw=function(t){xs._keyboardManager.exec(this,t)},Al=function(t){if(o(this,Ae,ca)){this.hideDropdown();return}if(w(this,Fp,t.detail===0),o(this,Oa)||(w(this,Oa,new AbortController),window.addEventListener("pointerdown",x(this,Ae,SE).bind(this),{signal:o(this,qi).combinedSignal(o(this,Oa))})),o(this,Vs).ariaExpanded="true",o(this,yn)){o(this,yn).classList.remove("hidden");return}const e=w(this,yn,x(this,Ae,qw).call(this));o(this,Vs).append(e)},SE=function(t){var e;(e=o(this,yn))!=null&&e.contains(t.target)||this.hideDropdown()},ca=function(){return o(this,yn)&&!o(this,yn).classList.contains("hidden")},b(xs,Bp,null);let Ry=xs;var xr,Up,Rh,zp;const Cl=class Cl{constructor(t){b(this,xr,null);b(this,Up,null);b(this,Rh,null);w(this,Up,t),w(this,Rh,t._uiManager),o(Cl,zp)||w(Cl,zp,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(o(this,xr))return o(this,xr);const{editorType:t,colorType:e,color:n}=o(this,Up),r=w(this,xr,document.createElement("input"));return r.type="color",r.value=n||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",o(Cl,zp)[t]),r.addEventListener("input",()=>{o(this,Rh).updateParams(e,r.value)},{signal:o(this,Rh)._signal}),r}update(t){o(this,xr)&&(o(this,xr).value=t)}destroy(){var t;(t=o(this,xr))==null||t.remove(),w(this,xr,null)}hideDropdown(){}};xr=new WeakMap,Up=new WeakMap,Rh=new WeakMap,zp=new WeakMap,b(Cl,zp,null);let Ly=Cl;function nx(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function Jd(g){return Math.max(0,Math.min(255,255*g))}class sx{static CMYK_G([t,e,n,r]){return["G",1-Math.min(1,.3*t+.59*n+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Jd(t),[t,t,t]}static G_HTML([t]){const e=nx(t);return`#${e}${e}${e}`}static RGB_G([t,e,n]){return["G",.3*t+.59*e+.11*n]}static RGB_rgb(t){return t.map(Jd)}static RGB_HTML(t){return`#${t.map(nx).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,n,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,n+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,n,r]){return[Jd(1-Math.min(1,t+r)),Jd(1-Math.min(1,n+r)),Jd(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,n]){const r=1-t,a=1-e,l=1-n,u=Math.min(r,a,l);return["CMYK",r,a,l,u]}}class WT{create(t,e,n=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),n||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Ee("Abstract method `_createSVG` called.")}}class My extends WT{_createSVG(t){return document.createElementNS(Gr,t)}}const VT=9,$c=new WeakSet,GT=new Date().getTimezoneOffset()*60*1e3;class rw{static create(t){switch(t.data.annotationType){case ln.LINK:return new $A(t);case ln.TEXT:return new qT(t);case ln.WIDGET:switch(t.data.fieldType){case"Tx":return new YT(t);case"Btn":return t.data.radioButton?new EE(t):t.data.checkBox?new QT(t):new ZT(t);case"Ch":return new JT(t);case"Sig":return new KT(t)}return new Vc(t);case ln.POPUP:return new Zw(t);case ln.FREETEXT:return new PE(t);case ln.LINE:return new eP(t);case ln.SQUARE:return new nP(t);case ln.CIRCLE:return new sP(t);case ln.POLYLINE:return new RE(t);case ln.CARET:return new rP(t);case ln.INK:return new WA(t);case ln.POLYGON:return new iP(t);case ln.HIGHLIGHT:return new LE(t);case ln.UNDERLINE:return new oP(t);case ln.SQUIGGLY:return new aP(t);case ln.STRIKEOUT:return new lP(t);case ln.STAMP:return new ME(t);case ln.FILEATTACHMENT:return new cP(t);default:return new $e(t)}}}var gc,Lh,Ci,jp,Qw;const QA=class QA{constructor(t,{isRenderable:e=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){b(this,jp);b(this,gc,null);b(this,Lh,!1);b(this,Ci,null);this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t!=null&&t.str||e!=null&&e.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return QA._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var n;const{data:t}=this,e=(n=this.annotationStorage)==null?void 0:n.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var u;const t=(u=this.annotationStorage)==null?void 0:u.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:n,rect:r}=this.data;let a=-1/0,l=-1/0;if((e==null?void 0:e.length)>=8){for(let h=0;h<e.length;h+=8)e[h+1]>l?(l=e[h+1],a=e[h+2]):e[h+1]===l&&(a=Math.max(a,e[h+2]));return[a,l]}if((n==null?void 0:n.length)>=1){for(const h of n)for(let f=0,p=h.length;f<p;f+=2)h[f+1]>l?(l=h[f+1],a=h[f]):h[f+1]===l&&(a=Math.max(a,h[f]));if(a!==1/0)return[a,l]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/n,t[1]=100*(t[1]-l)/r,t}get commentText(){var e,n,r;const{data:t}=this;return((n=(e=this.annotationStorage.getRawValue(`${xf}${t.id}`))==null?void 0:e.popup)==null?void 0:n.contents)||((r=t.contentsObj)==null?void 0:r.str)||""}set commentText(t){const{data:e}=this,n={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:n})||this.annotationStorage.setValue(`${xf}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){var t,e;(e=((t=o(this,Ci))==null?void 0:t.popup)||this.popup)==null||e.remove(),w(this,Ci,this.popup=null)}updateEdited(t){var a;if(!this.container)return;t.rect&&(o(this,gc)||w(this,gc,{rect:this.data.rect.slice(0)}));const{rect:e,popup:n}=t;e&&x(this,jp,Qw).call(this,e);let r=((a=o(this,Ci))==null?void 0:a.popup)||this.popup;!r&&(n!=null&&n.text)&&(this._createPopup(n),r=o(this,Ci).popup),r&&(r.updateEdited(t),n!=null&&n.deleted&&(r.remove(),w(this,Ci,null),this.popup=null))}resetEdited(){var t;o(this,gc)&&(x(this,jp,Qw).call(this,o(this,gc).rect),(t=o(this,Ci))==null||t.popup.resetEdited(),w(this,gc,null))}_createContainer(t){const{data:e,parent:{page:n,viewport:r}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Vc)&&!(this instanceof $A)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof Zw){const{rotation:E}=e;return!e.hasOwnCanvas&&E!==0&&this.setRotation(E,a),a}const{width:u,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const E=e.borderStyle.horizontalCornerRadius,k=e.borderStyle.verticalCornerRadius;if(E>0||k>0){const L=`calc(${E}px * var(--total-scale-factor)) / calc(${k}px * var(--total-scale-factor))`;l.borderRadius=L}else if(this instanceof EE){const L=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=L}switch(e.borderStyle.style){case vu.SOLID:l.borderStyle="solid";break;case vu.DASHED:l.borderStyle="dashed";break;case vu.BEVELED:Bt("Unimplemented border style: beveled");break;case vu.INSET:Bt("Unimplemented border style: inset");break;case vu.UNDERLINE:l.borderBottomStyle="solid";break}const T=e.borderColor||null;T?(w(this,Lh,!0),l.borderColor=at.makeHexColor(T[0]|0,T[1]|0,T[2]|0)):l.borderWidth=0}const f=at.normalizeRect([e.rect[0],n.view[3]-e.rect[1]+n.view[1],e.rect[2],n.view[3]-e.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:y,pageX:v,pageY:S}=r.rawDims;l.left=`${100*(f[0]-v)/p}%`,l.top=`${100*(f[1]-S)/y}%`;const{rotation:C}=e;return e.hasOwnCanvas||C===0?(l.width=`${100*u/p}%`,l.height=`${100*h/y}%`):this.setRotation(C,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/n}%`,e.style.height=`${100*l/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,n,r)=>{const a=r.detail[e],l=a[0],u=a.slice(1);r.target.style[n]=sx[`${l}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[n]:sx[`${l}_rgb`](u)})};return Ut(this,"_commonActions",{display:e=>{const{display:n}=e.detail,r=n%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:n===1||n===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:n}=e.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const n=e.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(t,e){const n=this._commonActions;for(const r of Object.keys(e.detail)){const a=t[r]||n[r];a==null||a(e)}}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const n=this._commonActions;for(const[r,a]of Object.entries(e)){const l=n[r];if(l){const u={detail:{[r]:a},target:t};l(u),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,n,r,a]=this.data.rect.map(E=>Math.fround(E));if(t.length===8){const[E,k,T,L]=t.subarray(2,6);if(r===E&&a===k&&e===T&&n===L)return}const{style:l}=this.container;let u;if(o(this,Lh)){const{borderColor:E,borderWidth:k}=l;l.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${k}">`],this.container.classList.add("hasBorder")}const h=r-e,f=a-n,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const v=p.createElement("defs");y.append(v);const S=p.createElement("clipPath"),C=`clippath_${this.data.id}`;S.setAttribute("id",C),S.setAttribute("clipPathUnits","objectBoundingBox"),v.append(S);for(let E=2,k=t.length;E<k;E+=8){const T=t[E],L=t[E+1],P=t[E+2],M=t[E+3],D=p.createElement("rect"),I=(P-e)/h,U=(a-L)/f,$=(T-P)/h,G=(L-M)/f;D.setAttribute("x",I),D.setAttribute("y",U),D.setAttribute("width",$),D.setAttribute("height",G),S.append(D),u==null||u.push(`<rect vector-effect="non-scaling-stroke" x="${I}" y="${U}" width="${$}" height="${G}"/>`)}o(this,Lh)&&(u.push("</g></svg>')"),l.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${C})`}_createPopup(t=null){const{data:e}=this;let n,r;t?(n={str:t.text},r=t.date):(n=e.contentsObj,r=e.modificationDate),w(this,Ci,new Zw({data:{color:e.color,titleObj:e.titleObj,modificationDate:r,contentsObj:n,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}))}get hasPopupElement(){return!!(o(this,Ci)||this.popup||this.data.popupRef)}get extraPopupElement(){return o(this,Ci)}render(){Ee("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const n=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:a,id:l,exportValues:u}of r){if(a===-1||l===e)continue;const h=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!$c.has(f)){Bt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const r of document.getElementsByName(t)){const{exportValue:a}=r,l=r.getAttribute("data-element-id");l!==e&&$c.has(r)&&n.push({id:l,exportValue:a,domElement:r})}return n}show(){var t;this.container&&(this.container.hidden=!1),(t=this.popup)==null||t.maybeShow()}hide(){var t;this.container&&(this.container.hidden=!0),(t=this.popup)==null||t.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{var n;(n=this.linkService.eventBus)==null||n.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};gc=new WeakMap,Lh=new WeakMap,Ci=new WeakMap,jp=new WeakSet,Qw=function(t){const{container:{style:e},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:u,pageY:h}}}}=this;n==null||n.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(l-t[3]+h)/l}%`,r===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(r)};let $e=QA;class XT extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}var oi,Sl,bE,xE;class $A extends $e{constructor(e,n=null){super(e,{isRenderable:!0,ignoreBorder:!!(n!=null&&n.ignoreBorder),createQuadrilaterals:!0});b(this,oi);this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:n}=this,r=document.createElement("a");r.setAttribute("data-element-id",e.id);let a=!1;return e.url?(n.addLinkAttributes(r,e.url,e.newWindow),a=!0):e.action?(this._bindNamedAction(r,e.action,e.overlaidText),a=!0):e.attachment?(x(this,oi,bE).call(this,r,e.attachment,e.overlaidText,e.attachmentDest),a=!0):e.setOCGState?(x(this,oi,xE).call(this,r,e.setOCGState,e.overlaidText),a=!0):e.dest?(this._bindLink(r,e.dest,e.overlaidText),a=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(r,e),a=!0),e.resetForm?(this._bindResetFormAction(r,e.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(r,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=r,this.container.append(r)),this.container}_bindLink(e,n,r=""){e.href=this.linkService.getDestinationHash(n),e.onclick=()=>(n&&this.linkService.goToDestination(n),!1),(n||n==="")&&x(this,oi,Sl).call(this),r&&(e.title=r)}_bindNamedAction(e,n,r=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(n),!1),r&&(e.title=r),x(this,oi,Sl).call(this)}_bindJSAction(e,n){e.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(n.actions)){const l=r.get(a);l&&(e[l]=()=>{var u;return(u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:n.id,name:a}}),!1})}n.overlaidText&&(e.title=n.overlaidText),e.onclick||(e.onclick=()=>!1),x(this,oi,Sl).call(this)}_bindResetFormAction(e,n){const r=e.onclick;if(r||(e.href=this.linkService.getAnchorUrl("")),x(this,oi,Sl).call(this),!this._fieldObjects){Bt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(e.onclick=()=>!1);return}e.onclick=()=>{var y;r==null||r();const{fields:a,refs:l,include:u}=n,h=[];if(a.length!==0||l.length!==0){const v=new Set(l);for(const S of a){const C=this._fieldObjects[S]||[];for(const{id:E}of C)v.add(E)}for(const S of Object.values(this._fieldObjects))for(const C of S)v.has(C.id)===u&&h.push(C)}else for(const v of Object.values(this._fieldObjects))h.push(...v);const f=this.annotationStorage,p=[];for(const v of h){const{id:S}=v;switch(p.push(S),v.type){case"text":{const E=v.defaultValue||"";f.setValue(S,{value:E});break}case"checkbox":case"radiobutton":{const E=v.defaultValue===v.exportValues;f.setValue(S,{value:E});break}case"combobox":case"listbox":{const E=v.defaultValue||"";f.setValue(S,{value:E});break}default:continue}const C=document.querySelector(`[data-element-id="${S}"]`);if(C){if(!$c.has(C)){Bt(`_bindResetFormAction - element not allowed: ${S}`);continue}}else continue;C.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((y=this.linkService.eventBus)==null||y.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:p,name:"ResetForm"}})),!1}}}oi=new WeakSet,Sl=function(){this.container.setAttribute("data-internal-link","")},bE=function(e,n,r="",a=null){e.href=this.linkService.getAnchorUrl(""),n.description?e.title=n.description:r&&(e.title=r),e.onclick=()=>{var l;return(l=this.downloadManager)==null||l.openOrDownloadData(n.content,n.filename,a),!1},x(this,oi,Sl).call(this)},xE=function(e,n,r=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(n),!1),r&&(e.title=r),x(this,oi,Sl).call(this)};class qT extends $e{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Vc extends $e{render(){return this.container}showElementAndHideCanvas(t){var e;this.data.hasOwnCanvas&&(((e=t.previousSibling)==null?void 0:e.nodeName)==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return wn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,n,r,a){n.includes("mouse")?t.addEventListener(n,l=>{var u;(u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(n,l=>{var u;if(n==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(n==="focus"){if(e.focused)return;e.focused=!0}a&&((u=this.linkService.eventBus)==null||u.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(l)}}))})}_setEventListeners(t,e,n,r){var a,l,u;for(const[h,f]of n)(f==="Action"||(a=this.data.actions)!=null&&a[f])&&((f==="Focus"||f==="Blur")&&(e||(e={focused:!1})),this._setEventListener(t,e,h,f,r),f==="Focus"&&!((l=this.data.actions)!=null&&l.Blur)?this._setEventListener(t,e,"blur","Blur",null):f==="Blur"&&!((u=this.data.actions)!=null&&u.Focus)&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":at.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||VT,a=t.style;let l;const u=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Qv*r))||1,y=f/p;l=Math.min(r,h(y/Qv))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);l=Math.min(r,h(f/Qv))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=at.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class YT extends Vc{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,n,r){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=n),a.setValue(l.id,{[r]:n})}render(){var r,a;const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const l=t.getValue(e,{value:this.data.fieldValue});let u=l.value||"";const h=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;h&&u.length>h&&(u=u.slice(0,h));let f=l.formattedValue||((r=this.data.textContent)==null?void 0:r.join(`
`))||null;f&&this.data.comb&&(f=f.replaceAll(/\s+/g,""));const p={userValue:u,formattedValue:f,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=f??u,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",f??u),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),$c.add(n),this.contentElement=n,n.setAttribute("data-element-id",e),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:y,datetimeType:v,timeStep:S}=this.data,C=!!v&&this.enableScripting;y&&(n.title=y),this._setRequired(n,this.data.required),h&&(n.maxLength=h),n.addEventListener("input",k=>{t.setValue(e,{value:k.target.value}),this.setPropertyOnSiblings(n,"value",k.target.value,"value"),p.formattedValue=null}),n.addEventListener("resetform",k=>{const T=this.data.defaultFieldValue??"";n.value=p.userValue=T,p.formattedValue=null});let E=k=>{const{formattedValue:T}=p;T!=null&&(k.target.value=T),k.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",T=>{var P;if(p.focused)return;const{target:L}=T;if(C&&(L.type=v,S&&(L.step=S)),p.userValue){const M=p.userValue;if(C)if(v==="time"){const D=new Date(M),I=[D.getHours(),D.getMinutes(),D.getSeconds()];L.value=I.map(U=>U.toString().padStart(2,"0")).join(":")}else L.value=new Date(M-GT).toISOString().split(v==="date"?"T":".",1)[0];else L.value=M}p.lastCommittedValue=L.value,p.commitKey=1,(P=this.data.actions)!=null&&P.Focus||(p.focused=!0)}),n.addEventListener("updatefromsandbox",T=>{this.showElementAndHideCanvas(T.target);const L={value(P){p.userValue=P.detail.value??"",C||t.setValue(e,{value:p.userValue.toString()}),P.target.value=p.userValue},formattedValue(P){const{formattedValue:M}=P.detail;p.formattedValue=M,M!=null&&P.target!==document.activeElement&&(P.target.value=M);const D={formattedValue:M};C&&(D.value=M),t.setValue(e,D)},selRange(P){P.target.setSelectionRange(...P.detail.selRange)},charLimit:P=>{var U;const{charLimit:M}=P.detail,{target:D}=P;if(M===0){D.removeAttribute("maxLength");return}D.setAttribute("maxLength",M);let I=p.userValue;!I||I.length<=M||(I=I.slice(0,M),D.value=p.userValue=I,t.setValue(e,{value:I}),(U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:I,willCommit:!0,commitKey:1,selStart:D.selectionStart,selEnd:D.selectionEnd}}))}};this._dispatchEventFromSandbox(L,T)}),n.addEventListener("keydown",T=>{var M;p.commitKey=1;let L=-1;if(T.key==="Escape"?L=0:T.key==="Enter"&&!this.data.multiLine?L=2:T.key==="Tab"&&(p.commitKey=3),L===-1)return;const{value:P}=T.target;p.lastCommittedValue!==P&&(p.lastCommittedValue=P,p.userValue=P,(M=this.linkService.eventBus)==null||M.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:P,willCommit:!0,commitKey:L,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}}))});const k=E;E=null,n.addEventListener("blur",T=>{var M,D;if(!p.focused||!T.relatedTarget)return;(M=this.data.actions)!=null&&M.Blur||(p.focused=!1);const{target:L}=T;let{value:P}=L;if(C){if(P&&v==="time"){const I=P.split(":").map(U=>parseInt(U,10));P=new Date(2e3,0,1,I[0],I[1],I[2]||0).valueOf(),L.step=""}else P.includes("T")||(P=`${P}T00:00`),P=new Date(P).valueOf();L.type="text"}p.userValue=P,p.lastCommittedValue!==P&&((D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:P,willCommit:!0,commitKey:p.commitKey,selStart:T.target.selectionStart,selEnd:T.target.selectionEnd}})),k(T)}),(a=this.data.actions)!=null&&a.Keystroke&&n.addEventListener("beforeinput",T=>{var G;p.lastCommittedValue=null;const{data:L,target:P}=T,{value:M,selectionStart:D,selectionEnd:I}=P;let U=D,$=I;switch(T.inputType){case"deleteWordBackward":{const nt=M.substring(0,D).match(/\w*[^\w]*$/);nt&&(U-=nt[0].length);break}case"deleteWordForward":{const nt=M.substring(D).match(/^[^\w]*\w*/);nt&&($+=nt[0].length);break}case"deleteContentBackward":D===I&&(U-=1);break;case"deleteContentForward":D===I&&($+=1);break}T.preventDefault(),(G=this.linkService.eventBus)==null||G.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,change:L||"",willCommit:!1,selStart:U,selEnd:$}})}),this._setEventListeners(n,p,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],T=>T.target.value)}if(E&&n.addEventListener("blur",E),this.data.comb){const T=(this.data.rect[2]-this.data.rect[0])/h;n.classList.add("comb"),n.style.letterSpacing=`calc(${T}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class KT extends Vc{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class QT extends Vc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,n=e.id;let r=t.getValue(n,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(n,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return $c.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n)){const p=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue||"Off";l.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class EE extends Vc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,n=e.id;let r=t.getValue(n,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(n,{value:r})),r)for(const l of this._getElementsByName(e.fieldName,n))t.setValue(l.id,{value:!1});const a=document.createElement("input");if($c.add(a),a.setAttribute("data-element-id",n),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:u,checked:h}=l.target;for(const f of this._getElementsByName(u,n))t.setValue(f.id,{value:!1});t.setValue(n,{value:h})}),a.addEventListener("resetform",l=>{const u=e.defaultFieldValue;l.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const h={value:f=>{const p=l===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const v=p&&y.id===n;y.domElement&&(y.domElement.checked=v),t.setValue(y.id,{value:v})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class ZT extends $A{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),t}}class JT extends Vc{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,n=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");$c.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const v of r.options)v.selected=v.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,n.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),a=!1),r.append(y)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),l=()=>{p.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const u=p=>{const y=p?"value":"textContent",{options:v,multiple:S}=r;return S?Array.prototype.filter.call(v,C=>C.selected).map(C=>C[y]):v.selectedIndex===-1?null:v[v.selectedIndex][y]};let h=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const y={value(v){l==null||l();const S=v.detail.value,C=new Set(Array.isArray(S)?S:[S]);for(const E of r.options)E.selected=C.has(E.value);t.setValue(e,{value:u(!0)}),h=u(!1)},multipleSelection(v){r.multiple=!0},remove(v){const S=r.options,C=v.detail.remove;S[C].selected=!1,r.remove(C),S.length>0&&Array.prototype.findIndex.call(S,k=>k.selected)===-1&&(S[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},clear(v){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),h=u(!1)},insert(v){const{index:S,displayValue:C,exportValue:E}=v.detail.insert,k=r.children[S],T=document.createElement("option");T.textContent=C,T.value=E,k?k.before(T):r.append(T),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},items(v){const{items:S}=v.detail;for(;r.length!==0;)r.remove(0);for(const C of S){const{displayValue:E,exportValue:k}=C,T=document.createElement("option");T.textContent=E,T.value=k,r.append(T)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(v)}),h=u(!1)},indices(v){const S=new Set(v.detail.indices);for(const C of v.target.options)C.selected=S.has(C.index);t.setValue(e,{value:u(!0)}),h=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(y,p)}),r.addEventListener("input",p=>{var S;const y=u(!0),v=u(!1);t.setValue(e,{value:y}),p.preventDefault(),(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}var Hp,Jw;class Zw extends $e{constructor(e){const{data:n,elements:r,parent:a}=e,l=!!a._commentManager;super(e,{isRenderable:!l&&$e._hasPopupData(n)});b(this,Hp);if(this.elements=r,l&&$e._hasPopupData(n)){const u=this.popup=x(this,Hp,Jw).call(this);for(const h of r)h.popup=u}else this.popup=null}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const n=this.popup=x(this,Hp,Jw).call(this),r=[];for(const a of this.elements)a.popup=n,a.container.ariaHasPopup="dialog",r.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",r.map(a=>`${_u}${a}`).join(",")),this.container}}Hp=new WeakSet,Jw=function(){return new tP({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Gs,Ba,Yy,Ky,Mh,Dh,qe,Er,Ua,mc,Nh,Ih,Cr,Xs,So,bo,Ye,xo,za,$p,Eo,Fh,yc,ja,Cn,Ha,Wt,sy,tA,eA,nA,iy,sA,CE,_E,kE,TE,ry,oy,iA;class tP{constructor({container:t,color:e,elements:n,titleObj:r,modificationDate:a,contentsObj:l,richText:u,parent:h,rect:f,parentRect:p,open:y,commentManager:v=null}){b(this,Wt);b(this,Gs,null);b(this,Ba,x(this,Wt,kE).bind(this));b(this,Yy,x(this,Wt,iA).bind(this));b(this,Ky,x(this,Wt,oy).bind(this));b(this,Mh,x(this,Wt,ry).bind(this));b(this,Dh,null);b(this,qe,null);b(this,Er,null);b(this,Ua,null);b(this,mc,null);b(this,Nh,null);b(this,Ih,null);b(this,Cr,!1);b(this,Xs,null);b(this,So,null);b(this,bo,null);b(this,Ye,null);b(this,xo,null);b(this,za,null);b(this,$p,null);b(this,Eo,null);b(this,Fh,null);b(this,yc,null);b(this,ja,!1);b(this,Cn,null);b(this,Ha,null);w(this,qe,t),w(this,Fh,r),w(this,Er,l),w(this,Eo,u),w(this,Nh,h),w(this,Dh,e),w(this,$p,f),w(this,Ih,p),w(this,mc,n),w(this,Gs,v),w(this,Cn,n[0]),w(this,Ua,Ey.toDateObject(a)),this.trigger=n.flatMap(S=>S.getElementsToTriggerPopup()),v||(x(this,Wt,sy).call(this),o(this,qe).hidden=!0,y&&x(this,Wt,ry).call(this))}renderCommentButton(){if(o(this,Ye)){o(this,Ye).parentNode||o(this,Cn).container.after(o(this,Ye));return}if(o(this,xo)||x(this,Wt,tA).call(this),!o(this,xo))return;const{signal:t}=w(this,So,new AbortController),e=o(this,Cn).hasOwnCommentButton,n=()=>{o(this,Gs).toggleCommentPopup(this,!0,void 0,!e)},r=()=>{o(this,Gs).toggleCommentPopup(this,!1,!0,!e)},a=()=>{o(this,Gs).toggleCommentPopup(this,!1,!1)};if(e){w(this,Ye,o(this,Cn).container);for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",o(this,Ba),{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",r,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),l.classList.add("popupTriggerArea")}else{const l=w(this,Ye,document.createElement("button"));l.className="annotationCommentButton";const u=o(this,Cn).container;l.style.zIndex=u.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),x(this,Wt,nA).call(this),x(this,Wt,eA).call(this),l.addEventListener("keydown",o(this,Ba),{signal:t}),l.addEventListener("click",n,{signal:t}),l.addEventListener("pointerenter",r,{signal:t}),l.addEventListener("pointerleave",a,{signal:t}),u.after(l)}}get commentButtonColor(){const{color:t,opacity:e}=o(this,Cn).commentData;return t?o(this,Nh)._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{var t;(t=o(this,Ye))==null||t.focus()},0)}getData(){const{richText:t,color:e,opacity:n,creationDate:r,modificationDate:a}=o(this,Cn).commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:n,creationDate:r,modificationDate:a}}get elementBeforePopup(){return o(this,Ye)}get comment(){return o(this,Ha)||w(this,Ha,o(this,Cn).commentText),o(this,Ha)}set comment(t){t!==this.comment&&(o(this,Cn).commentText=w(this,Ha,t))}focus(){var t;(t=o(this,Cn).container)==null||t.focus()}get parentBoundingClientRect(){return o(this,Cn).layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){o(this,Ye)&&(o(this,Ye).classList.toggle("selected",t),o(this,Ye).ariaExpanded=e)}setSelectedCommentButton(t){o(this,Ye).classList.toggle("selected",t)}get commentPopupPosition(){if(o(this,za))return o(this,za);const{x:t,y:e,height:n}=o(this,Ye).getBoundingClientRect(),{x:r,y:a,width:l,height:u}=o(this,Cn).layer.getBoundingClientRect();return[(t-r)/l,(e+n-a)/u]}set commentPopupPosition(t){w(this,za,t)}hasDefaultPopupPosition(){return o(this,za)===null}get commentButtonPosition(){return o(this,xo)}get commentButtonWidth(){return o(this,Ye).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,n]=o(this,za)||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:a,y:l,width:u,height:h}=r;o(this,Gs).showDialog(null,this,a+e*u,l+n*h,{...t,parentDimensions:r})}render(){var n,r;if(o(this,Xs))return;const t=w(this,Xs,document.createElement("div"));if(t.className="popup",o(this,Dh)){const a=t.style.outlineColor=at.makeHexColor(...o(this,Dh));t.style.backgroundColor=`color-mix(in srgb, ${a} 30%, white)`}const e=document.createElement("span");if(e.className="header",(n=o(this,Fh))!=null&&n.str){const a=document.createElement("span");a.className="title",e.append(a),{dir:a.dir,str:a.textContent}=o(this,Fh)}if(t.append(e),o(this,Ua)){const a=document.createElement("time");a.className="popupDate",a.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),a.setAttribute("data-l10n-args",JSON.stringify({dateObj:o(this,Ua).valueOf()})),a.dateTime=o(this,Ua).toISOString(),e.append(a)}gx({html:o(this,Wt,iy)||o(this,Er).str,dir:(r=o(this,Er))==null?void 0:r.dir,className:"popupContent"},t),o(this,qe).append(t)}updateEdited({rect:t,popup:e,deleted:n}){var r;if(o(this,Gs)){n?(this.remove(),w(this,Ha,null)):e&&(e.deleted?this.remove():(x(this,Wt,nA).call(this),w(this,Ha,e.text))),t&&(w(this,xo,null),x(this,Wt,tA).call(this),x(this,Wt,eA).call(this));return}if(n||e!=null&&e.deleted){this.remove();return}x(this,Wt,sy).call(this),o(this,yc)||w(this,yc,{contentsObj:o(this,Er),richText:o(this,Eo)}),t&&w(this,bo,null),e&&e.text&&(w(this,Eo,x(this,Wt,_E).call(this,e.text)),w(this,Ua,Ey.toDateObject(e.date)),w(this,Er,null)),(r=o(this,Xs))==null||r.remove(),w(this,Xs,null)}resetEdited(){var t;o(this,yc)&&({contentsObj:fn(this,Er)._,richText:fn(this,Eo)._}=o(this,yc),w(this,yc,null),(t=o(this,Xs))==null||t.remove(),w(this,Xs,null),w(this,bo,null))}remove(){var t,e,n;if((t=o(this,So))==null||t.abort(),w(this,So,null),(e=o(this,Xs))==null||e.remove(),w(this,Xs,null),w(this,ja,!1),w(this,Cr,!1),(n=o(this,Ye))==null||n.remove(),w(this,Ye,null),this.trigger)for(const r of this.trigger)r.classList.remove("popupTriggerArea")}forceHide(){w(this,ja,this.isVisible),o(this,ja)&&(o(this,qe).hidden=!0)}maybeShow(){o(this,Gs)||(x(this,Wt,sy).call(this),o(this,ja)&&(o(this,Xs)||x(this,Wt,oy).call(this),w(this,ja,!1),o(this,qe).hidden=!1))}get isVisible(){return o(this,Gs)?!1:o(this,qe).hidden===!1}}Gs=new WeakMap,Ba=new WeakMap,Yy=new WeakMap,Ky=new WeakMap,Mh=new WeakMap,Dh=new WeakMap,qe=new WeakMap,Er=new WeakMap,Ua=new WeakMap,mc=new WeakMap,Nh=new WeakMap,Ih=new WeakMap,Cr=new WeakMap,Xs=new WeakMap,So=new WeakMap,bo=new WeakMap,Ye=new WeakMap,xo=new WeakMap,za=new WeakMap,$p=new WeakMap,Eo=new WeakMap,Fh=new WeakMap,yc=new WeakMap,ja=new WeakMap,Cn=new WeakMap,Ha=new WeakMap,Wt=new WeakSet,sy=function(){var e;if(o(this,So))return;w(this,So,new AbortController);const{signal:t}=o(this,So);for(const n of this.trigger)n.addEventListener("click",o(this,Mh),{signal:t}),n.addEventListener("pointerenter",o(this,Ky),{signal:t}),n.addEventListener("pointerleave",o(this,Yy),{signal:t}),n.classList.add("popupTriggerArea");for(const n of o(this,mc))(e=n.container)==null||e.addEventListener("keydown",o(this,Ba),{signal:t})},tA=function(){const t=o(this,mc).find(e=>e.hasCommentButton);t&&w(this,xo,t._normalizePoint(t.commentButtonPosition))},eA=function(){if(o(this,Cn).extraPopupElement&&!o(this,Cn).editor)return;o(this,Ye)||this.renderCommentButton();const[t,e]=o(this,xo),{style:n}=o(this,Ye);n.left=`calc(${t}%)`,n.top=`calc(${e}% - var(--comment-button-dim))`},nA=function(){o(this,Cn).extraPopupElement||(o(this,Ye)||this.renderCommentButton(),o(this,Ye).style.backgroundColor=this.commentButtonColor||"")},iy=function(){const t=o(this,Eo),e=o(this,Er);return t!=null&&t.str&&(!(e!=null&&e.str)||e.str===t.str)&&o(this,Eo).html||null},sA=function(){var t,e,n;return((n=(e=(t=o(this,Wt,iy))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.fontSize)||0},CE=function(){var t,e,n;return((n=(e=(t=o(this,Wt,iy))==null?void 0:t.attributes)==null?void 0:e.style)==null?void 0:n.color)||null},_E=function(t){const e=[],n={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:o(this,Wt,CE),fontSize:o(this,Wt,sA)?`calc(${o(this,Wt,sA)}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:r});return n},kE=function(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&o(this,Cr))&&x(this,Wt,ry).call(this)},TE=function(){if(o(this,bo)!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:n,pageX:r,pageY:a}}}=o(this,Nh);let l=!!o(this,Ih),u=l?o(this,Ih):o(this,$p);for(const C of o(this,mc))if(!u||at.intersect(C.data.rect,u)!==null){u=C.data.rect,l=!0;break}const h=at.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=l?u[2]-u[0]+5:0,y=h[0]+p,v=h[1];w(this,bo,[100*(y-r)/e,100*(v-a)/n]);const{style:S}=o(this,qe);S.left=`${o(this,bo)[0]}%`,S.top=`${o(this,bo)[1]}%`},ry=function(){if(o(this,Gs)){o(this,Gs).toggleCommentPopup(this,!1);return}w(this,Cr,!o(this,Cr)),o(this,Cr)?(x(this,Wt,oy).call(this),o(this,qe).addEventListener("click",o(this,Mh)),o(this,qe).addEventListener("keydown",o(this,Ba))):(x(this,Wt,iA).call(this),o(this,qe).removeEventListener("click",o(this,Mh)),o(this,qe).removeEventListener("keydown",o(this,Ba)))},oy=function(){o(this,Xs)||this.render(),this.isVisible?o(this,Cr)&&o(this,qe).classList.add("focused"):(x(this,Wt,TE).call(this),o(this,qe).hidden=!1,o(this,qe).style.zIndex=parseInt(o(this,qe).style.zIndex)+1e3)},iA=function(){o(this,qe).classList.remove("focused"),!(o(this,Cr)||!this.isVisible)&&(o(this,qe).hidden=!0,o(this,qe).style.zIndex=parseInt(o(this,qe).style.zIndex)-1e3)};class PE extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=jt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const n=document.createElement("span");n.textContent=e,t.append(n)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Wp;class eP extends $e{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,Wp,null)}render(){this.container.classList.add("lineAnnotation");const{data:e,width:n,height:r}=this,a=this.svgFactory.create(n,r,!0),l=w(this,Wp,this.svgFactory.createElement("svg:line"));return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Wp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wp=new WeakMap;var Vp;class nP extends $e{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,Vp,null)}render(){this.container.classList.add("squareAnnotation");const{data:e,width:n,height:r}=this,a=this.svgFactory.create(n,r,!0),l=e.borderStyle.width,u=w(this,Vp,this.svgFactory.createElement("svg:rect"));return u.setAttribute("x",l/2),u.setAttribute("y",l/2),u.setAttribute("width",n-l),u.setAttribute("height",r-l),u.setAttribute("stroke-width",l||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),a.append(u),this.container.append(a),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Vp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Vp=new WeakMap;var Gp;class sP extends $e{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,Gp,null)}render(){this.container.classList.add("circleAnnotation");const{data:e,width:n,height:r}=this,a=this.svgFactory.create(n,r,!0),l=e.borderStyle.width,u=w(this,Gp,this.svgFactory.createElement("svg:ellipse"));return u.setAttribute("cx",n/2),u.setAttribute("cy",r/2),u.setAttribute("rx",n/2-l/2),u.setAttribute("ry",r/2-l/2),u.setAttribute("stroke-width",l||1),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),a.append(u),this.container.append(a),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Gp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gp=new WeakMap;var Xp;class RE extends $e{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,Xp,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:n,borderStyle:r,popupRef:a},width:l,height:u}=this;if(!n)return this.container;const h=this.svgFactory.create(l,u,!0);let f=[];for(let y=0,v=n.length;y<v;y+=2){const S=n[y]-e[0],C=e[3]-n[y+1];f.push(`${S},${C}`)}f=f.join(" ");const p=w(this,Xp,this.svgFactory.createElement(this.svgElementName));return p.setAttribute("points",f),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),h.append(p),this.container.append(h),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return o(this,Xp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Xp=new WeakMap;class iP extends RE{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rP extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}var qp,vc,Yp,rA;class WA extends $e{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0});b(this,Yp);b(this,qp,null);b(this,vc,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?jt.HIGHLIGHT:jt.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:n,inkLists:r,borderStyle:a,popupRef:l}}=this,{transform:u,width:h,height:f}=x(this,Yp,rA).call(this,n,e),p=this.svgFactory.create(h,f,!0),y=w(this,qp,this.svgFactory.createElement("svg:g"));p.append(y),y.setAttribute("stroke-width",a.width||1),y.setAttribute("stroke-linecap","round"),y.setAttribute("stroke-linejoin","round"),y.setAttribute("stroke-miterlimit",10),y.setAttribute("stroke","transparent"),y.setAttribute("fill","transparent"),y.setAttribute("transform",u);for(let v=0,S=r.length;v<S;v++){const C=this.svgFactory.createElement(this.svgElementName);o(this,vc).push(C),C.setAttribute("points",r[v].join(",")),y.append(C)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(p),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:n,points:r,rect:a}=e,l=o(this,qp);if(n>=0&&l.setAttribute("stroke-width",n||1),r)for(let u=0,h=o(this,vc).length;u<h;u++)o(this,vc)[u].setAttribute("points",r[u].join(","));if(a){const{transform:u,width:h,height:f}=x(this,Yp,rA).call(this,this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${h} ${f}`),l.setAttribute("transform",u)}}getElementsToTriggerPopup(){return o(this,vc)}addHighlightArea(){this.container.classList.add("highlightArea")}}qp=new WeakMap,vc=new WeakMap,Yp=new WeakSet,rA=function(e,n){switch(e){case 90:return{transform:`rotate(90) translate(${-n[0]},${n[1]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};case 180:return{transform:`rotate(180) translate(${-n[2]},${n[1]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]};case 270:return{transform:`rotate(270) translate(${-n[2]},${n[3]}) scale(1,-1)`,width:n[3]-n[1],height:n[2]-n[0]};default:return{transform:`translate(${-n[0]},${n[3]}) scale(1,-1)`,width:n[2]-n[0],height:n[3]-n[1]}}};class LE extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=jt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class oP extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class aP extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class lP extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=t,this.container.append(n)}return this.container}}class ME extends $e{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=jt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}var Kp,Qp,oA;class cP extends $e{constructor(e){var r;super(e,{isRenderable:!0});b(this,Qp);b(this,Kp,null);const{file:n}=this.data;this.filename=n.filename,this.content=n.content,(r=this.linkService.eventBus)==null||r.dispatch("fileattachmentannotation",{source:this,...n})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:n}=this;let r;n.hasAppearance||n.fillAlpha===0?r=document.createElement("div"):(r=document.createElement("img"),r.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(n.name)?"paperclip":"pushpin"}.svg`,n.fillAlpha&&n.fillAlpha<1&&(r.style=`filter: opacity(${Math.round(n.fillAlpha*100)}%);`)),r.addEventListener("dblclick",x(this,Qp,oA).bind(this)),w(this,Kp,r);const{isMac:a}=wn.platform;return e.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&x(this,Qp,oA).call(this)}),!n.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):r.classList.add("popupTriggerArea"),e.append(r),e}getElementsToTriggerPopup(){return o(this,Kp)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kp=new WeakMap,Qp=new WeakSet,oA=function(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.content,this.filename)};var wc,Ac,Oh,$a,Zp,Sc,qs,Jp,No,ay,lA;const ZA=class ZA{constructor({div:t,accessibilityManager:e,annotationCanvasMap:n,annotationEditorUIManager:r,page:a,viewport:l,structTreeLayer:u,commentManager:h,linkService:f,annotationStorage:p}){b(this,No);b(this,wc,null);b(this,Ac,null);b(this,Oh,null);b(this,$a,new Map);b(this,Zp,null);b(this,Sc,null);b(this,qs,[]);b(this,Jp,!1);this.div=t,w(this,wc,e),w(this,Ac,n),w(this,Zp,u||null),w(this,Sc,f||null),w(this,Oh,p||new zA),this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=h||null}hasEditableAnnotations(){return o(this,$a).size>0}async render(t){var u;const{annotations:e}=t,n=this.div;jc(n,this.viewport);const r=new Map,a=[],l={data:null,layer:n,linkService:o(this,Sc),downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new My,annotationStorage:o(this,Oh),enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const h of e){if(h.noHTML)continue;const f=h.annotationType===ln.POPUP;if(f){const v=r.get(h.id);if(!v)continue;if(!this._commentManager){a.push(h);continue}l.elements=v}else if(h.rect[2]===h.rect[0]||h.rect[3]===h.rect[1])continue;l.data=h;const p=rw.create(l);if(!p.isRenderable)continue;if(!f&&(o(this,qs).push(p),h.popupRef)){const v=r.get(h.popupRef);v?v.push(p):r.set(h.popupRef,[p])}const y=p.render();h.hidden&&(y.style.visibility="hidden"),p._isEditable&&(o(this,$a).set(p.data.id,p),(u=this._annotationEditorUIManager)==null||u.renderAnnotationElement(p))}await x(this,No,ay).call(this);for(const h of a){const f=l.elements=r.get(h.id);l.data=h;const p=rw.create(l);if(!p.isRenderable)continue;const y=p.render();p.contentElement.id=`${_u}${h.id}`,h.hidden&&(y.style.visibility="hidden"),f.at(-1).container.after(y)}x(this,No,lA).call(this)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:o(this,Sc),svgFactory:new My,parent:this};for(const n of t){n.borderStyle||(n.borderStyle=ZA._defaultBorderStyle),e.data=n;const r=rw.create(e);r.isRenderable&&(r.render(),r.contentElement.id=`${_u}${n.id}`,o(this,qs).push(r))}await x(this,No,ay).call(this)}update({viewport:t}){const e=this.div;this.viewport=t,jc(e,{rotation:t.rotation}),x(this,No,lA).call(this),e.hidden=!1}getEditableAnnotations(){return Array.from(o(this,$a).values())}getEditableAnnotation(t){return o(this,$a).get(t)}addFakeAnnotation(t){const{div:e}=this,{id:n,rotation:r}=t,a=new XT({data:{id:n,rect:t.getPDFRect(),rotation:r},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:o(this,Sc),annotationStorage:o(this,Oh)});return a.render(),a.contentElement.id=`${_u}${n}`,a.createOrUpdatePopup(),o(this,qs).push(a),a}removeAnnotation(t){var r;const e=o(this,qs).findIndex(a=>a.data.id===t);if(e<0)return;const[n]=o(this,qs).splice(e,1);(r=o(this,wc))==null||r.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);x(this,No,ay).call(this)}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return Ut(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:vu.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};wc=new WeakMap,Ac=new WeakMap,Oh=new WeakMap,$a=new WeakMap,Zp=new WeakMap,Sc=new WeakMap,qs=new WeakMap,Jp=new WeakMap,No=new WeakSet,ay=async function(){var n,r,a;if(o(this,qs).length===0)return;this.div.replaceChildren();const t=[];if(!o(this,Jp)){w(this,Jp,!0);for(const{contentElement:l,data:{id:u}}of o(this,qs)){const h=l.id=`${_u}${u}`;t.push((n=o(this,Zp))==null?void 0:n.getAriaAttributes(h).then(f=>{if(f)for(const[p,y]of f)l.setAttribute(p,y)}))}}o(this,qs).sort(({data:{rect:[l,u,h,f]}},{data:{rect:[p,y,v,S]}})=>{if(l===h&&u===f)return 1;if(p===v&&y===S)return-1;const C=f,E=u,k=(u+f)/2,T=S,L=y,P=(y+S)/2;if(k>=T&&P<=E)return-1;if(P>=C&&k<=L)return 1;const M=(l+h)/2,D=(p+v)/2;return M-D});const e=document.createDocumentFragment();for(const l of o(this,qs))e.append(l.container),this._commentManager?(a=((r=l.extraPopupElement)==null?void 0:r.popup)||l.popup)==null||a.renderCommentButton():l.extraPopupElement&&e.append(l.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),o(this,wc))for(const l of o(this,qs))o(this,wc).addPointerInTextLayer(l.contentElement,!1)},lA=function(){var e;if(!o(this,Ac))return;const t=this.div;for(const[n,r]of o(this,Ac)){const a=t.querySelector(`[data-annotation-id="${n}"]`);if(!a)continue;r.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(r):l.classList.contains("annotationContent")?l.after(r):l.before(r):a.append(r);const u=o(this,$a).get(n);u&&(u._hasNoCanvas?((e=this._annotationEditorUIManager)==null||e.setMissingCanvas(n,a.id,r),u._hasNoCanvas=!1):u.canvas=r)}o(this,Ac).clear()};let aA=ZA;const jm=/\r\n?|\n/g;var Ys,tg,bc,Ks,un,DE,NE,IE,ly,Io,cy,uy,FE,uA,OE;const De=class De extends Re{constructor(e){super({...e,name:"freeTextEditor"});b(this,un);b(this,Ys,"");b(this,tg,`${this.id}-editor`);b(this,bc,null);b(this,Ks);K(this,"_colorPicker",null);this.color=e.color||De._defaultColor||Re._defaultLineColor,w(this,Ks,e.fontSize||De._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static get _keyboardManager(){const e=De.prototype,n=l=>l.isEmpty(),r=Hc.TRANSLATE_SMALL,a=Hc.TRANSLATE_BIG;return Ut(this,"_keyboardManager",new bg([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-r,0],checker:n}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-a,0],checker:n}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[r,0],checker:n}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[a,0],checker:n}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-r],checker:n}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-a],checker:n}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,r],checker:n}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,a],checker:n}]]))}static initialize(e,n){Re.initialize(e,n);const r=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(r.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,n){switch(e){case Qt.FREETEXT_SIZE:De._defaultFontSize=n;break;case Qt.FREETEXT_COLOR:De._defaultColor=n;break}}updateParams(e,n){switch(e){case Qt.FREETEXT_SIZE:x(this,un,DE).call(this,n);break;case Qt.FREETEXT_COLOR:x(this,un,NE).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Qt.FREETEXT_SIZE,De._defaultFontSize],[Qt.FREETEXT_COLOR,De._defaultColor||Re._defaultLineColor]]}get propertiesToUpdate(){return[[Qt.FREETEXT_SIZE,o(this,Ks)],[Qt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Ly(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Qt.FREETEXT_COLOR}onUpdatedColor(){var e;this.editorDiv.style.color=this.color,(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_translateEmpty(e,n){this._uiManager.translateSelectedEditors(e,n,!0)}getInitialTranslation(){const e=this.parentScale;return[-De._internalPadding*e,-(De._internalPadding+o(this,Ks))*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),w(this,bc,new AbortController);const e=this._uiManager.combinedSignal(o(this,bc));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){var e;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",o(this,tg)),this._isDraggable=!0,(e=o(this,bc))==null||e.abort(),w(this,bc,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){var n;this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),(n=this._initialOptions)!=null&&n.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=o(this,Ys),n=w(this,Ys,x(this,un,IE).call(this).trimEnd());if(e===n)return;const r=a=>{if(w(this,Ys,a),!a){this.remove();return}x(this,un,uy).call(this),this._uiManager.rebuild(this),x(this,un,ly).call(this)};this.addCommands({cmd:()=>{r(n)},undo:()=>{r(e)},mustExec:!1}),x(this,un,ly).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){De._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,n;(this._isCopy||this.annotationElementId)&&(e=this.x,n=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",o(this,tg)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:r}=this.editorDiv;if(r.fontSize=`calc(${o(this,Ks)}px * var(--total-scale-factor))`,r.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:u}=this._initialData;let[h,f]=this.getInitialTranslation();[h,f]=this.pageTranslationToScreen(h,f);const[p,y]=this.pageDimensions,[v,S]=this.pageTranslation;let C,E;switch(this.rotation){case 0:C=e+(u[0]-v)/p,E=n+this.height-(u[1]-S)/y;break;case 90:C=e+(u[0]-v)/p,E=n-(u[1]-S)/y,[h,f]=[f,-h];break;case 180:C=e-this.width+(u[0]-v)/p,E=n-(u[1]-S)/y,[h,f]=[-h,-f];break;case 270:C=e+(u[0]-v-this.height*y)/p,E=n+(u[1]-S-this.width*p)/y,[h,f]=[-f,h];break}this.setAt(C*a,E*l,h,f)}else this._moveAfterPaste(e,n);x(this,un,uy).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(e){var C,E,k;const n=e.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]==="text/plain")return;e.preventDefault();const a=x(C=De,Io,uA).call(C,n.getData("text")||"").replaceAll(jm,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const u=l.getRangeAt(0);if(!a.includes(`
`)){u.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:h,startOffset:f}=u,p=[],y=[];if(h.nodeType===Node.TEXT_NODE){const T=h.parentElement;if(y.push(h.nodeValue.slice(f).replaceAll(jm,"")),T!==this.editorDiv){let L=p;for(const P of this.editorDiv.childNodes){if(P===T){L=y;continue}L.push(x(E=De,Io,cy).call(E,P))}}p.push(h.nodeValue.slice(0,f).replaceAll(jm,""))}else if(h===this.editorDiv){let T=p,L=0;for(const P of this.editorDiv.childNodes)L++===f&&(T=y),T.push(x(k=De,Io,cy).call(k,P))}w(this,Ys,`${p.join(`
`)}${a}${y.join(`
`)}`),x(this,un,uy).call(this);const v=new Range;let S=Math.sumPrecise(p.map(T=>T.length));for(const{firstChild:T}of this.editorDiv.childNodes)if(T.nodeType===Node.TEXT_NODE){const L=T.nodeValue.length;if(S<=L){v.setStart(T,S),v.setEnd(T,S);break}S-=L}l.removeAllRanges(),l.addRange(v)}get contentDiv(){return this.editorDiv}getPDFRect(){const e=De._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,n,r){var u;let a=null;if(e instanceof PE){const{data:{defaultAppearanceData:{fontSize:h,fontColor:f},rect:p,rotation:y,id:v,popupRef:S,richText:C,contentsObj:E,creationDate:k,modificationDate:T},textContent:L,textPosition:P,parent:{page:{pageNumber:M}}}=e;if(!L||L.length===0)return null;a=e={annotationType:jt.FREETEXT,color:Array.from(f),fontSize:h,value:L.join(`
`),position:P,pageIndex:M-1,rect:p.slice(0),rotation:y,annotationElementId:v,id:v,deleted:!1,popupRef:S,comment:(E==null?void 0:E.str)||null,richText:C,creationDate:k,modificationDate:T}}const l=await super.deserialize(e,n,r);return w(l,Ks,e.fontSize),l.color=at.makeHexColor(...e.color),w(l,Ys,x(u=De,Io,uA).call(u,e.value)),l._initialData=a,e.comment&&l.setCommentData(e),l}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Re._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),r=Object.assign(super.serialize(e),{color:n,fontSize:o(this,Ks),value:x(this,un,FE).call(this)});return this.addComment(r),e?(r.isCopy=!0,r):this.annotationElementId&&!x(this,un,OE).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){const n=super.renderAnnotationElement(e);if(!n)return null;const{style:r}=n;r.fontSize=`calc(${o(this,Ks)}px * var(--total-scale-factor))`,r.color=this.color,n.replaceChildren();for(const a of o(this,Ys).split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),n.append(l)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:o(this,Ys)}}),n}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}};Ys=new WeakMap,tg=new WeakMap,bc=new WeakMap,Ks=new WeakMap,un=new WeakSet,DE=function(e){const n=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-o(this,Ks))*this.parentScale),w(this,Ks,a),x(this,un,ly).call(this)},r=o(this,Ks);this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},NE=function(e){const n=a=>{this.color=a,this.onUpdatedColor()},r=this.color;this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},IE=function(){var r;const e=[];this.editorDiv.normalize();let n=null;for(const a of this.editorDiv.childNodes)(n==null?void 0:n.nodeType)===Node.TEXT_NODE&&a.nodeName==="BR"||(e.push(x(r=De,Io,cy).call(r,a)),n=a);return e.join(`
`)},ly=function(){const[e,n]=this.parentDimensions;let r;if(this.isAttachedToDOM)r=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,u=l.style.display,h=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),r=l.getBoundingClientRect(),l.remove(),l.style.display=u,l.classList.toggle("hidden",h)}this.rotation%180===this.parentRotation%180?(this.width=r.width/e,this.height=r.height/n):(this.width=r.height/e,this.height=r.width/n),this.fixAndSetPosition()},Io=new WeakSet,cy=function(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(jm,"")},uy=function(){if(this.editorDiv.replaceChildren(),!!o(this,Ys))for(const e of o(this,Ys).split(`
`)){const n=document.createElement("div");n.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(n)}},FE=function(){return o(this,Ys).replaceAll(""," ")},uA=function(e){return e.replaceAll(" ","")},OE=function(e){const{value:n,fontSize:r,color:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==n||e.fontSize!==r||e.color.some((u,h)=>u!==a[h])||e.pageIndex!==l},b(De,Io),K(De,"_freeTextDefaultContent",""),K(De,"_internalPadding",0),K(De,"_defaultColor",null),K(De,"_defaultFontSize",10),K(De,"_type","freetext"),K(De,"_editorType",jt.FREETEXT);let cA=De;class ft{toSVGPath(){Ee("Abstract method `toSVGPath` must be implemented.")}get box(){Ee("Abstract getter `box` must be implemented.")}serialize(t,e){Ee("Abstract method `serialize` must be implemented.")}static _rescale(t,e,n,r,a,l){l||(l=new Float32Array(t.length));for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u]*r,l[u+1]=n+t[u+1]*a;return l}static _rescaleAndSwap(t,e,n,r,a,l){l||(l=new Float32Array(t.length));for(let u=0,h=t.length;u<h;u+=2)l[u]=e+t[u+1]*r,l[u+1]=n+t[u]*a;return l}static _translate(t,e,n,r){r||(r=new Float32Array(t.length));for(let a=0,l=t.length;a<l;a+=2)r[a]=e+t[a],r[a+1]=n+t[a+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,n,r,a){switch(a){case 90:return[1-e/n,t/r];case 180:return[1-t/n,1-e/r];case 270:return[e/n,1-t/r];default:return[t/n,e/r]}}static _normalizePagePoint(t,e,n){switch(n){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,n,r,a,l){return[(t+5*n)/6,(e+5*r)/6,(5*n+a)/6,(5*r+l)/6,(n+a)/2,(r+l)/2]}}K(ft,"PRECISION",1e-4);var Qs,Yi,Bh,Uh,_r,qt,xc,Ec,eg,ng,zh,jh,Wa,sg,Qy,Zy,vn,vf,BE,UE,zE,jE,HE,$E;const Kr=class Kr{constructor({x:t,y:e},n,r,a,l,u=0){b(this,vn);b(this,Qs);b(this,Yi,[]);b(this,Bh);b(this,Uh);b(this,_r,[]);b(this,qt,new Float32Array(18));b(this,xc);b(this,Ec);b(this,eg);b(this,ng);b(this,zh);b(this,jh);b(this,Wa,[]);w(this,Qs,n),w(this,jh,a*r),w(this,Uh,l),o(this,qt).set([NaN,NaN,NaN,NaN,t,e],6),w(this,Bh,u),w(this,ng,o(Kr,sg)*r),w(this,eg,o(Kr,Zy)*r),w(this,zh,r),o(this,Wa).push(t,e)}isEmpty(){return isNaN(o(this,qt)[8])}add({x:t,y:e}){var G;w(this,xc,t),w(this,Ec,e);const[n,r,a,l]=o(this,Qs);let[u,h,f,p]=o(this,qt).subarray(8,12);const y=t-f,v=e-p,S=Math.hypot(y,v);if(S<o(this,eg))return!1;const C=S-o(this,ng),E=C/S,k=E*y,T=E*v;let L=u,P=h;u=f,h=p,f+=k,p+=T,(G=o(this,Wa))==null||G.push(t,e);const M=-T/C,D=k/C,I=M*o(this,jh),U=D*o(this,jh);return o(this,qt).set(o(this,qt).subarray(2,8),0),o(this,qt).set([f+I,p+U],4),o(this,qt).set(o(this,qt).subarray(14,18),12),o(this,qt).set([f-I,p-U],16),isNaN(o(this,qt)[6])?(o(this,_r).length===0&&(o(this,qt).set([u+I,h+U],2),o(this,_r).push(NaN,NaN,NaN,NaN,(u+I-n)/a,(h+U-r)/l),o(this,qt).set([u-I,h-U],14),o(this,Yi).push(NaN,NaN,NaN,NaN,(u-I-n)/a,(h-U-r)/l)),o(this,qt).set([L,P,u,h,f,p],6),!this.isEmpty()):(o(this,qt).set([L,P,u,h,f,p],6),Math.abs(Math.atan2(P-h,L-u)-Math.atan2(T,k))<Math.PI/2?([u,h,f,p]=o(this,qt).subarray(2,6),o(this,_r).push(NaN,NaN,NaN,NaN,((u+f)/2-n)/a,((h+p)/2-r)/l),[u,h,L,P]=o(this,qt).subarray(14,18),o(this,Yi).push(NaN,NaN,NaN,NaN,((L+u)/2-n)/a,((P+h)/2-r)/l),!0):([L,P,u,h,f,p]=o(this,qt).subarray(0,6),o(this,_r).push(((L+5*u)/6-n)/a,((P+5*h)/6-r)/l,((5*u+f)/6-n)/a,((5*h+p)/6-r)/l,((u+f)/2-n)/a,((h+p)/2-r)/l),[f,p,u,h,L,P]=o(this,qt).subarray(12,18),o(this,Yi).push(((L+5*u)/6-n)/a,((P+5*h)/6-r)/l,((5*u+f)/6-n)/a,((5*h+p)/6-r)/l,((u+f)/2-n)/a,((h+p)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=o(this,_r),e=o(this,Yi);if(isNaN(o(this,qt)[6])&&!this.isEmpty())return x(this,vn,BE).call(this);const n=[];n.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?n.push(`L${t[r+4]} ${t[r+5]}`):n.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);x(this,vn,zE).call(this,n);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?n.push(`L${e[r+4]} ${e[r+5]}`):n.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return x(this,vn,UE).call(this,n),n.join(" ")}newFreeDrawOutline(t,e,n,r,a,l){return new WE(t,e,n,r,a,l)}getOutlines(){var y;const t=o(this,_r),e=o(this,Yi),n=o(this,qt),[r,a,l,u]=o(this,Qs),h=new Float32Array((((y=o(this,Wa))==null?void 0:y.length)??0)+2);for(let v=0,S=h.length-2;v<S;v+=2)h[v]=(o(this,Wa)[v]-r)/l,h[v+1]=(o(this,Wa)[v+1]-a)/u;if(h[h.length-2]=(o(this,xc)-r)/l,h[h.length-1]=(o(this,Ec)-a)/u,isNaN(n[6])&&!this.isEmpty())return x(this,vn,jE).call(this,h);const f=new Float32Array(o(this,_r).length+24+o(this,Yi).length);let p=t.length;for(let v=0;v<p;v+=2){if(isNaN(t[v])){f[v]=f[v+1]=NaN;continue}f[v]=t[v],f[v+1]=t[v+1]}p=x(this,vn,$E).call(this,f,p);for(let v=e.length-6;v>=6;v-=6)for(let S=0;S<6;S+=2){if(isNaN(e[v+S])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[v+S],f[p+1]=e[v+S+1],p+=2}return x(this,vn,HE).call(this,f,p),this.newFreeDrawOutline(f,h,o(this,Qs),o(this,zh),o(this,Bh),o(this,Uh))}};Qs=new WeakMap,Yi=new WeakMap,Bh=new WeakMap,Uh=new WeakMap,_r=new WeakMap,qt=new WeakMap,xc=new WeakMap,Ec=new WeakMap,eg=new WeakMap,ng=new WeakMap,zh=new WeakMap,jh=new WeakMap,Wa=new WeakMap,sg=new WeakMap,Qy=new WeakMap,Zy=new WeakMap,vn=new WeakSet,vf=function(){const t=o(this,qt).subarray(4,6),e=o(this,qt).subarray(16,18),[n,r,a,l]=o(this,Qs);return[(o(this,xc)+(t[0]-e[0])/2-n)/a,(o(this,Ec)+(t[1]-e[1])/2-r)/l,(o(this,xc)+(e[0]-t[0])/2-n)/a,(o(this,Ec)+(e[1]-t[1])/2-r)/l]},BE=function(){const[t,e,n,r]=o(this,Qs),[a,l,u,h]=x(this,vn,vf).call(this);return`M${(o(this,qt)[2]-t)/n} ${(o(this,qt)[3]-e)/r} L${(o(this,qt)[4]-t)/n} ${(o(this,qt)[5]-e)/r} L${a} ${l} L${u} ${h} L${(o(this,qt)[16]-t)/n} ${(o(this,qt)[17]-e)/r} L${(o(this,qt)[14]-t)/n} ${(o(this,qt)[15]-e)/r} Z`},UE=function(t){const e=o(this,Yi);t.push(`L${e[4]} ${e[5]} Z`)},zE=function(t){const[e,n,r,a]=o(this,Qs),l=o(this,qt).subarray(4,6),u=o(this,qt).subarray(16,18),[h,f,p,y]=x(this,vn,vf).call(this);t.push(`L${(l[0]-e)/r} ${(l[1]-n)/a} L${h} ${f} L${p} ${y} L${(u[0]-e)/r} ${(u[1]-n)/a}`)},jE=function(t){const e=o(this,qt),[n,r,a,l]=o(this,Qs),[u,h,f,p]=x(this,vn,vf).call(this),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-n)/a,(e[3]-r)/l,NaN,NaN,NaN,NaN,(e[4]-n)/a,(e[5]-r)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-n)/a,(e[17]-r)/l,NaN,NaN,NaN,NaN,(e[14]-n)/a,(e[15]-r)/l],0),this.newFreeDrawOutline(y,t,o(this,Qs),o(this,zh),o(this,Bh),o(this,Uh))},HE=function(t,e){const n=o(this,Yi);return t.set([NaN,NaN,NaN,NaN,n[4],n[5]],e),e+=6},$E=function(t,e){const n=o(this,qt).subarray(4,6),r=o(this,qt).subarray(16,18),[a,l,u,h]=o(this,Qs),[f,p,y,v]=x(this,vn,vf).call(this);return t.set([NaN,NaN,NaN,NaN,(n[0]-a)/u,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,v,NaN,NaN,NaN,NaN,(r[0]-a)/u,(r[1]-l)/h],e),e+=24},b(Kr,sg,8),b(Kr,Qy,2),b(Kr,Zy,o(Kr,sg)+o(Kr,Qy));let Dy=Kr;var Hh,Cc,Co,ig,Zs,rg,sn,Jy,VE;class WE extends ft{constructor(e,n,r,a,l,u){super();b(this,Jy);b(this,Hh);b(this,Cc,new Float32Array(4));b(this,Co);b(this,ig);b(this,Zs);b(this,rg);b(this,sn);w(this,sn,e),w(this,Zs,n),w(this,Hh,r),w(this,rg,a),w(this,Co,l),w(this,ig,u),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],x(this,Jy,VE).call(this,u);const[h,f,p,y]=o(this,Cc);for(let v=0,S=e.length;v<S;v+=2)e[v]=(e[v]-h)/p,e[v+1]=(e[v+1]-f)/y;for(let v=0,S=n.length;v<S;v+=2)n[v]=(n[v]-h)/p,n[v+1]=(n[v+1]-f)/y}toSVGPath(){const e=[`M${o(this,sn)[4]} ${o(this,sn)[5]}`];for(let n=6,r=o(this,sn).length;n<r;n+=6){if(isNaN(o(this,sn)[n])){e.push(`L${o(this,sn)[n+4]} ${o(this,sn)[n+5]}`);continue}e.push(`C${o(this,sn)[n]} ${o(this,sn)[n+1]} ${o(this,sn)[n+2]} ${o(this,sn)[n+3]} ${o(this,sn)[n+4]} ${o(this,sn)[n+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,n,r,a],l){const u=r-e,h=a-n;let f,p;switch(l){case 0:f=ft._rescale(o(this,sn),e,a,u,-h),p=ft._rescale(o(this,Zs),e,a,u,-h);break;case 90:f=ft._rescaleAndSwap(o(this,sn),e,n,u,h),p=ft._rescaleAndSwap(o(this,Zs),e,n,u,h);break;case 180:f=ft._rescale(o(this,sn),r,n,-u,h),p=ft._rescale(o(this,Zs),r,n,-u,h);break;case 270:f=ft._rescaleAndSwap(o(this,sn),r,a,-u,-h),p=ft._rescaleAndSwap(o(this,Zs),r,a,-u,-h);break}return{outline:Array.from(f),points:[Array.from(p)]}}get box(){return o(this,Cc)}newOutliner(e,n,r,a,l,u=0){return new Dy(e,n,r,a,l,u)}getNewOutline(e,n){const[r,a,l,u]=o(this,Cc),[h,f,p,y]=o(this,Hh),v=l*p,S=u*y,C=r*p+h,E=a*y+f,k=this.newOutliner({x:o(this,Zs)[0]*v+C,y:o(this,Zs)[1]*S+E},o(this,Hh),o(this,rg),e,o(this,ig),n??o(this,Co));for(let T=2;T<o(this,Zs).length;T+=2)k.add({x:o(this,Zs)[T]*v+C,y:o(this,Zs)[T+1]*S+E});return k.getOutlines()}}Hh=new WeakMap,Cc=new WeakMap,Co=new WeakMap,ig=new WeakMap,Zs=new WeakMap,rg=new WeakMap,sn=new WeakMap,Jy=new WeakSet,VE=function(e){const n=o(this,sn);let r=n[4],a=n[5];const l=[r,a,r,a];let u=r,h=a,f=r,p=a;const y=e?Math.max:Math.min,v=new Float32Array(4);for(let C=6,E=n.length;C<E;C+=6){const k=n[C+4],T=n[C+5];isNaN(n[C])?(at.pointBoundingBox(k,T,l),h>T?(u=k,h=T):h===T&&(u=y(u,k)),p<T?(f=k,p=T):p===T&&(f=y(f,k))):(v[0]=v[1]=1/0,v[2]=v[3]=-1/0,at.bezierBoundingBox(r,a,...n.slice(C,C+6),v),at.rectBoundingBox(v[0],v[1],v[2],v[3],l),h>v[1]?(u=v[0],h=v[1]):h===v[1]&&(u=y(u,v[0])),p<v[3]?(f=v[2],p=v[3]):p===v[3]&&(f=y(f,v[2]))),r=k,a=T}const S=o(this,Cc);S[0]=l[0]-o(this,Co),S[1]=l[1]-o(this,Co),S[2]=l[2]-l[0]+2*o(this,Co),S[3]=l[3]-l[1]+2*o(this,Co),this.firstPoint=[u,h],this.lastPoint=[f,p]};var og,ag,lg,Va,Ki,fs,GE,hy,XE,qE,dA;class hA{constructor(t,e=0,n=0,r=!0){b(this,fs);b(this,og);b(this,ag);b(this,lg);b(this,Va,[]);b(this,Ki,[]);const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:E,y:k,width:T,height:L}of t){const P=Math.floor((E-e)/l)*l,M=Math.ceil((E+T+e)/l)*l,D=Math.floor((k-e)/l)*l,I=Math.ceil((k+L+e)/l)*l,U=[P,D,I,!0],$=[M,D,I,!1];o(this,Va).push(U,$),at.rectBoundingBox(P,D,M,I,a)}const u=a[2]-a[0]+2*n,h=a[3]-a[1]+2*n,f=a[0]-n,p=a[1]-n;let y=r?-1/0:1/0,v=1/0;const S=o(this,Va).at(r?-1:-2),C=[S[0],S[2]];for(const E of o(this,Va)){const[k,T,L,P]=E;!P&&r?T<v?(v=T,y=k):T===v&&(y=Math.max(y,k)):P&&!r&&(T<v?(v=T,y=k):T===v&&(y=Math.min(y,k))),E[0]=(k-f)/u,E[1]=(T-p)/h,E[2]=(L-p)/h}w(this,og,new Float32Array([f,p,u,h])),w(this,ag,[y,v]),w(this,lg,C)}getOutlines(){o(this,Va).sort((e,n)=>e[0]-n[0]||e[1]-n[1]||e[2]-n[2]);const t=[];for(const e of o(this,Va))e[3]?(t.push(...x(this,fs,dA).call(this,e)),x(this,fs,XE).call(this,e)):(x(this,fs,qE).call(this,e),t.push(...x(this,fs,dA).call(this,e)));return x(this,fs,GE).call(this,t)}}og=new WeakMap,ag=new WeakMap,lg=new WeakMap,Va=new WeakMap,Ki=new WeakMap,fs=new WeakSet,GE=function(t){const e=[],n=new Set;for(const l of t){const[u,h,f]=l;e.push([u,h,l],[u,f,l])}e.sort((l,u)=>l[1]-u[1]||l[0]-u[0]);for(let l=0,u=e.length;l<u;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const r=[];let a;for(;n.size>0;){const l=n.values().next().value;let[u,h,f,p,y]=l;n.delete(l);let v=u,S=h;for(a=[u,f],r.push(a);;){let C;if(n.has(p))C=p;else if(n.has(y))C=y;else break;n.delete(C),[u,h,f,p,y]=C,v!==u&&(a.push(v,S,u,S===h?h:f),v=u),S=S===h?f:h}a.push(v,S)}return new uP(r,o(this,og),o(this,ag),o(this,lg))},hy=function(t){const e=o(this,Ki);let n=0,r=e.length-1;for(;n<=r;){const a=n+r>>1,l=e[a][0];if(l===t)return a;l<t?n=a+1:r=a-1}return r+1},XE=function([,t,e]){const n=x(this,fs,hy).call(this,t);o(this,Ki).splice(n,0,[t,e])},qE=function([,t,e]){const n=x(this,fs,hy).call(this,t);for(let r=n;r<o(this,Ki).length;r++){const[a,l]=o(this,Ki)[r];if(a!==t)break;if(a===t&&l===e){o(this,Ki).splice(r,1);return}}for(let r=n-1;r>=0;r--){const[a,l]=o(this,Ki)[r];if(a!==t)break;if(a===t&&l===e){o(this,Ki).splice(r,1);return}}},dA=function(t){const[e,n,r]=t,a=[[e,n,r]],l=x(this,fs,hy).call(this,r);for(let u=0;u<l;u++){const[h,f]=o(this,Ki)[u];for(let p=0,y=a.length;p<y;p++){const[,v,S]=a[p];if(!(f<=v||S<=h)){if(v>=h){if(S>f)a[p][1]=f;else{if(y===1)return[];a.splice(p,1),p--,y--}continue}a[p][2]=h,S>f&&a.push([e,f,S])}}}return a};var cg,$h;class uP extends ft{constructor(e,n,r,a){super();b(this,cg);b(this,$h);w(this,$h,e),w(this,cg,n),this.firstPoint=r,this.lastPoint=a}toSVGPath(){const e=[];for(const n of o(this,$h)){let[r,a]=n;e.push(`M${r} ${a}`);for(let l=2;l<n.length;l+=2){const u=n[l],h=n[l+1];u===r?(e.push(`V${h}`),a=h):h===a&&(e.push(`H${u}`),r=u)}e.push("Z")}return e.join(" ")}serialize([e,n,r,a],l){const u=[],h=r-e,f=a-n;for(const p of o(this,$h)){const y=new Array(p.length);for(let v=0;v<p.length;v+=2)y[v]=e+p[v]*h,y[v+1]=a-p[v+1]*f;u.push(y)}return u}get box(){return o(this,cg)}get classNamesForOutlining(){return["highlightOutline"]}}cg=new WeakMap,$h=new WeakMap;class fA extends Dy{newFreeDrawOutline(t,e,n,r,a,l){return new hP(t,e,n,r,a,l)}}class hP extends WE{newOutliner(t,e,n,r,a,l=0){return new fA(t,e,n,r,a,l)}}var Wh,ug,_o,_c,hg,Ts,dg,fg,kc,Js,ti,Bn,Vh,Gh,ts,Xh,_i,pg,$t,pA,dy,YE,KE,QE,gA,bl,Ti,Eu,ZE,fy,py,JE,tC,eC,nC,sC;const oe=class oe extends Re{constructor(e){super({...e,name:"highlightEditor"});b(this,$t);b(this,Wh,null);b(this,ug,0);b(this,_o);b(this,_c,null);b(this,hg,null);b(this,Ts,null);b(this,dg,null);b(this,fg,0);b(this,kc,null);b(this,Js,null);b(this,ti,null);b(this,Bn,!1);b(this,Vh,null);b(this,Gh,null);b(this,ts,null);b(this,Xh,"");b(this,_i);b(this,pg,"");this.color=e.color||oe._defaultColor,w(this,_i,e.thickness||oe._defaultThickness),this.opacity=e.opacity||oe._defaultOpacity,w(this,_o,e.boxes||null),w(this,pg,e.methodOfCreation||""),w(this,Xh,e.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(w(this,Bn,!0),x(this,$t,dy).call(this,e),x(this,$t,bl).call(this)):o(this,_o)&&(w(this,Wh,e.anchorNode),w(this,ug,e.anchorOffset),w(this,dg,e.focusNode),w(this,fg,e.focusOffset),x(this,$t,pA).call(this),x(this,$t,bl).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const e=oe.prototype;return Ut(this,"_keyboardManager",new bg([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:o(this,Bn)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:o(this,_i),methodOfCreation:o(this,pg)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}static initialize(e,n){var r;Re.initialize(e,n),oe._defaultColor||(oe._defaultColor=((r=n.highlightColors)==null?void 0:r.values().next().value)||"#fff066")}static updateDefaultParams(e,n){switch(e){case Qt.HIGHLIGHT_COLOR:oe._defaultColor=n;break;case Qt.HIGHLIGHT_THICKNESS:oe._defaultThickness=n;break}}translateInPage(e,n){}get toolbarPosition(){return o(this,Gh)}get commentButtonPosition(){return o(this,Vh)}updateParams(e,n){switch(e){case Qt.HIGHLIGHT_COLOR:x(this,$t,YE).call(this,n);break;case Qt.HIGHLIGHT_THICKNESS:x(this,$t,KE).call(this,n);break}}static get defaultPropertiesToUpdate(){return[[Qt.HIGHLIGHT_COLOR,oe._defaultColor],[Qt.HIGHLIGHT_THICKNESS,oe._defaultThickness]]}get propertiesToUpdate(){return[[Qt.HIGHLIGHT_COLOR,this.color||oe._defaultColor],[Qt.HIGHLIGHT_THICKNESS,o(this,_i)||oe._defaultThickness],[Qt.HIGHLIGHT_FREE,o(this,Bn)]]}onUpdatedColor(){var e,n;(e=this.parent)==null||e.drawLayer.updateProperties(o(this,ti),{root:{fill:this.color,"fill-opacity":this.opacity}}),(n=o(this,hg))==null||n.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",w(this,hg,new Ry({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(x(this,$t,py).call(this))}getBaseTranslation(){return[0,0]}getRect(e,n){return super.getRect(e,n,x(this,$t,py).call(this))}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){x(this,$t,gA).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,$t,bl).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var r;let n=!1;this.parent&&!e?x(this,$t,gA).call(this):e&&(x(this,$t,bl).call(this,e),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(e),this.show(this._isVisible),n&&this.select()}rotate(e){var a,l,u;const{drawLayer:n}=this.parent;let r;o(this,Bn)?(e=(e-this.rotation+360)%360,r=x(a=oe,Ti,Eu).call(a,o(this,Js).box,e)):r=x(l=oe,Ti,Eu).call(l,[this.x,this.y,this.width,this.height],e),n.updateProperties(o(this,ti),{bbox:r,root:{"data-main-rotation":e}}),n.updateProperties(o(this,ts),{bbox:x(u=oe,Ti,Eu).call(u,o(this,Ts).box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();o(this,Xh)&&(e.setAttribute("aria-label",o(this,Xh)),e.setAttribute("role","mark")),o(this,Bn)?e.classList.add("free"):this.div.addEventListener("keydown",x(this,$t,ZE).bind(this),{signal:this._uiManager._signal});const n=w(this,kc,document.createElement("div"));return e.append(n),n.setAttribute("aria-hidden","true"),n.className="internal",n.style.clipPath=o(this,_c),this.setDims(),bx(this,o(this,kc),["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,ts),{rootClass:{hovered:!0}})}pointerleave(){var e;this.isSelected||(e=this.parent)==null||e.drawLayer.updateProperties(o(this,ts),{rootClass:{hovered:!1}})}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:x(this,$t,fy).call(this,!0);break;case 1:case 3:x(this,$t,fy).call(this,!1);break}}select(){var e;super.select(),o(this,ts)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,ts),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var e;super.unselect(),o(this,ts)&&((e=this.parent)==null||e.drawLayer.updateProperties(o(this,ts),{rootClass:{selected:!1}}),o(this,Bn)||x(this,$t,fy).call(this,!1))}get _mustFixPosition(){return!o(this,Bn)}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(o(this,ti),{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(o(this,ts),{rootClass:{hidden:!e}}))}static startHighlighting(e,n,{target:r,x:a,y:l}){const{x:u,y:h,width:f,height:p}=r.getBoundingClientRect(),y=new AbortController,v=e.combinedSignal(y),S=C=>{y.abort(),x(this,Ti,nC).call(this,e,C)};window.addEventListener("blur",S,{signal:v}),window.addEventListener("pointerup",S,{signal:v}),window.addEventListener("pointerdown",Qe,{capture:!0,passive:!1,signal:v}),window.addEventListener("contextmenu",Ri,{signal:v}),r.addEventListener("pointermove",x(this,Ti,eC).bind(this,e),{signal:v}),this._freeHighlight=new fA({x:a,y:l},[u,h,f,p],e.scale,this._defaultThickness/2,n,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(e,n,r){var E,k,T,L;let a=null;if(e instanceof LE){const{data:{quadPoints:P,rect:M,rotation:D,id:I,color:U,opacity:$,popupRef:G,richText:nt,contentsObj:et,creationDate:Ct,modificationDate:_t},parent:{page:{pageNumber:wt}}}=e;a=e={annotationType:jt.HIGHLIGHT,color:Array.from(U),opacity:$,quadPoints:P,boxes:null,pageIndex:wt-1,rect:M.slice(0),rotation:D,annotationElementId:I,id:I,deleted:!1,popupRef:G,richText:nt,comment:(et==null?void 0:et.str)||null,creationDate:Ct,modificationDate:_t}}else if(e instanceof WA){const{data:{inkLists:P,rect:M,rotation:D,id:I,color:U,borderStyle:{rawWidth:$},popupRef:G,richText:nt,contentsObj:et,creationDate:Ct,modificationDate:_t},parent:{page:{pageNumber:wt}}}=e;a=e={annotationType:jt.HIGHLIGHT,color:Array.from(U),thickness:$,inkLists:P,boxes:null,pageIndex:wt-1,rect:M.slice(0),rotation:D,annotationElementId:I,id:I,deleted:!1,popupRef:G,richText:nt,comment:(et==null?void 0:et.str)||null,creationDate:Ct,modificationDate:_t}}const{color:l,quadPoints:u,inkLists:h,opacity:f}=e,p=await super.deserialize(e,n,r);p.color=at.makeHexColor(...l),p.opacity=f||1,h&&w(p,_i,e.thickness),p._initialData=a,e.comment&&p.setCommentData(e);const[y,v]=p.pageDimensions,[S,C]=p.pageTranslation;if(u){const P=w(p,_o,[]);for(let M=0;M<u.length;M+=8)P.push({x:(u[M]-S)/y,y:1-(u[M+1]-C)/v,width:(u[M+2]-u[M])/y,height:(u[M+1]-u[M+5])/v});x(E=p,$t,pA).call(E),x(k=p,$t,bl).call(k),p.rotate(p.rotation)}else if(h){w(p,Bn,!0);const P=h[0],M={x:P[0]-S,y:v-(P[1]-C)},D=new fA(M,[0,0,y,v],1,o(p,_i)/2,!0,.001);for(let $=0,G=P.length;$<G;$+=2)M.x=P[$]-S,M.y=v-(P[$+1]-C),D.add(M);const{id:I,clipPathId:U}=n.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:p.color,"fill-opacity":p._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:D.toSVGPath()}},!0,!0);x(T=p,$t,dy).call(T,{highlightOutlines:D.getOutlines(),highlightId:I,clipPathId:U}),x(L=p,$t,bl).call(L),p.rotate(p.parentRotation)}return p}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const n=Re._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r=super.serialize(e);return Object.assign(r,{color:n,opacity:this.opacity,thickness:o(this,_i),quadPoints:x(this,$t,JE).call(this),outlines:x(this,$t,tC).call(this,r.rect)}),this.addComment(r),this.annotationElementId&&!x(this,$t,sC).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};Wh=new WeakMap,ug=new WeakMap,_o=new WeakMap,_c=new WeakMap,hg=new WeakMap,Ts=new WeakMap,dg=new WeakMap,fg=new WeakMap,kc=new WeakMap,Js=new WeakMap,ti=new WeakMap,Bn=new WeakMap,Vh=new WeakMap,Gh=new WeakMap,ts=new WeakMap,Xh=new WeakMap,_i=new WeakMap,pg=new WeakMap,$t=new WeakSet,pA=function(){const e=new hA(o(this,_o),.001);w(this,Js,e.getOutlines()),[this.x,this.y,this.width,this.height]=o(this,Js).box;const n=new hA(o(this,_o),.0025,.001,this._uiManager.direction==="ltr");w(this,Ts,n.getOutlines());const{firstPoint:r}=o(this,Js);w(this,Vh,[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]);const{lastPoint:a}=o(this,Ts);w(this,Gh,[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height])},dy=function({highlightOutlines:e,highlightId:n,clipPathId:r}){var v,S;if(w(this,Js,e),w(this,Ts,e.getNewOutline(o(this,_i)/2+1.5,.0025)),n>=0)w(this,ti,n),w(this,_c,r),this.parent.drawLayer.finalizeDraw(n,{bbox:e.box,path:{d:e.toSVGPath()}}),w(this,ts,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:o(this,Ts).box,path:{d:o(this,Ts).toSVGPath()}},!0));else if(this.parent){const C=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(o(this,ti),{bbox:x(v=oe,Ti,Eu).call(v,o(this,Js).box,(C-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(o(this,ts),{bbox:x(S=oe,Ti,Eu).call(S,o(this,Ts).box,C),path:{d:o(this,Ts).toSVGPath()}})}const[l,u,h,f]=e.box;switch(this.rotation){case 0:this.x=l,this.y=u,this.width=h,this.height=f;break;case 90:{const[C,E]=this.parentDimensions;this.x=u,this.y=1-l,this.width=h*E/C,this.height=f*C/E;break}case 180:this.x=1-l,this.y=1-u,this.width=h,this.height=f;break;case 270:{const[C,E]=this.parentDimensions;this.x=1-u,this.y=l,this.width=h*E/C,this.height=f*C/E;break}}const{firstPoint:p}=e;w(this,Vh,[(p[0]-l)/h,(p[1]-u)/f]);const{lastPoint:y}=o(this,Ts);w(this,Gh,[(y[0]-l)/h,(y[1]-u)/f])},YE=function(e){const n=(l,u)=>{this.color=l,this.opacity=u,this.onUpdatedColor()},r=this.color,a=this.opacity;this.addCommands({cmd:n.bind(this,e,oe._defaultOpacity),undo:n.bind(this,r,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)},KE=function(e){const n=o(this,_i),r=a=>{w(this,_i,a),x(this,$t,QE).call(this,a)};this.addCommands({cmd:r.bind(this,e),undo:r.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)},QE=function(e){o(this,Bn)&&(x(this,$t,dy).call(this,{highlightOutlines:o(this,Js).getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())},gA=function(){o(this,ti)===null||!this.parent||(this.parent.drawLayer.remove(o(this,ti)),w(this,ti,null),this.parent.drawLayer.remove(o(this,ts)),w(this,ts,null))},bl=function(e=this.parent){o(this,ti)===null&&({id:fn(this,ti)._,clipPathId:fn(this,_c)._}=e.drawLayer.draw({bbox:o(this,Js).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:o(this,Bn)},path:{d:o(this,Js).toSVGPath()}},!1,!0),w(this,ts,e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:o(this,Bn)},bbox:o(this,Ts).box,path:{d:o(this,Ts).toSVGPath()}},o(this,Bn))),o(this,kc)&&(o(this,kc).style.clipPath=o(this,_c)))},Ti=new WeakSet,Eu=function([e,n,r,a],l){switch(l){case 90:return[1-n-a,e,a,r];case 180:return[1-e-r,1-n-a,r,a];case 270:return[n,1-e-r,a,r]}return[e,n,r,a]},ZE=function(e){oe._keyboardManager.exec(this,e)},fy=function(e){if(!o(this,Wh))return;const n=window.getSelection();e?n.setPosition(o(this,Wh),o(this,ug)):n.setPosition(o(this,dg),o(this,fg))},py=function(){return o(this,Bn)?this.rotation:0},JE=function(){if(o(this,Bn))return null;const[e,n]=this.pageDimensions,[r,a]=this.pageTranslation,l=o(this,_o),u=new Float32Array(l.length*8);let h=0;for(const{x:f,y:p,width:y,height:v}of l){const S=f*e+r,C=(1-p)*n+a;u[h]=u[h+4]=S,u[h+1]=u[h+3]=C,u[h+2]=u[h+6]=S+y*e,u[h+5]=u[h+7]=C-v*n,h+=8}return u},tC=function(e){return o(this,Js).serialize(e,x(this,$t,py).call(this))},eC=function(e,n){this._freeHighlight.add(n)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},nC=function(e,n){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(n,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},sC=function(e){const{color:n}=this._initialData;return this.hasEditedComment||e.color.some((r,a)=>r!==n[a])},b(oe,Ti),K(oe,"_defaultColor",null),K(oe,"_defaultOpacity",1),K(oe,"_defaultThickness",12),K(oe,"_type","highlight"),K(oe,"_editorType",jt.HIGHLIGHT),K(oe,"_freeHighlightId",-1),K(oe,"_freeHighlight",null),K(oe,"_freeHighlightClipId","");let Ny=oe;var Tc;class iC{constructor(){b(this,Tc,Object.create(null))}updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,n]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,n)}updateSVGProperty(t,e){o(this,Tc)[t]=e}toSVGProperties(){const t=o(this,Tc);return w(this,Tc,Object.create(null)),{root:t}}reset(){w(this,Tc,Object.create(null))}updateAll(t=this){this.updateProperties(t)}clone(){Ee("Not implemented")}}Tc=new WeakMap;var ei,qh,_n,Pc,Rc,ee,mA,yA,vA,wf,rC,gy,Af,Cu;const Kt=class Kt extends Re{constructor(e){super(e);b(this,ee);b(this,ei,null);b(this,qh);K(this,"_colorPicker",null);K(this,"_drawId",null);w(this,qh,e.mustBeCommitted||!1),this._addOutlines(e)}onUpdatedColor(){var e;(e=this._colorPicker)==null||e.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(x(this,ee,mA).call(this,e),x(this,ee,wf).call(this))}static _mergeSVGProperties(e,n){const r=new Set(Object.keys(e));for(const[a,l]of Object.entries(n))r.has(a)?Object.assign(e[a],l):e[a]=l;return e}static getDefaultDrawingOptions(e){Ee("Not implemented")}static get typesMap(){Ee("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,n){const r=this.typesMap.get(e);r&&this._defaultDrawingOptions.updateProperty(r,n),this._currentParent&&(o(Kt,_n).updateProperty(r,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,n){const r=this.constructor.typesMap.get(e);r&&this._updateProperty(e,r,n)}static get defaultPropertiesToUpdate(){const e=[],n=this._defaultDrawingOptions;for(const[r,a]of this.typesMap)e.push([r,n[a]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:n}=this;for(const[r,a]of this.constructor.typesMap)e.push([r,n[a]]);return e}_updateProperty(e,n,r){const a=this._drawingOptions,l=a[n],u=h=>{var p;a.updateProperty(n,h);const f=o(this,ei).updateProperty(n,h);f&&x(this,ee,Af).call(this,f),(p=this.parent)==null||p.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:u.bind(this,r),undo:u.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Kt._mergeSVGProperties(o(this,ei).getPathResizingSVGProperties(x(this,ee,gy).call(this)),{bbox:x(this,ee,Cu).call(this)}))}_onResized(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Kt._mergeSVGProperties(o(this,ei).getPathResizedSVGProperties(x(this,ee,gy).call(this)),{bbox:x(this,ee,Cu).call(this)}))}_onTranslating(e,n){var r;(r=this.parent)==null||r.drawLayer.updateProperties(this._drawId,{bbox:x(this,ee,Cu).call(this)})}_onTranslated(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,Kt._mergeSVGProperties(o(this,ei).getPathTranslatedSVGProperties(x(this,ee,gy).call(this),this.parentDimensions),{bbox:x(this,ee,Cu).call(this)}))}_onStartDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var e;(e=this.parent)==null||e.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,o(this,qh)&&(w(this,qh,!1),this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){x(this,ee,vA).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(x(this,ee,wf).call(this),x(this,ee,Af).call(this,o(this,ei).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){var r;let n=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),x(this,ee,vA).call(this)):e&&(this._uiManager.addShouldRescale(this),x(this,ee,wf).call(this,e),n=!this.parent&&((r=this.div)==null?void 0:r.classList.contains("selectedEditor"))),super.setParent(e),n&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Kt._mergeSVGProperties({bbox:x(this,ee,Cu).call(this)},o(this,ei).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&x(this,ee,Af).call(this,o(this,ei).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,n;this._isCopy&&(e=this.x,n=this.y);const r=super.render();r.classList.add("draw");const a=document.createElement("div");return r.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,n),r}static createDrawerInstance(e,n,r,a,l){Ee("Not implemented")}static startDrawing(e,n,r,a){var k;const{target:l,offsetX:u,offsetY:h,pointerId:f,pointerType:p}=a;if(Yn.isInitializedAndDifferentPointerType(p))return;const{viewport:{rotation:y}}=e,{width:v,height:S}=l.getBoundingClientRect(),C=w(Kt,Pc,new AbortController),E=e.combinedSignal(C);if(Yn.setPointer(p,f),window.addEventListener("pointerup",T=>{Yn.isSamePointerIdOrRemove(T.pointerId)&&this._endDraw(T)},{signal:E}),window.addEventListener("pointercancel",T=>{Yn.isSamePointerIdOrRemove(T.pointerId)&&this._currentParent.endDrawingSession()},{signal:E}),window.addEventListener("pointerdown",T=>{Yn.isSamePointerType(T.pointerType)&&(Yn.initializeAndAddPointerId(T.pointerId),o(Kt,_n).isCancellable()&&(o(Kt,_n).removeLastElement(),o(Kt,_n).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Ri,{signal:E}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),l.addEventListener("touchmove",T=>{Yn.isSameTimeStamp(T.timeStamp)&&Qe(T)},{signal:E}),e.toggleDrawing(),(k=n._editorUndoBar)==null||k.hide(),o(Kt,_n)){e.drawLayer.updateProperties(this._currentDrawId,o(Kt,_n).startNew(u,h,v,S,y));return}n.updateUIForDefaultProperties(this),w(Kt,_n,this.createDrawerInstance(u,h,v,S,y)),w(Kt,Rc,this.getDefaultDrawingOptions()),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(o(Kt,Rc).toSVGProperties(),o(Kt,_n).defaultSVGProperties),!0,!1)}static _drawMove(e){if(Yn.isSameTimeStamp(e.timeStamp),!o(Kt,_n))return;const{offsetX:n,offsetY:r,pointerId:a}=e;if(Yn.isSamePointerId(a)){if(Yn.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,o(Kt,_n).add(n,r)),Yn.setTimeStamp(e.timeStamp),Qe(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,w(Kt,_n,null),w(Kt,Rc,null),Yn.clearTimeStamp()),o(Kt,Pc)&&(o(Kt,Pc).abort(),w(Kt,Pc,null),Yn.clearPointerIds())}static _endDraw(e){const n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),(e==null?void 0:e.target)===n.div&&n.drawLayer.updateProperties(this._currentDrawId,o(Kt,_n).end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const r=o(Kt,_n),a=this._currentDrawId,l=r.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(a,r.setLastElement(l))},undo:()=>{n.drawLayer.updateProperties(a,r.removeLastElement())},mustExec:!1,type:Qt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(Qt.DRAW_STEP),!o(Kt,_n).isEmpty()){const{pageDimensions:[r,a],scale:l}=n,u=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:o(Kt,_n).getOutlines(r*l,a*l,l,this._INNER_MARGIN),drawingOptions:o(Kt,Rc),mustBeCommitted:!e});return this._cleanup(!0),u}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,n,r,a,l,u){Ee("Not implemented")}static async deserialize(e,n,r){var y,v;const{rawDims:{pageWidth:a,pageHeight:l,pageX:u,pageY:h}}=n.viewport,f=this.deserializeDraw(u,h,a,l,this._INNER_MARGIN,e),p=await super.deserialize(e,n,r);return p.createDrawingOptions(e),x(y=p,ee,mA).call(y,{drawOutlines:f}),x(v=p,ee,wf).call(v),p.onScaleChanging(),p.rotate(),p}serializeDraw(e){const[n,r]=this.pageTranslation,[a,l]=this.pageDimensions;return o(this,ei).serialize([n,r,a,l],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};ei=new WeakMap,qh=new WeakMap,_n=new WeakMap,Pc=new WeakMap,Rc=new WeakMap,ee=new WeakSet,mA=function({drawOutlines:e,drawId:n,drawingOptions:r}){w(this,ei,e),this._drawingOptions||(this._drawingOptions=r),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),n>=0?(this._drawId=n,this.parent.drawLayer.finalizeDraw(n,e.defaultProperties)):this._drawId=x(this,ee,yA).call(this,e,this.parent),x(this,ee,Af).call(this,e.box)},yA=function(e,n){const{id:r}=n.drawLayer.draw(Kt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return r},vA=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},wf=function(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=x(this,ee,yA).call(this,o(this,ei),e)}},rC=function([e,n,r,a]){const{parentDimensions:[l,u],rotation:h}=this;switch(h){case 90:return[n,1-e,r*(u/l),a*(l/u)];case 180:return[1-e,1-n,r,a];case 270:return[1-n,e,r*(u/l),a*(l/u)];default:return[e,n,r,a]}},gy=function(){const{x:e,y:n,width:r,height:a,parentDimensions:[l,u],rotation:h}=this;switch(h){case 90:return[1-n,e,r*(l/u),a*(u/l)];case 180:return[1-e,1-n,r,a];case 270:return[n,1-e,r*(l/u),a*(u/l)];default:return[e,n,r,a]}},Af=function(e){[this.x,this.y,this.width,this.height]=x(this,ee,rC).call(this,e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},Cu=function(){const{x:e,y:n,width:r,height:a,rotation:l,parentRotation:u,parentDimensions:[h,f]}=this;switch((l*4+u)/90){case 1:return[1-n-a,e,a,r];case 2:return[1-e-r,1-n-a,r,a];case 3:return[n,1-e-r,a,r];case 4:return[e,n-r*(h/f),a*(f/h),r*(h/f)];case 5:return[1-n,e,r*(h/f),a*(f/h)];case 6:return[1-e-a*(f/h),1-n,a*(f/h),r*(h/f)];case 7:return[n-r*(h/f),1-e-a*(f/h),r*(h/f),a*(f/h)];case 8:return[e-r,n-a,r,a];case 9:return[1-n,e-r,a,r];case 10:return[1-e,1-n,r,a];case 11:return[n-a,1-e,a,r];case 12:return[e-a*(f/h),n,a*(f/h),r*(h/f)];case 13:return[1-n-r*(h/f),e-a*(f/h),r*(h/f),a*(f/h)];case 14:return[1-e,1-n-r*(h/f),a*(f/h),r*(h/f)];case 15:return[n,1-e,r*(h/f),a*(f/h)];default:return[e,n,r,a]}},K(Kt,"_currentDrawId",-1),K(Kt,"_currentParent",null),b(Kt,_n,null),b(Kt,Pc,null),b(Kt,Rc,null),K(Kt,"_INNER_MARGIN",3);let Iy=Kt;var kr,kn,Tn,Lc,Yh,as,Un,ki,Mc,Dc,Nc,Kh,my;class dP{constructor(t,e,n,r,a,l){b(this,Kh);b(this,kr,new Float64Array(6));b(this,kn);b(this,Tn);b(this,Lc);b(this,Yh);b(this,as);b(this,Un,"");b(this,ki,0);b(this,Mc,new Eg);b(this,Dc);b(this,Nc);w(this,Dc,n),w(this,Nc,r),w(this,Lc,a),w(this,Yh,l),[t,e]=x(this,Kh,my).call(this,t,e);const u=w(this,kn,[NaN,NaN,NaN,NaN,t,e]);w(this,as,[t,e]),w(this,Tn,[{line:u,points:o(this,as)}]),o(this,kr).set(u,0)}updateProperty(t,e){t==="stroke-width"&&w(this,Yh,e)}isEmpty(){return!o(this,Tn)||o(this,Tn).length===0}isCancellable(){return o(this,as).length<=10}add(t,e){[t,e]=x(this,Kh,my).call(this,t,e);const[n,r,a,l]=o(this,kr).subarray(2,6),u=t-a,h=e-l;return Math.hypot(o(this,Dc)*u,o(this,Nc)*h)<=2?null:(o(this,as).push(t,e),isNaN(n)?(o(this,kr).set([a,l,t,e],2),o(this,kn).push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(o(this,kr)[0])&&o(this,kn).splice(6,6),o(this,kr).set([n,r,a,l,t,e],0),o(this,kn).push(...ft.createBezierPoints(n,r,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const n=this.add(t,e);return n||(o(this,as).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,n,r,a){w(this,Dc,n),w(this,Nc,r),w(this,Lc,a),[t,e]=x(this,Kh,my).call(this,t,e);const l=w(this,kn,[NaN,NaN,NaN,NaN,t,e]);w(this,as,[t,e]);const u=o(this,Tn).at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),o(this,Tn).push({line:l,points:o(this,as)}),o(this,kr).set(l,0),w(this,ki,0),this.toSVGPath(),null}getLastElement(){return o(this,Tn).at(-1)}setLastElement(t){return o(this,Tn)?(o(this,Tn).push(t),w(this,kn,t.line),w(this,as,t.points),w(this,ki,0),{path:{d:this.toSVGPath()}}):o(this,Mc).setLastElement(t)}removeLastElement(){if(!o(this,Tn))return o(this,Mc).removeLastElement();o(this,Tn).pop(),w(this,Un,"");for(let t=0,e=o(this,Tn).length;t<e;t++){const{line:n,points:r}=o(this,Tn)[t];w(this,kn,n),w(this,as,r),w(this,ki,0),this.toSVGPath()}return{path:{d:o(this,Un)}}}toSVGPath(){const t=ft.svgRound(o(this,kn)[4]),e=ft.svgRound(o(this,kn)[5]);if(o(this,as).length===2)return w(this,Un,`${o(this,Un)} M ${t} ${e} Z`),o(this,Un);if(o(this,as).length<=6){const r=o(this,Un).lastIndexOf("M");w(this,Un,`${o(this,Un).slice(0,r)} M ${t} ${e}`),w(this,ki,6)}if(o(this,as).length===4){const r=ft.svgRound(o(this,kn)[10]),a=ft.svgRound(o(this,kn)[11]);return w(this,Un,`${o(this,Un)} L ${r} ${a}`),w(this,ki,12),o(this,Un)}const n=[];o(this,ki)===0&&(n.push(`M ${t} ${e}`),w(this,ki,6));for(let r=o(this,ki),a=o(this,kn).length;r<a;r+=6){const[l,u,h,f,p,y]=o(this,kn).slice(r,r+6).map(ft.svgRound);n.push(`C${l} ${u} ${h} ${f} ${p} ${y}`)}return w(this,Un,o(this,Un)+n.join(" ")),w(this,ki,o(this,kn).length),o(this,Un)}getOutlines(t,e,n,r){const a=o(this,Tn).at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),o(this,Mc).build(o(this,Tn),t,e,n,o(this,Lc),o(this,Yh),r),w(this,kr,null),w(this,kn,null),w(this,Tn,null),w(this,Un,null),o(this,Mc)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}kr=new WeakMap,kn=new WeakMap,Tn=new WeakMap,Lc=new WeakMap,Yh=new WeakMap,as=new WeakMap,Un=new WeakMap,ki=new WeakMap,Mc=new WeakMap,Dc=new WeakMap,Nc=new WeakMap,Kh=new WeakSet,my=function(t,e){return ft._normalizePoint(t,e,o(this,Dc),o(this,Nc),o(this,Lc))};var ls,gg,mg,ni,Tr,Pr,Qh,Zh,Ic,jn,qr,oC,aC,lC;class Eg extends ft{constructor(){super(...arguments);b(this,jn);b(this,ls);b(this,gg,0);b(this,mg);b(this,ni);b(this,Tr);b(this,Pr);b(this,Qh);b(this,Zh);b(this,Ic)}build(e,n,r,a,l,u,h){w(this,Tr,n),w(this,Pr,r),w(this,Qh,a),w(this,Zh,l),w(this,Ic,u),w(this,mg,h??0),w(this,ni,e),x(this,jn,aC).call(this)}get thickness(){return o(this,Ic)}setLastElement(e){return o(this,ni).push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return o(this,ni).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:n}of o(this,ni)){if(e.push(`M${ft.svgRound(n[4])} ${ft.svgRound(n[5])}`),n.length===6){e.push("Z");continue}if(n.length===12&&isNaN(n[6])){e.push(`L${ft.svgRound(n[10])} ${ft.svgRound(n[11])}`);continue}for(let r=6,a=n.length;r<a;r+=6){const[l,u,h,f,p,y]=n.subarray(r,r+6).map(ft.svgRound);e.push(`C${l} ${u} ${h} ${f} ${p} ${y}`)}}return e.join("")}serialize([e,n,r,a],l){const u=[],h=[],[f,p,y,v]=x(this,jn,oC).call(this);let S,C,E,k,T,L,P,M,D;switch(o(this,Zh)){case 0:D=ft._rescale,S=e,C=n+a,E=r,k=-a,T=e+f*r,L=n+(1-p-v)*a,P=e+(f+y)*r,M=n+(1-p)*a;break;case 90:D=ft._rescaleAndSwap,S=e,C=n,E=r,k=a,T=e+p*r,L=n+f*a,P=e+(p+v)*r,M=n+(f+y)*a;break;case 180:D=ft._rescale,S=e+r,C=n,E=-r,k=a,T=e+(1-f-y)*r,L=n+p*a,P=e+(1-f)*r,M=n+(p+v)*a;break;case 270:D=ft._rescaleAndSwap,S=e+r,C=n+a,E=-r,k=-a,T=e+(1-p-v)*r,L=n+(1-f-y)*a,P=e+(1-p)*r,M=n+(1-f)*a;break}for(const{line:I,points:U}of o(this,ni))u.push(D(I,S,C,E,k,l?new Array(I.length):null)),h.push(D(U,S,C,E,k,l?new Array(U.length):null));return{lines:u,points:h,rect:[T,L,P,M]}}static deserialize(e,n,r,a,l,{paths:{lines:u,points:h},rotation:f,thickness:p}){const y=[];let v,S,C,E,k;switch(f){case 0:k=ft._rescale,v=-e/r,S=n/a+1,C=1/r,E=-1/a;break;case 90:k=ft._rescaleAndSwap,v=-n/a,S=-e/r,C=1/a,E=1/r;break;case 180:k=ft._rescale,v=e/r+1,S=-n/a,C=-1/r,E=1/a;break;case 270:k=ft._rescaleAndSwap,v=n/a+1,S=e/r+1,C=-1/a,E=-1/r;break}if(!u){u=[];for(const L of h){const P=L.length;if(P===2){u.push(new Float32Array([NaN,NaN,NaN,NaN,L[0],L[1]]));continue}if(P===4){u.push(new Float32Array([NaN,NaN,NaN,NaN,L[0],L[1],NaN,NaN,NaN,NaN,L[2],L[3]]));continue}const M=new Float32Array(3*(P-2));u.push(M);let[D,I,U,$]=L.subarray(0,4);M.set([NaN,NaN,NaN,NaN,D,I],0);for(let G=4;G<P;G+=2){const nt=L[G],et=L[G+1];M.set(ft.createBezierPoints(D,I,U,$,nt,et),(G-2)*3),[D,I,U,$]=[U,$,nt,et]}}}for(let L=0,P=u.length;L<P;L++)y.push({line:k(u[L].map(M=>M??NaN),v,S,C,E),points:k(h[L].map(M=>M??NaN),v,S,C,E)});const T=new this.prototype.constructor;return T.build(y,r,a,1,f,p,l),T}get box(){return o(this,ls)}updateProperty(e,n){return e==="stroke-width"?x(this,jn,lC).call(this,n):null}updateParentDimensions([e,n],r){const[a,l]=x(this,jn,qr).call(this);w(this,Tr,e),w(this,Pr,n),w(this,Qh,r);const[u,h]=x(this,jn,qr).call(this),f=u-a,p=h-l,y=o(this,ls);return y[0]-=f,y[1]-=p,y[2]+=2*f,y[3]+=2*p,y}updateRotation(e){return w(this,gg,e),{path:{transform:this.rotationTransform}}}get viewBox(){return o(this,ls).map(ft.svgRound).join(" ")}get defaultProperties(){const[e,n]=o(this,ls);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`}}}get rotationTransform(){const[,,e,n]=o(this,ls);let r=0,a=0,l=0,u=0,h=0,f=0;switch(o(this,gg)){case 90:a=n/e,l=-e/n,h=e;break;case 180:r=-1,u=-1,h=e,f=n;break;case 270:a=-n/e,l=e/n,f=n;break;default:return""}return`matrix(${r} ${a} ${l} ${u} ${ft.svgRound(h)} ${ft.svgRound(f)})`}getPathResizingSVGProperties([e,n,r,a]){const[l,u]=x(this,jn,qr).call(this),[h,f,p,y]=o(this,ls);if(Math.abs(p-l)<=ft.PRECISION||Math.abs(y-u)<=ft.PRECISION){const k=e+r/2-(h+p/2),T=n+a/2-(f+y/2);return{path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:`${this.rotationTransform} translate(${k} ${T})`}}}const v=(r-2*l)/(p-2*l),S=(a-2*u)/(y-2*u),C=p/r,E=y/a;return{path:{"transform-origin":`${ft.svgRound(h)} ${ft.svgRound(f)}`,transform:`${this.rotationTransform} scale(${C} ${E}) translate(${ft.svgRound(l)} ${ft.svgRound(u)}) scale(${v} ${S}) translate(${ft.svgRound(-l)} ${ft.svgRound(-u)})`}}}getPathResizedSVGProperties([e,n,r,a]){const[l,u]=x(this,jn,qr).call(this),h=o(this,ls),[f,p,y,v]=h;if(h[0]=e,h[1]=n,h[2]=r,h[3]=a,Math.abs(y-l)<=ft.PRECISION||Math.abs(v-u)<=ft.PRECISION){const T=e+r/2-(f+y/2),L=n+a/2-(p+v/2);for(const{line:P,points:M}of o(this,ni))ft._translate(P,T,L,P),ft._translate(M,T,L,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const S=(r-2*l)/(y-2*l),C=(a-2*u)/(v-2*u),E=-S*(f+l)+e+l,k=-C*(p+u)+n+u;if(S!==1||C!==1||E!==0||k!==0)for(const{line:T,points:L}of o(this,ni))ft._rescale(T,E,k,S,C,T),ft._rescale(L,E,k,S,C,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,n],r){const[a,l]=r,u=o(this,ls),h=e-u[0],f=n-u[1];if(o(this,Tr)===a&&o(this,Pr)===l)for(const{line:p,points:y}of o(this,ni))ft._translate(p,h,f,p),ft._translate(y,h,f,y);else{const p=o(this,Tr)/a,y=o(this,Pr)/l;w(this,Tr,a),w(this,Pr,l);for(const{line:v,points:S}of o(this,ni))ft._rescale(v,h,f,p,y,v),ft._rescale(S,h,f,p,y,S);u[2]*=p,u[3]*=y}return u[0]=e,u[1]=n,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(e)} ${ft.svgRound(n)}`}}}get defaultSVGProperties(){const e=o(this,ls);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ft.svgRound(e[0])} ${ft.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}ls=new WeakMap,gg=new WeakMap,mg=new WeakMap,ni=new WeakMap,Tr=new WeakMap,Pr=new WeakMap,Qh=new WeakMap,Zh=new WeakMap,Ic=new WeakMap,jn=new WeakSet,qr=function(e=o(this,Ic)){const n=o(this,mg)+e/2*o(this,Qh);return o(this,Zh)%180===0?[n/o(this,Tr),n/o(this,Pr)]:[n/o(this,Pr),n/o(this,Tr)]},oC=function(){const[e,n,r,a]=o(this,ls),[l,u]=x(this,jn,qr).call(this,0);return[e+l,n+u,r-2*l,a-2*u]},aC=function(){const e=w(this,ls,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:a}of o(this,ni)){if(a.length<=12){for(let h=4,f=a.length;h<f;h+=6)at.pointBoundingBox(a[h],a[h+1],e);continue}let l=a[4],u=a[5];for(let h=6,f=a.length;h<f;h+=6){const[p,y,v,S,C,E]=a.subarray(h,h+6);at.bezierBoundingBox(l,u,p,y,v,S,C,E,e),l=C,u=E}}const[n,r]=x(this,jn,qr).call(this);e[0]=hs(e[0]-n,0,1),e[1]=hs(e[1]-r,0,1),e[2]=hs(e[2]+n,0,1),e[3]=hs(e[3]+r,0,1),e[2]-=e[0],e[3]-=e[1]},lC=function(e){const[n,r]=x(this,jn,qr).call(this);w(this,Ic,e);const[a,l]=x(this,jn,qr).call(this),[u,h]=[a-n,l-r],f=o(this,ls);return f[0]-=u,f[1]-=h,f[2]+=2*u,f[3]+=2*h,f};class a0 extends iC{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Re._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??(e=this["stroke-width"]),e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new a0(this._viewParameters);return t.updateAll(this),t}}var t0,cC;const Lu=class Lu extends Iy{constructor(e){super({...e,name:"inkEditor"});b(this,t0);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,n){Re.initialize(e,n),this._defaultDrawingOptions=new a0(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ut(this,"typesMap",new Map([[Qt.INK_THICKNESS,"stroke-width"],[Qt.INK_COLOR,"stroke"],[Qt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,n,r,a,l){return new dP(e,n,r,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,n,r,a,l,u){return Eg.deserialize(e,n,r,a,l,u)}static async deserialize(e,n,r){let a=null;if(e instanceof WA){const{data:{inkLists:u,rect:h,rotation:f,id:p,color:y,opacity:v,borderStyle:{rawWidth:S},popupRef:C,richText:E,contentsObj:k,creationDate:T,modificationDate:L},parent:{page:{pageNumber:P}}}=e;a=e={annotationType:jt.INK,color:Array.from(y),thickness:S,opacity:v,paths:{points:u},boxes:null,pageIndex:P-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:C,richText:E,comment:(k==null?void 0:k.str)||null,creationDate:T,modificationDate:L}}const l=await super.deserialize(e,n,r);return l._initialData=a,e.comment&&l.setCommentData(e),l}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new Ly(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Qt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:n,parent:r}=this;n.updateSVGProperty("stroke-width"),r.drawLayer.updateProperties(e,n.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:n,opacity:r}){this._drawingOptions=Lu.getDefaultDrawingOptions({stroke:at.makeHexColor(...e),"stroke-width":n,"stroke-opacity":r})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:n,points:r}=this.serializeDraw(e),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":u}}=this,h=Object.assign(super.serialize(e),{color:Re._colorManager.convert(a),opacity:l,thickness:u,paths:{lines:n,points:r}});return this.addComment(h),e?(h.isCopy=!0,h):this.annotationElementId&&!x(this,t0,cC).call(this,h)?null:(h.id=this.annotationElementId,h)}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:n,rect:r}=this.serializeDraw(!1);return e.updateEdited({rect:r,thickness:this._drawingOptions["stroke-width"],points:n,popup:this.comment}),null}};t0=new WeakSet,cC=function(e){const{color:n,thickness:r,opacity:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((u,h)=>u!==n[h])||e.thickness!==r||e.opacity!==a||e.pageIndex!==l},K(Lu,"_type","ink"),K(Lu,"_editorType",jt.INK),K(Lu,"_defaultDrawingOptions",null);let wA=Lu;class AA extends Eg{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Hm=8,tf=3;var Fc,ue,SA,Qi,uC,hC,bA,yy,dC,fC,pC,xA,EA,gC;class Mo{static extractContoursFromText(t,{fontFamily:e,fontStyle:n,fontWeight:r},a,l,u,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,v=p.font=`${n} ${r} ${y}px ${e}`,{actualBoundingBoxLeft:S,actualBoundingBoxRight:C,actualBoundingBoxAscent:E,actualBoundingBoxDescent:k,fontBoundingBoxAscent:T,fontBoundingBoxDescent:L,width:P}=p.measureText(t),M=1.5,D=Math.ceil(Math.max(Math.abs(S)+Math.abs(C)||0,P)*M),I=Math.ceil(Math.max(Math.abs(E)+Math.abs(k)||y,Math.abs(T)+Math.abs(L)||y)*M);f=new OffscreenCanvas(D,I),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,D,I),p.fillStyle="black",p.fillText(t,D*(M-1)/2,I*(3-M)/2);const U=x(this,ue,xA).call(this,p.getImageData(0,0,D,I).data),$=x(this,ue,pC).call(this,U),G=x(this,ue,EA).call(this,$),nt=x(this,ue,bA).call(this,U,D,I,G);return this.processDrawnLines({lines:{curves:nt,width:D,height:I},pageWidth:a,pageHeight:l,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,n,r,a){const[l,u,h]=x(this,ue,gC).call(this,t),[f,p]=x(this,ue,fC).call(this,l,u,h,Math.hypot(u,h)*o(this,Fc).sigmaSFactor,o(this,Fc).sigmaR,o(this,Fc).kernelSize),y=x(this,ue,EA).call(this,p),v=x(this,ue,bA).call(this,f,u,h,y);return this.processDrawnLines({lines:{curves:v,width:u,height:h},pageWidth:e,pageHeight:n,rotation:r,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:n,rotation:r,innerMargin:a,mustSmooth:l,areContours:u}){r%180!==0&&([e,n]=[n,e]);const{curves:h,width:f,height:p}=t,y=t.thickness??0,v=[],S=Math.min(e/f,n/p),C=S/e,E=S/n,k=[];for(const{points:L}of h){const P=l?x(this,ue,dC).call(this,L):L;if(!P)continue;k.push(P);const M=P.length,D=new Float32Array(M),I=new Float32Array(3*(M===2?2:M-2));if(v.push({line:I,points:D}),M===2){D[0]=P[0]*C,D[1]=P[1]*E,I.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[U,$,G,nt]=P;U*=C,$*=E,G*=C,nt*=E,D.set([U,$,G,nt],0),I.set([NaN,NaN,NaN,NaN,U,$],0);for(let et=4;et<M;et+=2){const Ct=D[et]=P[et]*C,_t=D[et+1]=P[et+1]*E;I.set(ft.createBezierPoints(U,$,G,nt,Ct,_t),(et-2)*3),[U,$,G,nt]=[G,nt,Ct,_t]}}if(v.length===0)return null;const T=u?new AA:new Eg;return T.build(v,e,n,1,r,u?0:y,a),{outline:T,newCurves:k,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:n,width:r,height:a}){let l=1/0,u=-1/0,h=0;for(const P of t){h+=P.length;for(let M=2,D=P.length;M<D;M++){const I=P[M]-P[M-2];l=Math.min(l,I),u=Math.max(u,I)}}let f;l>=-128&&u<=127?f=Int8Array:l>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Hm+tf*p,v=new Uint32Array(y);let S=0;v[S++]=y*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,v[S++]=0,v[S++]=r,v[S++]=a,v[S++]=e?0:1,v[S++]=Math.max(0,Math.floor(n??0)),v[S++]=p,v[S++]=f.BYTES_PER_ELEMENT;for(const P of t)v[S++]=P.length-2,v[S++]=P[0],v[S++]=P[1];const C=new CompressionStream("deflate-raw"),E=C.writable.getWriter();await E.ready,E.write(v);const k=f.prototype.constructor;for(const P of t){const M=new k(P.length-2);for(let D=2,I=P.length;D<I;D++)M[D-2]=P[D]-P[D-2];E.write(M)}E.close();const T=await new Response(C.readable).arrayBuffer(),L=new Uint8Array(T);return fx(L)}static async decompressSignature(t){try{const e=kk(t),{readable:n,writable:r}=new DecompressionStream("deflate-raw"),a=r.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,u=0;for await(const P of n)l||(l=new Uint8Array(new Uint32Array(P.buffer,0,4)[0])),l.set(P,u),u+=P.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],y=h[3],v=h[4]===0,S=h[5],C=h[6],E=h[7],k=[],T=(Hm+tf*C)*Uint32Array.BYTES_PER_ELEMENT;let L;switch(E){case Int8Array.BYTES_PER_ELEMENT:L=new Int8Array(l.buffer,T);break;case Int16Array.BYTES_PER_ELEMENT:L=new Int16Array(l.buffer,T);break;case Int32Array.BYTES_PER_ELEMENT:L=new Int32Array(l.buffer,T);break}u=0;for(let P=0;P<C;P++){const M=h[tf*P+Hm],D=new Float32Array(M+2);k.push(D);for(let I=0;I<tf-1;I++)D[I]=h[tf*P+Hm+I+1];for(let I=0;I<M;I++)D[I+2]=D[I]+L[u++]}return{areContours:v,thickness:S,outlines:k,width:p,height:y}}catch(e){return Bt(`decompressSignature: ${e}`),null}}}Fc=new WeakMap,ue=new WeakSet,SA=function(t,e,n,r){return n-=t,r-=e,n===0?r>0?0:4:n===1?r+6:2-r},Qi=new WeakMap,uC=function(t,e,n,r,a,l,u){const h=x(this,ue,SA).call(this,n,r,a,l);for(let f=0;f<8;f++){const p=(-f+h-u+16)%8,y=o(this,Qi)[2*p],v=o(this,Qi)[2*p+1];if(t[(n+y)*e+(r+v)]!==0)return p}return-1},hC=function(t,e,n,r,a,l,u){const h=x(this,ue,SA).call(this,n,r,a,l);for(let f=0;f<8;f++){const p=(f+h+u+16)%8,y=o(this,Qi)[2*p],v=o(this,Qi)[2*p+1];if(t[(n+y)*e+(r+v)]!==0)return p}return-1},bA=function(t,e,n,r){const a=t.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=t[p]<=r?1:0;for(let p=1;p<n-1;p++)l[p*e]=l[p*e+e-1]=0;for(let p=0;p<e;p++)l[p]=l[e*n-1-p]=0;let u=1,h;const f=[];for(let p=1;p<n-1;p++){h=1;for(let y=1;y<e-1;y++){const v=p*e+y,S=l[v];if(S===0)continue;let C=p,E=y;if(S===1&&l[v-1]===0)u+=1,E-=1;else if(S>=1&&l[v+1]===0)u+=1,E+=1,S>1&&(h=S);else{S!==1&&(h=Math.abs(S));continue}const k=[y,p],T=E===y+1,L={isHole:T,points:k,id:u,parent:0};f.push(L);let P;for(const et of f)if(et.id===h){P=et;break}P?P.isHole?L.parent=T?P.parent:h:L.parent=T?h:P.parent:L.parent=T?h:0;const M=x(this,ue,uC).call(this,l,e,p,y,C,E,0);if(M===-1){l[v]=-u,l[v]!==1&&(h=Math.abs(l[v]));continue}let D=o(this,Qi)[2*M],I=o(this,Qi)[2*M+1];const U=p+D,$=y+I;C=U,E=$;let G=p,nt=y;for(;;){const et=x(this,ue,hC).call(this,l,e,G,nt,C,E,1);D=o(this,Qi)[2*et],I=o(this,Qi)[2*et+1];const Ct=G+D,_t=nt+I;k.push(_t,Ct);const wt=G*e+nt;if(l[wt+1]===0?l[wt]=-u:l[wt]===1&&(l[wt]=u),Ct===p&&_t===y&&G===U&&nt===$){l[v]!==1&&(h=Math.abs(l[v]));break}else C=G,E=nt,G=Ct,nt=_t}}}return f},yy=function(t,e,n,r){if(n-e<=4){for(let U=e;U<n-2;U+=2)r.push(t[U],t[U+1]);return}const a=t[e],l=t[e+1],u=t[n-4]-a,h=t[n-3]-l,f=Math.hypot(u,h),p=u/f,y=h/f,v=p*l-y*a,S=h/u,C=1/f,E=Math.atan(S),k=Math.cos(E),T=Math.sin(E),L=C*(Math.abs(k)+Math.abs(T)),P=C*(1-L+L**2),M=Math.max(Math.atan(Math.abs(T+k)*P),Math.atan(Math.abs(T-k)*P));let D=0,I=e;for(let U=e+2;U<n-2;U+=2){const $=Math.abs(v-p*t[U+1]+y*t[U]);$>D&&(I=U,D=$)}D>(f*M)**2?(x(this,ue,yy).call(this,t,e,I+2,r),x(this,ue,yy).call(this,t,I,n,r)):r.push(a,l)},dC=function(t){const e=[],n=t.length;return x(this,ue,yy).call(this,t,0,n,e),e.push(t[n-2],t[n-1]),e.length<=4?null:e},fC=function(t,e,n,r,a,l){const u=new Float32Array(l**2),h=-2*r**2,f=l>>1;for(let E=0;E<l;E++){const k=(E-f)**2;for(let T=0;T<l;T++)u[E*l+T]=Math.exp((k+(T-f)**2)/h)}const p=new Float32Array(256),y=-2*a**2;for(let E=0;E<256;E++)p[E]=Math.exp(E**2/y);const v=t.length,S=new Uint8Array(v),C=new Uint32Array(256);for(let E=0;E<n;E++)for(let k=0;k<e;k++){const T=E*e+k,L=t[T];let P=0,M=0;for(let I=0;I<l;I++){const U=E+I-f;if(!(U<0||U>=n))for(let $=0;$<l;$++){const G=k+$-f;if(G<0||G>=e)continue;const nt=t[U*e+G],et=u[I*l+$]*p[Math.abs(nt-L)];P+=nt*et,M+=et}}const D=S[T]=Math.round(P/M);C[D]++}return[S,C]},pC=function(t){const e=new Uint32Array(256);for(const n of t)e[n]++;return e},xA=function(t){const e=t.length,n=new Uint8ClampedArray(e>>2);let r=-1/0,a=1/0;for(let u=0,h=n.length;u<h;u++){const f=n[u]=t[u<<2];r=Math.max(r,f),a=Math.min(a,f)}const l=255/(r-a);for(let u=0,h=n.length;u<h;u++)n[u]=(n[u]-a)*l;return n},EA=function(t){let e,n=-1/0,r=-1/0;const a=t.findIndex(h=>h!==0);let l=a,u=a;for(e=a;e<256;e++){const h=t[e];h>n&&(e-l>r&&(r=e-l,u=e-1),n=h,l=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e},gC=function(t){const e=t,{width:n,height:r}=t,{maxDim:a}=o(this,Fc);let l=n,u=r;if(n>a||r>a){let v=n,S=r,C=Math.log2(Math.max(n,r)/a);const E=Math.floor(C);C=C===E?E-1:E;for(let T=0;T<C;T++){l=Math.ceil(v/2),u=Math.ceil(S/2);const L=new OffscreenCanvas(l,u);L.getContext("2d").drawImage(t,0,0,v,S,0,0,l,u),v=l,S=u,t!==e&&t.close(),t=L.transferToImageBitmap()}const k=Math.min(a/l,a/u);l=Math.round(l*k),u=Math.round(u*k)}const f=new OffscreenCanvas(l,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,u);const p=f.getImageData(0,0,l,u).data;return[x(this,ue,xA).call(this,p),l,u]},b(Mo,ue),b(Mo,Fc,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),b(Mo,Qi,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class VA extends iC{constructor(){super(),super.updateProperties({fill:Re._defaultLineColor,"stroke-width":0})}clone(){const t=new VA;return t.updateAll(this),t}}class GA extends a0{constructor(t){super(t),super.updateProperties({stroke:Re._defaultLineColor,"stroke-width":1})}clone(){const t=new GA(this._viewParameters);return t.updateAll(this),t}}var Ga,Rr,Xa,Oc;const Bs=class Bs extends Iy{constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"});b(this,Ga,!1);b(this,Rr,null);b(this,Xa,null);b(this,Oc,null);this._willKeepAspectRatio=!0,w(this,Xa,e.signatureData||null),w(this,Rr,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,n){Re.initialize(e,n),this._defaultDrawingOptions=new VA,this._defaultDrawnSignatureOptions=new GA(n.viewParameters)}static getDefaultDrawingOptions(e){const n=this._defaultDrawingOptions.clone();return n.updateProperties(e),n}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ut(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!o(this,Rr)}}static computeTelemetryFinalData(e){const n=e.get("hasDescription");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,n;const{_isCopy:r}=this;if(r&&(this._isCopy=!1,e=this.x,n=this.y),super.render(),this._drawId===null)if(o(this,Xa)){const{lines:a,mustSmooth:l,areContours:u,description:h,uuid:f,heightInPage:p}=o(this,Xa),{rawDims:{pageWidth:y,pageHeight:v},rotation:S}=this.parent.viewport,C=Mo.processDrawnLines({lines:a,pageWidth:y,pageHeight:v,rotation:S,innerMargin:Bs._INNER_MARGIN,mustSmooth:l,areContours:u});this.addSignature(C,p,h,f)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:o(this,Rr)||""}));return r&&(this._isCopy=!0,this._moveAfterPaste(e,n)),this.div}setUuid(e){w(this,Oc,e),this.addEditToolbar()}getUuid(){return o(this,Oc)}get description(){return o(this,Rr)}set description(e){w(this,Rr,e),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(n=>{n==null||n.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:n,thickness:r,width:a,height:l}=o(this,Xa),u=Math.max(a,l),h=Mo.processDrawnLines({lines:{curves:e.map(f=>({points:f})),thickness:r,width:a,height:l},pageWidth:u,pageHeight:u,rotation:0,innerMargin:0,mustSmooth:!1,areContours:n});return{areContours:n,outline:h.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,n,r,a){const{x:l,y:u}=this,{outline:h}=w(this,Xa,e);w(this,Ga,h instanceof AA),this.description=r;let f;o(this,Ga)?f=Bs.getDefaultDrawingOptions():(f=Bs._defaultDrawnSignatureOptions.clone(),f.updateProperties({"stroke-width":h.thickness})),this._addOutlines({drawOutlines:h,drawingOptions:f});const[,p]=this.pageDimensions;let y=n/p;y=y>=1?.5:y,this.width*=y/this.height,this.width>=1&&(y*=.9/this.width,this.width=.9),this.height=y,this.setDims(),this.x=l,this.y=u,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:n,pageHeight:r},rotation:a}=this.parent.viewport;return Mo.process(e,n,r,a,Bs._INNER_MARGIN)}getFromText(e,n){const{rawDims:{pageWidth:r,pageHeight:a},rotation:l}=this.parent.viewport;return Mo.extractContoursFromText(e,n,r,a,l,Bs._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:n,pageHeight:r},rotation:a}=this.parent.viewport;return Mo.processDrawnLines({lines:e,pageWidth:n,pageHeight:r,rotation:a,innerMargin:Bs._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:n}){e?this._drawingOptions=Bs.getDefaultDrawingOptions():(this._drawingOptions=Bs._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:n,points:r}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":a}}=this,l=Object.assign(super.serialize(e),{isSignature:!0,areContours:o(this,Ga),color:[0,0,0],thickness:o(this,Ga)?0:a});return this.addComment(l),e?(l.paths={lines:n,points:r},l.uuid=o(this,Oc),l.isCopy=!0):l.lines=n,o(this,Rr)&&(l.accessibilityData={type:"Figure",alt:o(this,Rr)}),l}static deserializeDraw(e,n,r,a,l,u){return u.areContours?AA.deserialize(e,n,r,a,l,u):Eg.deserialize(e,n,r,a,l,u)}static async deserialize(e,n,r){var l;const a=await super.deserialize(e,n,r);return w(a,Ga,e.areContours),a.description=((l=e.accessibilityData)==null?void 0:l.alt)||"",w(a,Oc,e.uuid),a}};Ga=new WeakMap,Rr=new WeakMap,Xa=new WeakMap,Oc=new WeakMap,K(Bs,"_type","signature"),K(Bs,"_editorType",jt.SIGNATURE),K(Bs,"_defaultDrawingOptions",null);let CA=Bs;var Be,Pn,qa,ko,Ya,Jh,To,Bc,Lr,si,td,ne,Sf,bf,vy,wy,Ay,kA,Sy,mC;class _A extends Re{constructor(e){super({...e,name:"stampEditor"});b(this,ne);b(this,Be,null);b(this,Pn,null);b(this,qa,null);b(this,ko,null);b(this,Ya,null);b(this,Jh,"");b(this,To,null);b(this,Bc,!1);b(this,Lr,null);b(this,si,!1);b(this,td,!1);w(this,ko,e.bitmapUrl),w(this,Ya,e.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,n){Re.initialize(e,n)}static isHandlingMimeForPasting(e){return hw.includes(e)}static paste(e,n){n.pasteEditor({mode:jt.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var e;return{type:"stamp",hasAltText:!!((e=this.altTextData)!=null&&e.altText)}}static computeTelemetryFinalData(e){const n=e.get("hasAltText");return{hasAltText:n.get(!0)??0,hasNoAltText:n.get(!1)??0}}async mlGuessAltText(e=null,n=!0){if(this.hasAltTextData())return null;const{mlManager:r}=this._uiManager;if(!r)throw new Error("No ML.");if(!await r.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:u}=e||this.copyCanvas(null,null,!0).imageData,h=await r.guess({name:"altText",request:{data:a,width:l,height:u,channels:a.length/(l*u)}});if(!h)throw new Error("No response from the AI service.");if(h.error)throw new Error("Error from the AI service.");if(h.cancel)return null;if(!h.output)throw new Error("No valid response from the AI service.");const f=h.output;return await this.setGuessedAltText(f),n&&!this.hasAltTextData()&&(this.altTextData={alt:f,decorative:!1}),f}remove(){var e;o(this,Pn)&&(w(this,Be,null),this._uiManager.imageManager.deleteId(o(this,Pn)),(e=o(this,To))==null||e.remove(),w(this,To,null),o(this,Lr)&&(clearTimeout(o(this,Lr)),w(this,Lr,null))),super.remove()}rebuild(){if(!this.parent){o(this,Pn)&&x(this,ne,vy).call(this);return}super.rebuild(),this.div!==null&&(o(this,Pn)&&o(this,To)===null&&x(this,ne,vy).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(o(this,qa)||o(this,Be)||o(this,ko)||o(this,Ya)||o(this,Pn)||o(this,Bc))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,n;return this._isCopy&&(e=this.x,n=this.y),super.render(),this.div.hidden=!0,this.createAltText(),o(this,Bc)||(o(this,Be)?x(this,ne,wy).call(this):x(this,ne,vy).call(this)),this._isCopy&&this._moveAfterPaste(e,n),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,n){const{id:r,bitmap:a}=this._uiManager.imageManager.getFromCanvas(e,n);n.remove(),r&&this._uiManager.imageManager.isValidId(r)&&(w(this,Pn,r),a&&w(this,Be,a),w(this,Bc,!1),x(this,ne,wy).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;o(this,Lr)!==null&&clearTimeout(o(this,Lr)),w(this,Lr,setTimeout(()=>{w(this,Lr,null),x(this,ne,kA).call(this)},200))}copyCanvas(e,n,r=!1){e||(e=224);const{width:a,height:l}=o(this,Be),u=new Dr;let h=o(this,Be),f=a,p=l,y=null;if(n){if(a>n||l>n){const U=Math.min(n/a,n/l);f=Math.floor(a*U),p=Math.floor(l*U)}y=document.createElement("canvas");const S=y.width=Math.ceil(f*u.sx),C=y.height=Math.ceil(p*u.sy);o(this,si)||(h=x(this,ne,Ay).call(this,S,C));const E=y.getContext("2d");E.filter=this._uiManager.hcmFilter;let k="white",T="#cfcfd8";this._uiManager.hcmFilter!=="none"?T="black":Dk.isDarkMode&&(k="#8f8f9d",T="#42414d");const L=15,P=L*u.sx,M=L*u.sy,D=new OffscreenCanvas(P*2,M*2),I=D.getContext("2d");I.fillStyle=k,I.fillRect(0,0,P*2,M*2),I.fillStyle=T,I.fillRect(0,0,P,M),I.fillRect(P,M,P,M),E.fillStyle=E.createPattern(D,"repeat"),E.fillRect(0,0,S,C),E.drawImage(h,0,0,h.width,h.height,0,0,S,C)}let v=null;if(r){let S,C;if(u.symmetric&&h.width<e&&h.height<e)S=h.width,C=h.height;else if(h=o(this,Be),a>e||l>e){const T=Math.min(e/a,e/l);S=Math.floor(a*T),C=Math.floor(l*T),o(this,si)||(h=x(this,ne,Ay).call(this,S,C))}const k=new OffscreenCanvas(S,C).getContext("2d",{willReadFrequently:!0});k.drawImage(h,0,0,h.width,h.height,0,0,S,C),v={width:S,height:C,data:k.getImageData(0,0,S,C).data}}return{canvas:y,width:f,height:p,imageData:v}}static async deserialize(e,n,r){var k;let a=null,l=!1;if(e instanceof ME){const{data:{rect:T,rotation:L,id:P,structParent:M,popupRef:D,richText:I,contentsObj:U,creationDate:$,modificationDate:G},container:nt,parent:{page:{pageNumber:et}},canvas:Ct}=e;let _t,wt;Ct?(delete e.canvas,{id:_t,bitmap:wt}=r.imageManager.getFromCanvas(nt.id,Ct),Ct.remove()):(l=!0,e._hasNoCanvas=!0);const kt=((k=await n._structTree.getAriaAttributes(`${_u}${P}`))==null?void 0:k.get("aria-label"))||"";a=e={annotationType:jt.STAMP,bitmapId:_t,bitmap:wt,pageIndex:et-1,rect:T.slice(0),rotation:L,annotationElementId:P,id:P,deleted:!1,accessibilityData:{decorative:!1,altText:kt},isSvg:!1,structParent:M,popupRef:D,richText:I,comment:(U==null?void 0:U.str)||null,creationDate:$,modificationDate:G}}const u=await super.deserialize(e,n,r),{rect:h,bitmap:f,bitmapUrl:p,bitmapId:y,isSvg:v,accessibilityData:S}=e;l?(r.addMissingCanvas(e.id,u),w(u,Bc,!0)):y&&r.imageManager.isValidId(y)?(w(u,Pn,y),f&&w(u,Be,f)):w(u,ko,p),w(u,si,v);const[C,E]=u.pageDimensions;return u.width=(h[2]-h[0])/C,u.height=(h[3]-h[1])/E,S&&(u.altTextData=S),u._initialData=a,e.comment&&u.setCommentData(e),w(u,td,!!a),u}serialize(e=!1,n=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=Object.assign(super.serialize(e),{bitmapId:o(this,Pn),isSvg:o(this,si)});if(this.addComment(r),e)return r.bitmapUrl=x(this,ne,Sy).call(this,!0),r.accessibilityData=this.serializeAltText(!0),r.isCopy=!0,r;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(r.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const h=x(this,ne,mC).call(this,r);return h.isSame?null:(h.isSameAltText?delete r.accessibilityData:r.accessibilityData.structParent=this._initialData.structParent??-1,r.id=this.annotationElementId,delete r.bitmapId,r)}if(n===null)return r;n.stamps||(n.stamps=new Map);const u=o(this,si)?(r.rect[2]-r.rect[0])*(r.rect[3]-r.rect[1]):null;if(!n.stamps.has(o(this,Pn)))n.stamps.set(o(this,Pn),{area:u,serialized:r}),r.bitmap=x(this,ne,Sy).call(this,!1);else if(o(this,si)){const h=n.stamps.get(o(this,Pn));u>h.area&&(h.area=u,h.serialized.bitmap.close(),h.serialized.bitmap=x(this,ne,Sy).call(this,!1))}return r}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Be=new WeakMap,Pn=new WeakMap,qa=new WeakMap,ko=new WeakMap,Ya=new WeakMap,Jh=new WeakMap,To=new WeakMap,Bc=new WeakMap,Lr=new WeakMap,si=new WeakMap,td=new WeakMap,ne=new WeakSet,Sf=function(e,n=!1){if(!e){this.remove();return}w(this,Be,e.bitmap),n||(w(this,Pn,e.id),w(this,si,e.isSvg)),e.file&&w(this,Jh,e.file.name),x(this,ne,wy).call(this)},bf=function(){if(w(this,qa,null),this._uiManager.enableWaiting(!1),!!o(this,To)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Be)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&o(this,Be)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},vy=function(){if(o(this,Pn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(o(this,Pn)).then(r=>x(this,ne,Sf).call(this,r,!0)).finally(()=>x(this,ne,bf).call(this));return}if(o(this,ko)){const r=o(this,ko);w(this,ko,null),this._uiManager.enableWaiting(!0),w(this,qa,this._uiManager.imageManager.getFromUrl(r).then(a=>x(this,ne,Sf).call(this,a)).finally(()=>x(this,ne,bf).call(this)));return}if(o(this,Ya)){const r=o(this,Ya);w(this,Ya,null),this._uiManager.enableWaiting(!0),w(this,qa,this._uiManager.imageManager.getFromFile(r).then(a=>x(this,ne,Sf).call(this,a)).finally(()=>x(this,ne,bf).call(this)));return}const e=document.createElement("input");e.type="file",e.accept=hw.join(",");const n=this._uiManager._signal;w(this,qa,new Promise(r=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),x(this,ne,Sf).call(this,a)}r()},{signal:n}),e.addEventListener("cancel",()=>{this.remove(),r()},{signal:n})}).finally(()=>x(this,ne,bf).call(this))),e.click()},wy=function(){var f;const{div:e}=this;let{width:n,height:r}=o(this,Be);const[a,l]=this.pageDimensions,u=.75;if(this.width)n=this.width*a,r=this.height*l;else if(n>u*a||r>u*l){const p=Math.min(u*a/n,u*l/r);n*=p,r*=p}this._uiManager.enableWaiting(!1);const h=w(this,To,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=n/a,this.height=r/l,this.setDims(),(f=this._initialOptions)!=null&&f.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),x(this,ne,kA).call(this),o(this,td)||(this.parent.addUndoableEditor(this),w(this,td,!0)),this._reportTelemetry({action:"inserted_image"}),o(this,Jh)&&this.div.setAttribute("aria-description",o(this,Jh)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Ay=function(e,n){const{width:r,height:a}=o(this,Be);let l=r,u=a,h=o(this,Be);for(;l>2*e||u>2*n;){const f=l,p=u;l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),u>2*n&&(u=u>=16384?Math.floor(u/2)-1:Math.ceil(u/2));const y=new OffscreenCanvas(l,u);y.getContext("2d").drawImage(h,0,0,f,p,0,0,l,u),h=y.transferToImageBitmap()}return h},kA=function(){const[e,n]=this.parentDimensions,{width:r,height:a}=this,l=new Dr,u=Math.ceil(r*e*l.sx),h=Math.ceil(a*n*l.sy),f=o(this,To);if(!f||f.width===u&&f.height===h)return;f.width=u,f.height=h;const p=o(this,si)?o(this,Be):x(this,ne,Ay).call(this,u,h),y=f.getContext("2d");y.filter=this._uiManager.hcmFilter,y.drawImage(p,0,0,p.width,p.height,0,0,u,h)},Sy=function(e){if(e){if(o(this,si)){const a=this._uiManager.imageManager.getSvgUrl(o(this,Pn));if(a)return a}const n=document.createElement("canvas");return{width:n.width,height:n.height}=o(this,Be),n.getContext("2d").drawImage(o(this,Be),0,0),n.toDataURL()}if(o(this,si)){const[n,r]=this.pageDimensions,a=Math.round(this.width*n*nl.PDF_TO_CSS_UNITS),l=Math.round(this.height*r*nl.PDF_TO_CSS_UNITS),u=new OffscreenCanvas(a,l);return u.getContext("2d").drawImage(o(this,Be),0,0,o(this,Be).width,o(this,Be).height,0,0,a,l),u.transferToImageBitmap()}return structuredClone(o(this,Be))},mC=function(e){var u;const{pageIndex:n,accessibilityData:{altText:r}}=this._initialData,a=e.pageIndex===n,l=(((u=e.accessibilityData)==null?void 0:u.alt)||"")===r;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}},K(_A,"_type","stamp"),K(_A,"_editorType",jt.STAMP);var Uc,ed,Ka,Qa,Po,Ps,Za,nd,sd,Zi,Ro,Rn,Lo,Ja,id,vt,tl,xe,PA,yC,cr,RA,LA,by;const ji=class ji{constructor({uiManager:t,pageIndex:e,div:n,structTreeLayer:r,accessibilityManager:a,annotationLayer:l,drawLayer:u,textLayer:h,viewport:f,l10n:p}){b(this,xe);b(this,Uc);b(this,ed,!1);b(this,Ka,null);b(this,Qa,null);b(this,Po,null);b(this,Ps,new Map);b(this,Za,!1);b(this,nd,!1);b(this,sd,!1);b(this,Zi,null);b(this,Ro,null);b(this,Rn,null);b(this,Lo,null);b(this,Ja,null);b(this,id,-1);b(this,vt);const y=[...o(ji,tl).values()];if(!ji._initialized){ji._initialized=!0;for(const v of y)v.initialize(p,t)}t.registerEditorTypes(y),w(this,vt,t),this.pageIndex=e,this.div=n,w(this,Uc,a),w(this,Ka,l),this.viewport=f,w(this,Rn,h),this.drawLayer=u,this._structTree=r,o(this,vt).addLayer(this)}get isEmpty(){return o(this,Ps).size===0}get isInvisible(){return this.isEmpty&&o(this,vt).getMode()===jt.NONE}updateToolbar(t){o(this,vt).updateToolbar(t)}updateMode(t=o(this,vt).getMode()){switch(x(this,xe,by).call(this),t){case jt.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case jt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case jt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===jt.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const n of o(ji,tl).values())e.toggle(`${n._type}Editing`,t===n._editorType)}this.div.hidden=!1}hasTextLayer(t){var e;return t===((e=o(this,Rn))==null?void 0:e.div)}setEditingState(t){o(this,vt).setEditingState(t)}addCommands(t){o(this,vt).addCommands(t)}cleanUndoStack(t){o(this,vt).cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){var e;(e=o(this,Ka))==null||e.togglePointerEvents(t)}async enable(){var n;w(this,sd,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(n=o(this,Ja))==null||n.abort(),w(this,Ja,null);const t=new Set;for(const r of o(this,xe,PA))r.enableEditing(),r.show(!0),r.annotationElementId&&(o(this,vt).removeChangedExistingAnnotation(r),t.add(r.annotationElementId));const e=o(this,Ka);if(e)for(const r of e.getEditableAnnotations()){if(r.hide(),o(this,vt).isDeletedAnnotationElement(r.data.id)||t.has(r.data.id))continue;const a=await this.deserialize(r);a&&(this.addOrRebuild(a),a.enableEditing())}w(this,sd,!1),o(this,vt)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var r;if(w(this,nd,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),o(this,Rn)&&!o(this,Ja)){w(this,Ja,new AbortController);const a=o(this,vt).combinedSignal(o(this,Ja));o(this,Rn).div.addEventListener("pointerdown",l=>{const{clientX:h,clientY:f,timeStamp:p}=l,y=o(this,id);if(p-y>500){w(this,id,p);return}w(this,id,-1);const{classList:v}=this.div;v.toggle("getElements",!0);const S=document.elementsFromPoint(h,f);if(v.toggle("getElements",!1),!this.div.contains(S[0]))return;let C;const E=new RegExp(`^${xf}[0-9]+$`);for(const T of S)if(E.test(T.id)){C=T.id;break}if(!C)return;const k=o(this,Ps).get(C);(k==null?void 0:k.annotationElementId)===null&&(l.stopPropagation(),l.preventDefault(),k.dblclick(l))},{signal:a,capture:!0})}const t=o(this,Ka),e=[];if(t){const a=new Map,l=new Map;for(const h of o(this,xe,PA)){if(h.disableEditing(),!h.annotationElementId){e.push(h);continue}if(h.serialize()!==null){a.set(h.annotationElementId,h);continue}else l.set(h.annotationElementId,h);(r=this.getEditableAnnotation(h.annotationElementId))==null||r.show(),h.remove()}const u=t.getEditableAnnotations();for(const h of u){const{id:f}=h.data;if(o(this,vt).isDeletedAnnotationElement(f)){h.updateEdited({deleted:!0});continue}let p=l.get(f);if(p){p.resetAnnotationElement(h),p.show(!1),h.show();continue}p=a.get(f),p&&(o(this,vt).addChangedExistingAnnotation(p),p.renderAnnotationElement(h)&&p.show(!1)),h.show()}}x(this,xe,by).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const a of o(ji,tl).values())n.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t==null||t.updateFakeAnnotations(e),w(this,nd,!1)}getEditableAnnotation(t){var e;return((e=o(this,Ka))==null?void 0:e.getEditableAnnotation(t))||null}setActiveEditor(t){o(this,vt).getActive()!==t&&o(this,vt).setActiveEditor(t)}enableTextSelection(){var t;if(this.div.tabIndex=-1,(t=o(this,Rn))!=null&&t.div&&!o(this,Lo)){w(this,Lo,new AbortController);const e=o(this,vt).combinedSignal(o(this,Lo));o(this,Rn).div.addEventListener("pointerdown",x(this,xe,yC).bind(this),{signal:e}),o(this,Rn).div.classList.add("highlighting")}}disableTextSelection(){var t;this.div.tabIndex=0,(t=o(this,Rn))!=null&&t.div&&o(this,Lo)&&(o(this,Lo).abort(),w(this,Lo,null),o(this,Rn).div.classList.remove("highlighting"))}enableClick(){if(o(this,Qa))return;w(this,Qa,new AbortController);const t=o(this,vt).combinedSignal(o(this,Qa));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){var t;(t=o(this,Qa))==null||t.abort(),w(this,Qa,null)}attach(t){o(this,Ps).set(t.id,t);const{annotationElementId:e}=t;e&&o(this,vt).isDeletedAnnotationElement(e)&&o(this,vt).removeDeletedAnnotationElement(t)}detach(t){var e;o(this,Ps).delete(t.id),(e=o(this,Uc))==null||e.removePointerInTextLayer(t.contentDiv),!o(this,nd)&&t.annotationElementId&&o(this,vt).addDeletedAnnotationElement(t)}remove(t){this.detach(t),o(this,vt).removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){var e;t.parent!==this&&(t.parent&&t.annotationElementId&&(o(this,vt).addDeletedAnnotationElement(t),Re.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),(e=t.parent)==null||e.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),o(this,vt).addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!o(this,sd)),o(this,vt).addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){var n;if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!o(this,Po)&&(t._focusEventsAllowed=!1,w(this,Po,setTimeout(()=>{w(this,Po,null),t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:o(this,vt)._signal}),e.focus())},0))),t._structTreeParentId=(n=o(this,Uc))==null?void 0:n.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||(t.parent=this),t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),n=()=>{t.remove()};this.addCommands({cmd:e,undo:n,mustExec:!1})}getEditorByUID(t){for(const e of o(this,Ps).values())if(e.uid===t)return e;return null}getNextId(){return o(this,vt).getId()}combinedSignal(t){return o(this,vt).combinedSignal(t)}canCreateNewEmptyEditor(){var t;return(t=o(this,xe,cr))==null?void 0:t.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await o(this,vt).updateMode(t.mode);const{offsetX:n,offsetY:r}=x(this,xe,LA).call(this),a=this.getNextId(),l=x(this,xe,RA).call(this,{parent:this,id:a,x:n,y:r,uiManager:o(this,vt),isCentered:!0,...e});l&&this.add(l)}async deserialize(t){var e;return await((e=o(ji,tl).get(t.annotationType??t.annotationEditorType))==null?void 0:e.deserialize(t,this,o(this,vt)))||null}createAndAddNewEditor(t,e,n={}){const r=this.getNextId(),a=x(this,xe,RA).call(this,{parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:o(this,vt),isCentered:e,...n});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(t={}){this.createAndAddNewEditor(x(this,xe,LA).call(this),!0,t)}setSelected(t){o(this,vt).setSelected(t)}toggleSelected(t){o(this,vt).toggleSelected(t)}unselect(t){o(this,vt).unselect(t)}pointerup(t){var r;const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!o(this,Za)||(w(this,Za,!1),(r=o(this,xe,cr))!=null&&r.isDrawer&&o(this,xe,cr).supportMultipleDrawings))return;if(!o(this,ed)){w(this,ed,!0);return}const n=o(this,vt).getMode();if(n===jt.STAMP||n===jt.SIGNATURE){o(this,vt).unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){var r;if(o(this,vt).getMode()===jt.HIGHLIGHT&&this.enableTextSelection(),o(this,Za)){w(this,Za,!1);return}const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(w(this,Za,!0),(r=o(this,xe,cr))!=null&&r.isDrawer){this.startDrawingSession(t);return}const n=o(this,vt).getActive();w(this,ed,!n||n.isEmpty())}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),o(this,Zi)){o(this,xe,cr).startDrawing(this,o(this,vt),!1,t);return}o(this,vt).setCurrentDrawingSession(this),w(this,Zi,new AbortController);const e=o(this,vt).combinedSignal(o(this,Zi));this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(w(this,Ro,null),this.commitOrRemove())},{signal:e}),o(this,xe,cr).startDrawing(this,o(this,vt),!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&w(this,Ro,e);return}o(this,Ro)&&setTimeout(()=>{var e;(e=o(this,Ro))==null||e.focus(),w(this,Ro,null)},0)}endDrawingSession(t=!1){return o(this,Zi)?(o(this,vt).setCurrentDrawingSession(null),o(this,Zi).abort(),w(this,Zi,null),w(this,Ro,null),o(this,xe,cr).endDrawing(t)):null}findNewParent(t,e,n){const r=o(this,vt).findParent(e,n);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return o(this,Zi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){o(this,Zi)&&o(this,xe,cr).onScaleChangingWhenDrawing(this)}destroy(){var t,e;this.commitOrRemove(),((t=o(this,vt).getActive())==null?void 0:t.parent)===this&&(o(this,vt).commitOrRemove(),o(this,vt).setActiveEditor(null)),o(this,Po)&&(clearTimeout(o(this,Po)),w(this,Po,null));for(const n of o(this,Ps).values())(e=o(this,Uc))==null||e.removePointerInTextLayer(n.contentDiv),n.setParent(null),n.isAttachedToDOM=!1,n.div.remove();this.div=null,o(this,Ps).clear(),o(this,vt).removeLayer(this)}render({viewport:t}){this.viewport=t,jc(this.div,t);for(const e of o(this,vt).getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){o(this,vt).commitOrRemove(),x(this,xe,by).call(this);const e=this.viewport.rotation,n=t.rotation;if(this.viewport=t,jc(this.div,{rotation:n}),e!==n)for(const r of o(this,Ps).values())r.rotate(n)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return o(this,vt).viewParameters.realScale}};Uc=new WeakMap,ed=new WeakMap,Ka=new WeakMap,Qa=new WeakMap,Po=new WeakMap,Ps=new WeakMap,Za=new WeakMap,nd=new WeakMap,sd=new WeakMap,Zi=new WeakMap,Ro=new WeakMap,Rn=new WeakMap,Lo=new WeakMap,Ja=new WeakMap,id=new WeakMap,vt=new WeakMap,tl=new WeakMap,xe=new WeakSet,PA=function(){return o(this,Ps).size!==0?o(this,Ps).values():o(this,vt).getEditors(this.pageIndex)},yC=function(t){o(this,vt).unselectAll();const{target:e}=t;if(e===o(this,Rn).div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&o(this,Rn).div.contains(e)){const{isMac:n}=wn.platform;if(t.button!==0||t.ctrlKey&&n)return;o(this,vt).showAllEditors("highlight",!0,!0),o(this,Rn).div.classList.add("free"),this.toggleDrawing(),Ny.startHighlighting(this,o(this,vt).direction==="ltr",{target:o(this,Rn).div,x:t.x,y:t.y}),o(this,Rn).div.addEventListener("pointerup",()=>{o(this,Rn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:o(this,vt)._signal}),t.preventDefault()}},cr=function(){return o(ji,tl).get(o(this,vt).getMode())},RA=function(t){const e=o(this,xe,cr);return e?new e.prototype.constructor(t):null},LA=function(){const{x:t,y:e,width:n,height:r}=this.boundingClientRect,a=Math.max(0,t),l=Math.max(0,e),u=Math.min(window.innerWidth,t+n),h=Math.min(window.innerHeight,e+r),f=(a+u)/2-t,p=(l+h)/2-e,[y,v]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:v}},by=function(){for(const t of o(this,Ps).values())t.isEmpty()&&t.remove()},K(ji,"_initialized",!1),b(ji,tl,new Map([cA,wA,_A,Ny,CA].map(t=>[t._editorType,t])));let TA=ji;var Ji,cs,zc,yg,e0,vC,Nr,DA,wC,NA;const gn=class gn{constructor({pageIndex:t}){b(this,Nr);b(this,Ji,null);b(this,cs,new Map);b(this,zc,new Map);this.pageIndex=t}setParent(t){if(!o(this,Ji)){w(this,Ji,t);return}if(o(this,Ji)!==t){if(o(this,cs).size>0)for(const e of o(this,cs).values())e.remove(),t.append(e);w(this,Ji,t)}}static get _svgFactory(){return Ut(this,"_svgFactory",new My)}draw(t,e=!1,n=!1){const r=fn(gn,yg)._++,a=x(this,Nr,DA).call(this),l=gn._svgFactory.createElement("defs");a.append(l);const u=gn._svgFactory.createElement("path");l.append(u);const h=`path_p${this.pageIndex}_${r}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),e&&o(this,zc).set(r,u);const f=n?x(this,Nr,wC).call(this,l,h):null,p=gn._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,t),o(this,cs).set(r,a),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const n=fn(gn,yg)._++,r=x(this,Nr,DA).call(this),a=gn._svgFactory.createElement("defs");r.append(a);const l=gn._svgFactory.createElement("path");a.append(l);const u=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",u),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const y=gn._svgFactory.createElement("mask");a.append(y),h=`mask_p${this.pageIndex}_${n}`,y.setAttribute("id",h),y.setAttribute("maskUnits","objectBoundingBox");const v=gn._svgFactory.createElement("rect");y.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const S=gn._svgFactory.createElement("use");y.append(S),S.setAttribute("href",`#${u}`),S.setAttribute("stroke","none"),S.setAttribute("fill","black"),S.setAttribute("fill-rule","nonzero"),S.classList.add("mask")}const f=gn._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),o(this,cs).set(n,r),n}finalizeDraw(t,e){o(this,zc).delete(t),this.updateProperties(t,e)}updateProperties(t,e){var h;if(!e)return;const{root:n,bbox:r,rootClass:a,path:l}=e,u=typeof t=="number"?o(this,cs).get(t):t;if(u){if(n&&x(this,Nr,NA).call(this,u,n),r&&x(h=gn,e0,vC).call(h,u,r),a){const{classList:f}=u;for(const[p,y]of Object.entries(a))f.toggle(p,y)}if(l){const p=u.firstElementChild.firstElementChild;x(this,Nr,NA).call(this,p,l)}}}updateParent(t,e){if(e===this)return;const n=o(this,cs).get(t);n&&(o(e,Ji).append(n),o(this,cs).delete(t),o(e,cs).set(t,n))}remove(t){o(this,zc).delete(t),o(this,Ji)!==null&&(o(this,cs).get(t).remove(),o(this,cs).delete(t))}destroy(){w(this,Ji,null);for(const t of o(this,cs).values())t.remove();o(this,cs).clear(),o(this,zc).clear()}};Ji=new WeakMap,cs=new WeakMap,zc=new WeakMap,yg=new WeakMap,e0=new WeakSet,vC=function(t,[e,n,r,a]){const{style:l}=t;l.top=`${100*n}%`,l.left=`${100*e}%`,l.width=`${100*r}%`,l.height=`${100*a}%`},Nr=new WeakSet,DA=function(){const t=gn._svgFactory.create(1,1,!0);return o(this,Ji).append(t),t.setAttribute("aria-hidden",!0),t},wC=function(t,e){const n=gn._svgFactory.createElement("clipPath");t.append(n);const r=`clip_${e}`;n.setAttribute("id",r),n.setAttribute("clipPathUnits","objectBoundingBox");const a=gn._svgFactory.createElement("use");return n.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),r},NA=function(t,e){for(const[n,r]of Object.entries(e))r===null?t.removeAttribute(n):t.setAttribute(n,r)},b(gn,e0),b(gn,yg,0);let MA=gn;globalThis._pdfjsTestingUtils={HighlightOutliner:hA};globalThis.pdfjsLib={AbortException:el,AnnotationEditorLayer:TA,AnnotationEditorParamsType:Qt,AnnotationEditorType:jt,AnnotationEditorUIManager:Hc,AnnotationLayer:aA,AnnotationMode:ua,AnnotationType:ln,applyOpacity:Ik,build:$T,ColorPicker:Ry,createValidAbsoluteUrl:cx,CSSConstants:Nk,DOMSVGFactory:My,DrawLayer:MA,FeatureTest:wn,fetchData:wg,findContrastColor:Fk,getDocument:yE,getFilenameFromUrl:Tk,getPdfFilenameFromUrl:Pk,getRGB:Sg,getUuid:dx,getXfaPageViewport:Lk,GlobalWorkerOptions:Mr,ImageKind:$m,InvalidPDFException:cw,isDataScheme:r0,isPdfFile:UA,isValidExplicitDest:Xk,MathClamp:hs,noContextMenu:Ri,normalizeUnicode:Ck,OPS:Ef,OutputScale:Dr,PasswordResponses:mk,PDFDataRangeTransport:vE,PDFDateString:Ey,PDFWorker:kf,PermissionFlag:gk,PixelsPerInch:nl,RenderingCancelledException:BA,renderRichText:gx,ResponseException:xy,setLayerDimensions:jc,shadow:Ut,SignatureExtractor:Mo,stopEvent:Qe,SupportedImageMimeTypes:hw,TextLayer:_f,TouchManager:_y,updateUrlHash:ux,Util:at,VerbosityLevel:n0,version:HT,XfaLayer:px};const fP="/assets/pdf.worker.min-LyOxJPrg.mjs";Mr.workerSrc=fP;const ce="(?:Mr|Mrs|Ms|Miss|Dr|Prof|Professor|Governor|Mayor|Senator|Representative|Congressman|Congresswoman|King|Queen|Prince|Princess|Duke|Duchess|Sir|Madam|Madame|Lord|Lady|President|Vice\\s+President|Secretary|General|Admiral|Colonel|Major|Captain|Lieutenant|Sergeant|Chief|Judge|Justice|Ambassador|Minister|Chancellor|Premier|Prime\\s+Minister)\\.?\\s+";function pP(g){return g.replace(/\r\n/g,`
`).replace(/\r/g,`
`)}function l0(g){return pP(g).replace(/\u00A0/g," ").replace(/[\u200B-\u200D\uFEFF]/g,"").replace(/[]/g,"(").replace(/[]/g,")").replace(/[]/g,":")}function ix(g){const t=l0(g).trim();if(!t||/\s/.test(t))return null;const e=t.replace(/^<(.+)>$/,"$1").trim();try{const n=new URL(e);return n.protocol!=="http:"&&n.protocol!=="https:"?null:n.toString()}catch{return null}}function gP(g){const t=l0(g),e=new RegExp(`((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}(?::[0-9]{2})?\\)\\s*:\\s*)`,"g"),n=Array.from(t.matchAll(e)).filter(p=>p.index!==void 0);if(console.log("[Text Parse] splitTranscriptIntoSpeakerParagraphs",{textLength:t.length,markerCount:n.length,markerSample:n.slice(0,5).map(p=>({at:p.index,marker:(p[0]||"").trim()}))}),n.length===0)return t.split(/\n{2,}/).map(p=>p.trim()).filter(Boolean);const r=p=>{const v=p.trim().match(new RegExp(`^(?:${ce})?((?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3})|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`));return v?v[1].trim():null},a=p=>p.replace(/^[\u2026]+/g,"").replace(/^\.{3,}/g,"").trim(),l=[],u=p=>{const y=p.trim();y&&l.push(y)};let h="",f=null;for(let p=0;p<n.length;p++){const y=n[p].index,v=p<n.length-1?n[p+1].index:t.length,S=n[p][0]||"",C=r(S),E=t.slice(y,v).trim();if(!E)continue;const k=E.slice(S.length).trimStart();if(C&&f&&C.toLowerCase()===f.toLowerCase()){const T=a(k);T&&(h=(h?`${h} ${T}`:T).trim());continue}h&&u(h),f=C,h=k?`${S.trim()} ${k}`.trim():S.trim()}return h&&u(h),l}function mP(g){var l,u,h,f;const t=new RegExp(`^(${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}(?::[0-9]{2})?\\)\\s*:\\s*`,""),e=new RegExp(`^(${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){1,3}|[Ss]peaker\\s+[0-9]+)\\s*:\\s*`,""),n=g.reduce((p,y)=>{const v=(y==null?void 0:y.trim())||"";return p+(e.test(v)?1:0)},0),r=p=>!!(t.test(p)||n>=3&&e.test(p)),a=[];for(let p=0;p<g.length;p++){const y=(l=g[p])==null?void 0:l.trim();if(!y)continue;if(!r(y)){a.push(y);continue}let v=y,S=p+1;for(;S<g.length;){const C=(u=g[S])==null?void 0:u.trim();if(!C){S+=1;continue}if(r(C))break;v=`${v} ${C}`.trim(),S+=1}a.push(v),p=S-1}return console.log("[Text Parse] mergeTranscriptParagraphsFromPlainParas",{before:g.length,after:a.length,noTimestampHeaderCount:n,firstBefore:(h=g[0])==null?void 0:h.slice(0,160),firstAfter:(f=a[0])==null?void 0:f.slice(0,160)}),a}function rx(g){const t=g.length;return t%2===0?t/2-1||0:(t-1)/2||0}function yP(g){if(!g)return 0;if(!g.includes(" "))return rx(g);const t=[];for(let n=0;n<g.length;n+=1)g[n]!==" "&&t.push(n);if(t.length===0)return 0;const e=rx("x".repeat(t.length));return t[Math.min(Math.max(e,0),t.length-1)]}function vP(g){var f,p,y,v;const t=l0(g),e=new RegExp(`((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}(?::[0-9]{2})?\\)\\s*:\\s*)`,"g"),n=Array.from(t.matchAll(e)),r=new RegExp(`(^|\\n)\\s*((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){1,3}|[Ss]peaker\\s+[0-9]+))\\s*:\\s*`,"gm"),a=Array.from(t.matchAll(r)),l=n.length>0||a.length>=3;if(console.log("[Text Parse] normalizeText",{textLength:t.length,transcriptMarkerCount:n.length,transcriptMarkerSample:n.slice(0,5).map(S=>(S[0]||"").trim()),speakerOnlyMarkerCount:a.length,speakerOnlyMarkerSample:a.slice(0,5).map(S=>(S[2]||"").trim()),hasTranscriptFormat:l}),l){const S=[],C=k=>{const T=FA(k);if(!T)return;const L=wP(T);L.length>0&&S.push({raw:T,words:L})};return gP(t).forEach(C),console.log("[Text Parse] transcript paragraphs built",{paragraphCount:S.length,firstRaw:(p=(f=S[0])==null?void 0:f.raw)==null?void 0:p.slice(0,220),secondRaw:(v=(y=S[1])==null?void 0:y.raw)==null?void 0:v.slice(0,220)}),S}const u=t.split(/\n{2,}|\r{2,}/).map(S=>S.trim()).filter(Boolean);return u.length?mP(u).map(S=>{const C=S.replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'").split(/\s+/).filter(Boolean);return{raw:S,words:C}}):[]}function IA(g){const t=g.trim().split(/\s+/),e=new Set,n=[];for(const r of t){const a=r.toLowerCase();e.has(a)||(e.add(a),n.push(r))}return n.join(" ")}function Fy(g){console.log("[Dedupe] Starting deduplication",{textLength:g.length,textPreview:g.substring(0,300)});const t=`(?:${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)`,e=new RegExp(`(${t})\\s*:`,"g");let n=g,r="",a=0;const l=10;for(;n!==r&&a<l;){r=n,a++;const u=n;n=n.replace(e,(f,p,y)=>{const v=IA(p),S=n.substring(Math.max(0,y-500),y);v.toLowerCase();const C=v.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(`(${C})(?:\\s+\\1)+\\s*:`,"g").test(S+f)&&console.log("[Dedupe] Found repeated full name",{original:f,cleaned:v+" :",beforeMatch:S.substring(Math.max(0,S.length-100))}),v+" :"});const h=new RegExp(`(${t})\\s+\\1(?:\\s+\\1)*\\s*:`,"g");n=n.replace(h,(f,p)=>{const y=IA(p)+" :";return f!==y&&console.log("[Dedupe] Found repeated pattern",{original:f,cleaned:y}),y}),n!==u&&console.log("[Dedupe] Iteration changed result",{iteration:a,changed:!0,resultPreview:n.substring(0,300)})}return console.log("[Dedupe] Deduplication complete",{iterations:a,originalLength:g.length,resultLength:n.length,resultPreview:n.substring(0,300)}),n}function FA(g){let t=g.trim();return t=t.replace(/\([0-9]{1,2}:[0-9]{2}\)\s*/g," "),t=t.replace(/\s+/g," "),t=Fy(t),t=t.replace(/Topics?:[A-Za-z\s]*$/i,""),t=t.replace(/Topics?:\s*No\s+items\s+found.*$/i,""),t=t.replace(/Hungry\s+For\s+More\?.*$/i,""),t=t.replace(/Luckily\s+for\s+you.*$/i,""),t=t.replace(/Subscribe\s+to\s+our\s+blog.*$/i,""),t=t.replace(/Thank\s+You\s+for\s+Subscribing!.*$/i,""),t=t.replace(/A\s+confirmation\s+email.*$/i,""),t=t.replace(/\[inaudible[^\]]*\]/gi," "),t=t.replace(/Transcripts\s+Home.*$/i,""),t=t.replace(/Read\s+the\s+transcript\s+here.*$/i,""),t=t.replace(/NY\s+Governor.*unveil.*$/i,""),t=t.replace(/path\s+to\s+statewide.*$/i,""),t=t.replace(/.*\s+\|\s+Rev.*$/i,""),t=t.replace(/Help\s+Center\s+Developers.*$/i,""),t=t.replace(/Contact\s+Support.*$/i,""),t=t.replace(/Human-Verified.*$/i,""),t=t.replace(/AI\s+Platform\s+Features.*$/i,""),t=t.replace(/Premium\s+Tools.*$/i,""),t=t.replace(/Industries.*$/i,""),t=t.replace(/Resources.*$/i,""),t=t.replace(/Blog\s+Home.*$/i,""),t=t.replace(/Copyright\s+Disclaimer.*$/i,""),t=t.replace(/Under\s+Title\s+17.*$/i,""),t=t.replace(/fair\s+use.*$/i,""),t=t.replace(/\s+/g," "),t=t.replace(/&amp;/g,"&"),t=t.replace(/&#x27;/g,"'"),t=t.replace(/&#39;/g,"'"),t=t.replace(/&quot;/g,'"'),t=t.replace(/&lt;/g,"<"),t=t.replace(/&gt;/g,">"),t.trim()}function ox(g){const t=new RegExp(`^((${ce})?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+))\\s+\\([0-9]{1,2}:[0-9]{2}\\):`),e=new RegExp(`^((${ce})?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+))\\s*:`);let n=g.match(t),r=!0;if(n||(n=g.match(e),r=!1),!n)return null;const a=n[1].trim(),l=n[0],u=new RegExp(`^(${ce})`),h=l.match(u);h&&h[1].trim();const f=new RegExp(`(?:${ce})?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)`),p=l.match(f),y=p?p[1].trim():"";if(/^speaker\b/i.test(y)){const k=r?a.replace(new RegExp("\\s+\\([0-9]{1,2}:[0-9]{2}\\):\\s*$"),"").trim():a.replace(/:\s*$/,"").trim();return{fullName:a,fullNameWithoutTimestamp:k,shortNames:[y.replace(/^speaker/i,"Speaker")]}}const v=y.split(/\s+/).filter(Boolean);if(v.length===0)return null;const S=a,C=y,E=[];if(v.length>=2){const k=v[0],T=v[v.length-1];E.push(k),E.push(T),E.push(`${k} ${T}`)}else E.push(v[0]);return{fullName:S,fullNameWithoutTimestamp:C,shortNames:E}}function wP(g){var a;let t=g.replace(/[\u201C\u201D]/g,'"').replace(/[\u2018\u2019]/g,"'");console.log("[Word Split] splitTranscriptWords called",{textPreview:t.substring(0,200),textLength:t.length});const e=t.match(new RegExp(`^((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}(?::[0-9]{2})?\\)\\s*:\\s*)(.*)$`,"i")),n=t.match(new RegExp(`^((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|Speaker\\s+[0-9]+)\\s*:\\s*)(.*)$`,"i")),r=e||n;if(r){let l=r[1].trim();const u=((a=r[r.length-1])==null?void 0:a.trim())||"";console.log("[Word Split] Found speaker line",{fullSpeakerLine:l,contentPreview:u.substring(0,50)}),l=Fy(l);const h=IA(l.replace(/:\s*$/,"").trim());console.log("[Word Split] After deduplication",{original:r[1].trim(),deduplicated:h});const f=h.match(new RegExp(`^(${ce})`,"i")),p=f?f[1].trim():"",y=new RegExp(`(?:${ce})?(Speaker\\s+[0-9]+|[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3})`,"i"),v=h.match(y),S=v?v[1].trim():"",C=[];if(p&&S?(C.push(p),C.push(S+":"),console.log("[Word Split] Split into title and name",{titlePart:p,namePart:S+":"})):S?(C.push(S+":"),console.log("[Word Split] Split into name only",{namePart:S+":"})):(C.push(h+":"),console.log("[Word Split] Using full speaker line",{fullSpeakerLine:h+":"})),u){const E=u.split(/\s+/).filter(Boolean);C.push(...E),console.log("[Word Split] Added content words",{contentWordCount:E.length})}return console.log("[Word Split] Final words array",{wordCount:C.length,firstWords:C.slice(0,5)}),C}return t.split(/\s+/).filter(Boolean)}function AP(g){return g.flatMap(t=>t.words)}function ow(g,t){let e=0;for(let n=0;n<g.length;n+=1){const r=g[n];if(t<e+r.words.length)return{wordIndex:t-e,paragraphIndex:n};e+=r.words.length}return{wordIndex:0,paragraphIndex:0}}const SP=()=>{const[g,t]=Jt.useState(""),[e,n]=Jt.useState([]),[r,a]=Jt.useState([]),[l,u]=Jt.useState(350),[h,f]=Jt.useState(!1),[p,y]=Jt.useState(0),[v,S]=Jt.useState(!1),[C,E]=Jt.useState(!1),[k,T]=Jt.useState(!1),[L,P]=Jt.useState(!1),[M,D]=Jt.useState(null),[I,U]=Jt.useState(!1),[$,G]=Jt.useState(null),[nt,et]=Jt.useState("system-ui"),[Ct,_t]=Jt.useState(5),[wt,kt]=Jt.useState("#ff4e4e"),[ot,st]=Jt.useState(new Map),V=Y=>Y*.015-.05,dt=[{value:"system-ui",label:"System UI",example:"The quick brown"},{value:"Georgia, serif",label:"Georgia",example:"The quick brown"},{value:"'Times New Roman', Times, serif",label:"Times New Roman",example:"The quick brown"},{value:"Arial, Helvetica, sans-serif",label:"Arial",example:"The quick brown"},{value:"'Courier New', Courier, monospace",label:"Courier New",example:"The quick brown"},{value:"Verdana, Geneva, sans-serif",label:"Verdana",example:"The quick brown"},{value:"'Trebuchet MS', sans-serif",label:"Trebuchet MS",example:"The quick brown"},{value:"'Comic Sans MS', cursive",label:"Comic Sans MS",example:"The quick brown"},{value:"'Roboto', sans-serif",label:"Roboto",example:"The quick brown"},{value:"'Open Sans', sans-serif",label:"Open Sans",example:"The quick brown"}],Z=Jt.useRef(null),O=Jt.useRef(null),H=Jt.useRef(null),lt=Jt.useRef(null),Tt=Jt.useRef(null),bt=Jt.useRef(null),[Mt,Pt]=Jt.useState(0),Et=r.length>0,ae=["Mr","Mrs","Ms","Miss","Dr","Prof","Professor","Governor","Mayor","Senator","Representative","Congressman","Congresswoman","King","Queen","Prince","Princess","Duke","Duchess","Sir","Madam","Madame","Lord","Lady","President","Vice President","Secretary","General","Admiral","Colonel","Major","Captain","Lieutenant","Sergeant","Chief","Judge","Justice","Ambassador","Minister","Chancellor","Premier","Prime Minister"],We=Y=>{if(!Y)return!1;const W=Y.replace(/\./g,"").trim().toLowerCase();return ae.some(gt=>gt.toLowerCase()===W)},es=Y=>Y.replace(/^[^A-Za-z0-9'-]+/,"").replace(/[^A-Za-z0-9'-]+$/,"").trim(),Li=Y=>{const W=r[Y]??"";if(!W||!e.length)return{display:W,advance:1};const gt=ow(e,Y),Nt=e[gt.paragraphIndex],Vt=gt.wordIndex,xt=Nt.words[Vt]??"",Gt=Nt.words[Vt+1]??"";if(xt&&Gt){const Ce=es(xt),_e=es(Gt);if(Ce&&_e&&!We(Ce)&&!We(_e)){const se=`${Ce} ${_e}`;if(ot.has(se))return{display:`${xt} ${Gt}`,advance:2}}}return{display:xt||W,advance:1}},Ir=Y=>{const W=Math.max(Y-1,0);return W<=0?W:Li(W-1).advance===2?W-1:W},Bo=Jt.useMemo(()=>Et?r[p]:"",[Et,r,p]),Ls=Jt.useMemo(()=>!Et||!Bo?"":Li(p).display,[Bo,ot,e,p,Et,r]),rd=Jt.useMemo(()=>Ls?yP(Ls):0,[Ls]),Uo=Jt.useMemo(()=>{if(!Ls)return{left:"",pivot:"",right:""};const Y=Math.min(Math.max(rd,0),Ls.length-1);return{left:Ls.slice(0,Y),pivot:Ls.charAt(Y),right:Ls.slice(Y+1)}},[Ls,rd]),zo=Jt.useMemo(()=>{if(!e.length||!Et)return null;const Y=ow(e,p),W=e[Y.paragraphIndex],gt=W.words.slice(0,Y.wordIndex),Nt=W.words[Y.wordIndex]??"",Vt=W.words.slice(Y.wordIndex+1);return{paragraphIndex:Y.paragraphIndex,before:gt.join(" "),active:Nt,after:Vt.join(" ")}},[e,Et,p]),Fr=Jt.useMemo(()=>l<=0?0:6e4/l|0,[l]);Jt.useEffect(()=>{if(!h||!Et||Fr<=0){Z.current!==null&&(window.clearInterval(Z.current),Z.current=null);return}return O.current=performance.now(),Z.current=window.setInterval(()=>{y(Y=>{if(Y>=r.length-1)return f(!1),Y;const W=Li(Y).advance;return Math.min(Y+W,r.length-1)})},Fr),()=>{Z.current!==null&&(window.clearInterval(Z.current),Z.current=null)}},[h,Et,Fr,r.length,e,ot,r]),Jt.useEffect(()=>{if(!Et||!H.current||!lt.current||!Tt.current){Pt(0);return}const Y=H.current.offsetWidth,W=lt.current.offsetWidth,gt=Tt.current.offsetWidth,Nt=Y+W+gt,Vt=Y+W/2,Gt=Nt/2-Vt;Pt(Gt)},[Ls,Uo,Et]),Jt.useEffect(()=>{h&&Et&&Fr>0&&f(!1)},[Fr]);const Ms=Y=>{const W=l0(Y),gt=new Map,Nt=new Set(["the","a","an","if","and","or","but","to","of","in","on","for","with","at","from","by","as","this","that","these","those"]);console.log("[Speaker Names] Extracting from original text",{textLength:W.length});const Vt=new RegExp(`((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}(?::[0-9]{2})?\\)\\s*:\\s*)`,"g"),xt=W.matchAll(Vt);for(const _e of xt){const se=_e[1].trim();console.log("[Speaker Names] Found speaker line in original text",{speakerLine:se});const At=ox(se);if(At&&(console.log("[Speaker Names] Extracted speaker info",{fullName:At.fullName,fullNameWithoutTimestamp:At.fullNameWithoutTimestamp,shortNames:At.shortNames}),At.shortNames.forEach(Ft=>{const Yt=Ft.trim(),Ot=Yt.toLowerCase();if(!Yt||Nt.has(Ot))return;const le=gt.get(Ft);(!le||At.fullNameWithoutTimestamp.length>le.length)&&gt.set(Ft,At.fullNameWithoutTimestamp)}),gt.set(At.fullName,At.fullNameWithoutTimestamp),gt.set(At.fullNameWithoutTimestamp,At.fullNameWithoutTimestamp),At.fullName.includes("Speaker"))){const Ft=At.fullName.match(/Speaker\s+(\d+)/i);if(Ft){const Yt=Ft[1];gt.set(Yt,At.fullNameWithoutTimestamp)}}}const Gt=vP(W);console.log("[Speaker Names] Also checking cleaned paragraphs",{paragraphCount:Gt.length}),Gt.forEach((_e,se)=>{const At=_e.raw,Ft=new RegExp(`^((${ce})?([A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+))\\s*:`),Yt=At.match(Ft);if(Yt&&se<10){console.log("[Speaker Names] Found speaker in cleaned text",{index:se,match:Yt[0],rawPreview:At.substring(0,100)});const Ot=ox(At);if(Ot&&(console.log("[Speaker Names] Extracted from cleaned text",{fullName:Ot.fullName,fullNameWithoutTimestamp:Ot.fullNameWithoutTimestamp,shortNames:Ot.shortNames}),Ot.shortNames.forEach(le=>{const Ln=le.trim(),ps=Ln.toLowerCase();if(!Ln||Nt.has(ps))return;const Ds=gt.get(le);(!Ds||Ot.fullNameWithoutTimestamp.length>Ds.length)&&gt.set(le,Ot.fullNameWithoutTimestamp)}),gt.set(Ot.fullName,Ot.fullNameWithoutTimestamp),gt.set(Ot.fullNameWithoutTimestamp,Ot.fullNameWithoutTimestamp),Ot.fullName.includes("Speaker"))){const le=Ot.fullName.match(/Speaker\s+(\d+)/i);if(le){const Ln=le[1];gt.set(Ln,Ot.fullNameWithoutTimestamp)}}}}),console.log("[Speaker Names] Final extracted speaker names",{nameMapSize:gt.size,names:Array.from(gt.entries())}),st(gt);const Ce=AP(Gt);n(Gt),a(Ce),y(0),f(!1),E(!0)},jo=()=>{t(""),n([]),a([]),y(0),f(!1),E(!1),P(!1),D(null),U(!1),G(null),st(new Map)},od=()=>{Et&&f(Y=>!Y)},Cg=()=>{Et&&y(0)},ad=Y=>{Et&&y(W=>{if(Y===-1)return Math.min(Math.max(Ir(W),0),r.length-1);const gt=Li(W).advance;return Math.min(Math.max(W+gt,0),r.length-1)})},ld=Y=>{if(!e.length||!Et)return;const W=ow(e,p),gt=Math.min(Math.max(W.paragraphIndex+Y,0),e.length-1);let Nt=0;for(let Vt=0;Vt<gt;Vt+=1)Nt+=e[Vt].words.length;y(Nt)},_g=()=>{if(!g.trim()){n([]),a([]),y(0),f(!1);return}const Y=ix(g);if(Y){t(Y),$&&G(null),I||hd(Y);return}Ms(g)},cd=()=>{setTimeout(()=>{var gt;const Y=((gt=bt.current)==null?void 0:gt.value)||g;if(!Y.trim()){n([]),a([]),y(0),f(!1);return}const W=ix(Y);if(W){t(W),$&&G(null),I||hd(W);return}Ms(Y)},0)},Mi=Y=>{const W=Y.trim();if(W.length<3)return!0;if(W.match(/\([0-9]{1,2}:[0-9]{2}\):/)||W.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i")))return!1;if([/^copyright\s+disclaimer/i,/^share\s+this\s+post/i,/^thank\s+you\s+for\s+subscribing/i,/^thank\s+you\s+for\s+subscribing!/i,/^a\s+confirmation\s+email\s+is\s+on\s+its?\s+way/i,/^confirmation\s+email/i,/^hungry\s+for\s+more/i,/^hungry\s+for\s+more\?/i,/^subscribe\s+to\s+our\s+blog/i,/^subscribe\s+to\s+our\s+blog\s+today/i,/^luckily\s+for\s+you/i,/^we\s+deliver/i,/^keep\s+reading/i,/^read\s+trending\s+articles/i,/^help\s+center/i,/^contact\s+support/i,/^contact\s+support\s*\|/i,/^log\s+in$/i,/^get\s+started$/i,/^request\s+a\s+demo$/i,/^product\s+back\s+to\s+menu/i,/^industries\s+back\s+to\s+menu/i,/^resources\s+back\s+to\s+menu/i,/^about\s+rev$/i,/^pricing$/i,/^legal\s+security\s+terms/i,/^privacy\s+policy/i,/^sitemap$/i,/^reviews$/i,/^\s*rev\.com/i,/^topics?:$/i,/^topics?:[A-Za-z\s]*$/i,/^topics?:\s*no\s+items\s+found/i,/^transcripts\s+home/i,/^transcripts\s+home\s+news/i,/^read\s+the\s+transcript\s+here/i,/^linkedin\s*$/i,/^facebook\s*$/i,/^x\s+logo\s*$/i,/^pinterest\s*$/i,/^reddit\s+logo\s*$/i,/^email\s*$/i,/^services\s*$/i,/^integrations\s*$/i,/^blog\s*$/i,/^blog\s+home/i,/^developers\s*$/i,/^careers\s*$/i,/^freelancers\s*$/i,/^press\s*$/i,/^support\s*$/i,/^youtube\s*$/i,/^instagram\s*$/i,/^spotify\s*$/i,/^apple\s*$/i,/^the\s+rev\s+logo\s+icon\.\s*$/i,/^under\s+title\s+17/i,/^fair\s+use/i,/^fair\s+use\s+is\s+permitted/i,/^allowance\s+is\s+made/i,/^copyright\s+statute/i,/^might\s+otherwise\s+be\s+infringing/i,/^rev's\s+logo$/i,/^human-verified/i,/^human-verified\s+&/i,/^human\s+transcription\s+expert/i,/^ai\s+platform\s+features$/i,/^premium\s+tools/i,/^premium\s+tools\.\s+premium\s+perks/i,/^multi-file\s+analysis$/i,/^subscribe\s+to\s+the\s+rev\s+blog/i,/^sign\s+up\s+to\s+get/i,/^content\s+delivered\s+straight/i,/^\[inaudible/i,/^ny\s+governor\s+.*\s+and\s+nyc\s+mayor/i,/^unveil\s+a\s+new\s+free\s+child\s+care/i,/^path\s+to\s+statewide\s+universal\s+childcare/i,/^.*\s+\|\s+rev$/i,/^help\s+center\s+developers\s+security/i,/^human\s+transcription\s+expert\s+human\s+transcription/i,/^human\s+captions/i,/^court\s+reporting\s+self-service/i,/^global\s+subtitles/i,/^view\s+all\s+pay-per-minute\s+services/i,/^transcription,\s+captions/i,/^ai\s+transcription/i,/^ai\s+notetaker/i,/^ai\s+captions/i,/^rev\s+mobile\s+app/i,/^view\s+all\s+ai\s+features/i,/^save\s+on\s+human\s+transcription/i,/^spot\s+inconsistencies/i,/^industries\s+legal/i,/^criminal\s+prosecution/i,/^eliminate\s+evidence\s+backlogs/i,/^criminal\s+defense/i,/^cut\s+hours\s+of\s+review/i,/^investigators/i,/^turn\s+piles\s+of\s+evidence/i,/^civil\s+law/i,/^build\s+stronger\s+cases/i,/^court\s+reporting\s+agencies/i,/^a\s+trusted\s+partner/i,/^smartdepo/i,/^ai\s+summaries/i,/^resources\s+blog/i,/^expert\s+insights/i,/^latest\s+news\s+about\s+rev/i,/^reports\s+&\s+guides/i,/^whitepapers/i,/^learning\s+center/i,/^guides\s+and\s+tutorials/i,/^transcript\s+library/i,/^free\s+transcripts/i,/^case\s+studies/i,/^discover\s+how\s+rev/i,/^trusted\s+feedback/i,/^the\s+rough\s+draft/i,/^where\s+journalists/i,/^partners/i,/^discover\s+our\s+bar\s+association/i,/^we're\s+hiring/i,/^ambitious\s+team\s+members/i,/^how\s+law\s+enforcement/i,/^court\s+hearing\s+types/i,/^state\s+bar\s+of\s+texas/i,/^legal\s+professionals\s+are\s+burned\s+out/i,/^transcription\s+closed\s+captions/i,/^accessibility\s+technology/i,/^thank\s+you!\s+your\s+submission/i,/^oops!\s+something\s+went\s+wrong/i,/^2024\s+election/i,/^ai\s+&\s+speech\s+recognition/i,/^artificial\s+intelligence/i,/^automated\s+transcription/i,/^congressional\s+testimony/i,/^customer\s+features/i,/^historical\s+speeches/i,/^how-to\s+guides/i,/^rev\s+spotlight/i,/^speech\s+to\s+text\s+technology/i,/^surveys\s+and\s+data/i,/^video\s+editing/i,/^ny\s+universal\s+childcare\s+announcement$/i,/^ny\s+universal\s+childcare\s+announcement\s+ny\s+universal/i,/^transcripts\s+home\s+news\s+ny\s+universal/i,/^transcripts\s+home\s+news$/i,/^keep\s+reading$/i,/^greenland\s+mineral/i,/^trump\s+at\s+the\s+detroit/i,/^ny\s+state\s+of\s+the\s+state/i,/^supreme\s+court\s+hearing/i,/^nurse\s+strike/i,/^u\.n\.\s+humanitarian/i,/^subscribe\s+to\s+the\s+rev\s+blog/i,/^sign\s+up\s+to\s+get/i,/^the\s+rev\s+logo/i].some(Nt=>Nt.test(W))||W.match(/^topics?:[A-Za-z\s]+$/i)||W.match(/^transcripts\s+home\s+news/i)||(W.includes("&amp;")||W.includes("&#x27;")||W.includes("&#39;"))&&!W.match(/\([0-9]{1,2}:[0-9]{2}\):/)&&!W.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"))||W.match(/^\d+\(\d{3}\)\s+\d{3}-\d{4}/)||W.match(/^view\s+all/i)&&W.length<50||W.match(/^transcripts\s+home\s+news\s+ny\s+universal\s+childcare/i)||W.match(/^transcripts\s+home\s+news\s+ny\s+universal\s+childcare\s+announcement/i)||W.match(/^ny\s+universal\s+childcare\s+announcement\s+ny\s+universal\s+childcare\s+announcement/i)||W.match(/^ny\s+governor\s+kathy\s+hochul\s+and\s+nyc\s+mayor/i)&&!W.match(/\([0-9]{1,2}:[0-9]{2}\):/)||W.match(/^kathy\s+hochul\s+speaks\s+to\s+the\s+press/i)||W.match(/^share\s+this\s+post\s+topics?:/i)||W.match(/^topics?:\s*no\s+items\s+found\.\s*hungry\s+for\s+more/i)||W.match(/^keep\s+reading/i)&&W.length<100||W.length<3)return!0;if(W.length<10&&!W.match(/\([0-9:]+\)/)&&!W.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"))){const Nt=/[.!?]/.test(W),Vt=/^[A-Z]/.test(W);if(!Nt&&!Vt)return!0}return!1},ud=Y=>{const W=Y.trim();return[new RegExp(`^${ce}(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3})\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"),/^[A-Z][a-z]+(?:\s+[A-Z][a-z]+)+\s+\([0-9]{1,2}:[0-9]{2}\):/,/^[A-Z][a-z]+\s+\([0-9]{1,2}:[0-9]{2}\):/,/^[A-Z][a-z]+(?:\s+[A-Z][a-z]+)+\s*\([0-9]{1,2}:[0-9]{2}\):/,/^Speaker\s+[0-9]+\s+\([0-9]{1,2}:[0-9]{2}\):/i].some(Nt=>Nt.test(W))},Ho=Y=>{console.log("[URL Parse] splitTranscriptBySpeakers called",{textLength:Y.length});const W=[],gt=new RegExp(`((${ce})?(?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3}|[Ss]peaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):\\s*)`,"g"),Nt=Array.from(Y.matchAll(gt)).filter(Ft=>Ft.index!==void 0),Vt=Ft=>{const Yt=FA(Ft);Yt&&Yt.length>0&&W.push(Yt)},xt=Ft=>{const Ot=Ft.trim().match(new RegExp(`^(?:${ce})?((?:[A-Z][a-z]+(?:\\s+[A-Z][a-z]+){0,3})|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"));return Ot?Ot[1].trim():null},Gt=Ft=>Ft.replace(/^[\u2026]+/g,"").replace(/^\.{3,}/g,"").trim();if(Nt.length===0){const Ft=FA(Y);return Ft?[Ft]:[]}const Ce=Y.slice(0,Nt[0].index).trim();if(Ce&&!Mi(Ce)){const Ft=Ce.split(/\n{2,}/).map(Yt=>Yt.trim()).filter(Boolean);Ft.length?Ft.forEach(Vt):Vt(Ce)}let _e="",se=null;for(let Ft=0;Ft<Nt.length;Ft++){const Yt=Nt[Ft].index,Ot=Ft<Nt.length-1?Nt[Ft+1].index:Y.length,le=Nt[Ft][0]||"",Ln=xt(le),ps=Y.slice(Yt,Ot).trim();if(!ps||Mi(ps))continue;const Ds=ps.slice(le.length).trimStart();if(Ln&&se&&Ln.toLowerCase()===se.toLowerCase()){const gs=Gt(Ds);gs&&(_e=(_e?`${_e} ${gs}`:gs).trim());continue}_e&&Vt(_e),se=Ln,_e=Ds?`${le.trim()} ${Ds}`.trim():le.trim()}_e&&Vt(_e),console.log("[URL Parse] Paragraphs collected from transcript split",{paragraphCount:W.length});const At=W.filter(Ft=>{const Yt=Ft.trim();return Yt.length===0?!1:Yt.match(/\([0-9]{1,2}:[0-9]{2}\):/)||Yt.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"))?!0:Mi(Yt)?!1:Yt.length>5});return console.log("[URL Parse] Transcript paragraphs filtered",{originalCount:W.length,filteredCount:At.length}),At},il=Y=>{var W,gt,Nt,Vt,xt,Gt,Ce,_e,se,At,Ft;console.log("[URL Parse] parseHtmlToText called",{htmlLength:Y.length,htmlFirstChars:Y.substring(0,200)});try{const Ot=new DOMParser().parseFromString(Y,"text/html"),le=((W=Ot.body)==null?void 0:W.textContent)||"",Ln=le.match(/\([0-9]{1,2}:[0-9]{2}\):/g);console.log("[URL Parse] HTML parsed into DOM",{bodyTextLength:le.length,bodyTextPreview:le.substring(0,300),hasBody:!!Ot.body,title:Ot.title||"no title",bodyTimestampCount:Ln?Ln.length:0,bodyTimestampsSample:Ln?Ln.slice(0,10):[]});const ps=Ot.querySelectorAll("script, style, noscript, iframe, embed, object, svg, canvas, nav, header, footer, aside, .nav, .navigation, .menu, .sidebar, .sidebar-content, .advertisement, .ads, .ad, [class*='ad-'], [id*='ad-'], .social, .share, .comments, .comment-section, .cookie, .cookie-banner, .newsletter, .subscribe, .footer, .header, .site-header, .site-footer, [class*='footer'], [class*='header'], [id*='footer'], [id*='header'], .breadcrumb, .breadcrumbs, .related, .related-posts, .tags, .categories, .meta, .post-meta, form, button, input, select, textarea, [class*='product'], [class*='industries'], [class*='resources'], [class*='help-center'], [class*='contact'], [class*='login'], [class*='get-started'], [class*='request-demo'], [class*='human-verified'], [class*='ai-platform'], [class*='premium-tools'], [class*='multi-file'], [class*='transcripts-home'], a[href*='#'], a[href*='javascript']");console.log("[URL Parse] Elements to remove identified",{count:ps.length});const Ds=(Nt=(gt=Ot.body)==null?void 0:gt.textContent)==null?void 0:Nt.match(/\([0-9]{1,2}:[0-9]{2}\):/g);console.log("[URL Parse] Timestamps before removing elements",{count:Ds?Ds.length:0,sample:Ds?Ds.slice(0,10):[]}),ps.forEach(it=>{const ut=it.textContent||"",ie=ut.match(/\([0-9]{1,2}:[0-9]{2}\):/g),Ze=ie&&ie.length>=2,Je=it.id==="main-content"||it.id==="transcript-content"||it.id==="content";if(Ze||Je){console.log("[URL Parse] PRESERVING element with transcript content",{tagName:it.tagName,className:it.className||"none",id:it.id||"none",timestampCount:ie?ie.length:0,timestamps:ie?ie.slice(0,5):[],textPreview:ut.substring(0,300),reason:Ze?"has transcript timestamps":"has main content ID"});return}ie&&ie.length>0&&console.log("[URL Parse] Removing element with timestamps (but < 2, so likely not transcript)",{tagName:it.tagName,className:it.className||"none",id:it.id||"none",timestampCount:ie.length,timestamps:ie.slice(0,5),textPreview:ut.substring(0,200)}),it.remove()});const gs=(xt=(Vt=Ot.body)==null?void 0:Vt.textContent)==null?void 0:xt.match(/\([0-9]{1,2}:[0-9]{2}\):/g);console.log("[URL Parse] Timestamps after removing elements",{count:gs?gs.length:0,sample:gs?gs.slice(0,10):[]});const Gc=Ot.createTreeWalker(Ot.body,NodeFilter.SHOW_TEXT,null),rl=[];let ol;for(;ol=Gc.nextNode();)ol.nodeType===Node.TEXT_NODE&&rl.push(ol);rl.forEach(it=>{let ut=it.textContent||"";(ut.includes("&amp;")||ut.includes("&#x27;")||ut.includes("&#39;"))&&(ut=ut.replace(/&amp;/g,"&"),ut=ut.replace(/&#x27;/g,"'"),ut=ut.replace(/&#39;/g,"'"),ut=ut.replace(/&quot;/g,'"'),it.textContent=ut)});let $n=null;const u0=["#main-content","#transcript-content","#content","[class*='transcript']","[id*='transcript']","[class*='content']","article","main","[role='main']",".article",".post",".entry",".story"];console.log("[URL Parse] Searching for transcript container"),console.log("[URL Parse] Body text sample (first 2000 chars):",le.substring(0,2e3)),console.log("[URL Parse] Body text sample (last 2000 chars):",le.substring(Math.max(0,le.length-2e3)));for(const it of u0){const ut=Ot.querySelector(it);if(ut){const ie=ut.textContent||"",Ze=((Gt=ie.split(`
`)[0])==null?void 0:Gt.trim())||"",Je=ud(Ze),rn=ie.match(new RegExp(`(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+\\s+)\\([0-9]{1,2}:[0-9]{2}\\):`,"i")),tn=ie.match(/\([0-9]{1,2}:[0-9]{2}\):/),An=ie.match(/\([0-9]{1,2}:[0-9]{2}\):/g);if(console.log("[URL Parse] Checking selector",{selector:it,found:!!ut,textLength:ie.length,textPreview:ie.substring(0,500),firstLine:Ze,hasTranscriptLine:Je,hasTranscriptPattern:!!rn,hasTimestamp:!!tn,timestampMatches:An,timestampCount:An?An.length:0,elementTagName:ut.tagName,elementClassName:ut.className,elementId:ut.id}),Je||rn||tn){$n=ut,console.log("[URL Parse] Transcript container found",{selector:it,textLength:ie.length,timestampCount:An?An.length:0});break}}else console.log("[URL Parse] Selector not found",{selector:it})}if(!$n){$n=Ot.body;const it=((Ce=Ot.body)==null?void 0:Ce.textContent)||"",ut=it.match(/\([0-9]{1,2}:[0-9]{2}\):/g);console.log("[URL Parse] No transcript container found, using body",{originalBodyTextLength:le.length,currentBodyTextLength:it.length,bodyTextSample:it.substring(0,1e3),allTimestampsInBody:ut,timestampCount:ut?ut.length:0,bodyChildren:Array.from(((_e=Ot.body)==null?void 0:_e.children)||[]).map(ie=>{var Ze,Je;return{tagName:ie.tagName,className:ie.className||"none",id:ie.id||"none",textLength:((Ze=ie.textContent)==null?void 0:Ze.length)||0,hasTimestamps:!!((Je=ie.textContent)!=null&&Je.match(/\([0-9]{1,2}:[0-9]{2}\):/g))}})})}const h0=$n.querySelectorAll("*");for(const it of h0){const ut=((se=it.textContent)==null?void 0:se.trim())||"";ut&&(ut.match(/^transcripts\s+home\s+news/i)||ut.match(/^ny\s+universal\s+childcare\s+announcement\s+ny\s+universal/i)||ut.match(/^help\s+center\s+developers\s+security/i)||ut.match(/^contact\s+support/i)||ut.match(/^human-verified/i)&&!ut.match(/\([0-9]{1,2}:[0-9]{2}\):/)||ut.match(/^ai\s+platform\s+features$/i)&&!ut.match(/\([0-9]{1,2}:[0-9]{2}\):/))&&(ut.match(/\([0-9]{1,2}:[0-9]{2}\):/)||it.remove())}const he=$n.textContent||"",$o=he.match(/\([0-9]{1,2}:[0-9]{2}\):/g),Xc=he.match(new RegExp(`(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+\\s+)\\([0-9]{1,2}:[0-9]{2}\\):`,"gi"));console.log("[URL Parse] Full text extracted from container",{fullTextLength:he.length,fullTextPreview:he.substring(0,2e3),fullTextFirstChars:he.substring(0,500),fullTextLastChars:he.substring(Math.max(0,he.length-500)),lineCount:he.split(`
`).length,allTimestamps:$o,timestampCount:$o?$o.length:0,timestampLocations:$o?$o.map(it=>{const ut=he.indexOf(it);return{timestamp:it,index:ut,context:he.substring(Math.max(0,ut-50),Math.min(he.length,ut+100))}}).slice(0,5):[],speakerPatternMatches:Xc,speakerPatternCount:Xc?Xc.length:0,containerTagName:$n.tagName,containerClassName:$n.className||"none",containerId:$n.id||"none",containerChildrenCount:$n.children.length,containerInnerHTMLLength:((At=$n.innerHTML)==null?void 0:At.length)||0});const nr=he.match(new RegExp(`(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+\\s+)\\([0-9]{1,2}:[0-9]{2}\\):`,"gi")),dd=nr&&nr.length>=2,Di=he.match(/\([0-9]{1,2}:[0-9]{2}\):/g),fd=Di&&Di.length>=3;if(console.log("[URL Parse] Transcript format detection",{transcriptLineMatchesCount:(nr==null?void 0:nr.length)||0,transcriptLineMatchesPreview:(nr==null?void 0:nr.slice(0,5))||[],hasTranscriptFormat:dd,allTimestampMatchesCount:(Di==null?void 0:Di.length)||0,allTimestampMatchesPreview:(Di==null?void 0:Di.slice(0,10))||[],hasMultipleTimestamps:fd,fullTextSample:he.substring(0,1e3)}),dd||fd){console.log("[URL Parse] Processing as transcript format");const it=Ho(he);if(console.log("[URL Parse] Transcript paragraphs split",{paragraphCount:it.length}),it.length>0){let ut=it.join(`

`);return ut=Fy(ut),console.log("[URL Parse] Returning transcript paragraphs",{resultLength:ut.length}),ut}}const pd=he.match(/\([0-9]{1,2}:[0-9]{2}\):/);if(console.log("[URL Parse] Checking for any transcript line",{hasAnyTranscriptLine:!!pd}),pd){console.log("[URL Parse] Processing as transcript with single timestamp");const it=Ho(he);if(console.log("[URL Parse] Transcript paragraphs split (single timestamp)",{paragraphCount:it.length}),it.length>0){let ut=it.join(`

`);return ut=Fy(ut),console.log("[URL Parse] Returning transcript paragraphs (single timestamp)",{resultLength:ut.length}),ut}}const ns=[],qc=new Set,Ne=(it,ut=0)=>{var Ze,Je;const ie=Array.from(it.children);if(ie.length===0){const rn=((Ze=it.textContent)==null?void 0:Ze.trim())||"";if(rn&&rn.length>5){const tn=rn.match(/\([0-9]{1,2}:[0-9]{2}\):/)||rn.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"));(tn||!Mi(rn))&&(qc.has(rn)||(qc.add(rn),ns.push(rn),tn&&console.log("[URL Parse] Found paragraph with transcript marker",{depth:ut,textLength:rn.length,textPreview:rn.substring(0,200),tagName:it.tagName,className:it.className||"none"})))}return}for(const rn of ie){const tn=rn.tagName.toUpperCase(),An=((Je=rn.textContent)==null?void 0:Je.trim())||"";if(tn==="P"||tn==="DIV"&&An.length>20){if(An){const Pg=An.match(/\([0-9]{1,2}:[0-9]{2}\):/)||An.match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+)\\s+\\([0-9]{1,2}:[0-9]{2}\\):`,"i"));(Pg||!Mi(An))&&(qc.has(An)||(qc.add(An),ns.push(An),Pg&&ut<3&&console.log("[URL Parse] Found paragraph with transcript marker (P/DIV)",{depth:ut,tagName:tn,textLength:An.length,textPreview:An.substring(0,200),className:rn.className||"none"})))}}else Ne(rn,ut+1)}};if(console.log("[URL Parse] Starting paragraph collection from container",{containerTagName:$n.tagName,containerTextLength:((Ft=$n.textContent)==null?void 0:Ft.length)||0,containerChildrenCount:$n.children.length}),Ne($n),console.log("[URL Parse] Paragraphs collected",{paragraphCount:ns.length,paragraphsPreview:ns.slice(0,10).map((it,ut)=>({index:ut,length:it.length,preview:it.substring(0,150),firstChars:it.substring(0,100),hasTimestamp:!!it.match(/\([0-9]{1,2}:[0-9]{2}\):/),timestampCount:(it.match(/\([0-9]{1,2}:[0-9]{2}\):/g)||[]).length})),allParagraphLengths:ns.map(it=>it.length),paragraphsWithTimestamps:ns.filter(it=>it.match(/\([0-9]{1,2}:[0-9]{2}\):/)).length}),ns.length===0)return console.log("[URL Parse] No paragraphs found, returning full text",{fullTextLength:he.length,fullTextPreview:he.substring(0,500)}),he.trim();let Or=-1;for(let it=0;it<ns.length;it++)if(ud(ns[it])||ns[it].match(new RegExp(`^(?:${ce})?(?:[A-Z][a-z]+\\s+|Speaker\\s+[0-9]+\\s+)\\([0-9]{1,2}:[0-9]{2}\\):`,"i"))){Or=it,console.log("[URL Parse] Transcript start found (method 1)",{index:it});break}if(Or===-1){for(let it=0;it<ns.length;it++)if(ns[it].match(/\([0-9]{1,2}:[0-9]{2}\):/)){Or=it,console.log("[URL Parse] Transcript start found (method 2)",{index:it});break}}Or===-1&&(Or=0,console.log("[URL Parse] No transcript start found, using index 0"));const al=ns.slice(Or).filter(it=>{const ut=it.trim();return ut.length===0?!1:ut.match(/\([0-9]{1,2}:[0-9]{2}\):/)?!0:!Mi(ut)}).map(it=>it.trim()).filter((it,ut,ie)=>{if(ut===0)return!0;const Ze=ie[ut-1];return!(it===Ze||it.length<20&&Ze.includes(it)||Ze.length<20&&it.includes(Ze))});if(console.log("[URL Parse] Transcript paragraphs filtered",{transcriptParagraphsCount:al.length,transcriptStartIndex:Or}),al.length===0)return console.log("[URL Parse] No transcript paragraphs after filtering, returning full text"),he.trim();const gd=al.join(`

`);return console.log("[URL Parse] Returning final result",{resultLength:gd.length}),gd}catch(Yt){console.error("[URL Parse] HTML parsing error:",Yt),console.log("[URL Parse] Using fallback text extraction");const Ot=Y.replace(/<script[\s\S]*?<\/script>/gi,"").replace(/<style[\s\S]*?<\/style>/gi,"").replace(/<noscript[\s\S]*?<\/noscript>/gi,"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim();return console.log("[URL Parse] Fallback text extracted",{fallbackLength:Ot.length}),Ot}},kg=async(Y,W=0)=>{var Gt;const gt=[`https://api.allorigins.win/raw?url=${encodeURIComponent(Y)}`,`https://corsproxy.io/?${encodeURIComponent(Y)}`,`https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(Y)}`];if(console.log("[URL Parse] fetchWithProxy called",{url:Y,proxyIndex:W,totalProxies:gt.length,proxyService:((Gt=gt[W])==null?void 0:Gt.substring(0,50))+"..."}),W>=gt.length)throw console.log("[URL Parse] All proxy services exhausted",{attemptedProxies:gt.length}),new Error("All proxy services failed");const Nt=gt[W];console.log("[URL Parse] Attempting proxy fetch",{proxyIndex:W,proxyUrl:Nt.substring(0,100)+"...",targetUrl:Y});const Vt=await fetch(Nt,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"}}),xt=Vt.headers.get("content-type");return console.log("[URL Parse] Proxy fetch response",{proxyIndex:W,status:Vt.status,statusText:Vt.statusText,ok:Vt.ok,contentType:xt||"unknown",headers:Object.fromEntries(Vt.headers.entries())}),!Vt.ok&&W<gt.length-1?(console.log("[URL Parse] Proxy fetch failed, trying next proxy",{currentProxyIndex:W,nextProxyIndex:W+1}),kg(Y,W+1)):Vt},hd=async Y=>{var Nt,Vt;const W=(Y??g).trim();if(console.log("=== [URL Parse] handleUrlSubmit called ===",{rawText:W}),!W){console.log("[URL Parse] No URL provided, skipping submission");return}const gt=W;if(console.log("[URL Parse] Starting URL submission",{url:gt,urlLength:gt.length}),!gt.match(/^https?:\/\//i)){console.log("[URL Parse] Invalid URL format",{url:gt,urlLength:gt.length}),G("Please enter a valid URL starting with http:// or https://");return}U(!0),G(null),E(!1);try{let xt,Gt=!1;console.log("[URL Parse] Attempting direct fetch",{url:gt,urlLength:gt.length});try{xt=await fetch(gt,{headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"}});const At=xt.headers.get("content-type");console.log("[URL Parse] Direct fetch successful",{status:xt.status,statusText:xt.statusText,contentType:At||"unknown",ok:xt.ok,headers:Object.fromEntries(xt.headers.entries())})}catch(At){const Ft=At instanceof Error?At.message:String(At),Yt=String(At),Ot=At instanceof TypeError&&(Ft.includes("Failed to fetch")||Ft.includes("network")||Ft.includes("CORS")||Yt.includes("CORS")||Yt.includes("Access-Control"));if(console.log("[URL Parse] Direct fetch failed",{error:Ft,errorString:Yt,errorType:((Nt=At==null?void 0:At.constructor)==null?void 0:Nt.name)||typeof At,isCorsError:Ot,errorName:At instanceof Error?At.name:"Unknown"}),At instanceof Error&&console.log("[URL Parse] Error stack:",At.stack),Ot){console.log("[URL Parse] CORS error detected, retrying with proxy"),G("CORS detected. Retrying with proxy..."),Gt=!0,xt=await kg(gt);const le=xt.headers.get("content-type");console.log("[URL Parse] Proxy fetch successful",{status:xt.status,statusText:xt.statusText,contentType:le||"unknown",ok:xt.ok,usedProxy:!0})}else throw console.log("[URL Parse] Non-CORS error, rethrowing",{error:Ft}),At}if(!xt.ok)throw console.log("[URL Parse] HTTP error response",{status:xt.status,statusText:xt.statusText}),new Error(`HTTP error! status: ${xt.status}`);const Ce=xt.headers.get("content-type")||"",_e=Ce.includes("text/html");console.log("[URL Parse] Response content type determined",{contentType:Ce,isHtml:_e,contentLength:xt.headers.get("content-length")});const se=await xt.text();if(console.log("[URL Parse] Response text received",{htmlLength:se.length,htmlPreview:se.substring(0,200),htmlFirstChars:se.substring(0,100),htmlLastChars:se.substring(Math.max(0,se.length-100))}),_e){console.log("[URL Parse] Parsing HTML content");const At=il(se);if(console.log("[URL Parse] HTML parsing complete",{extractedTextLength:At.length,extractedTextPreview:At.substring(0,300),extractedTextFirstChars:At.substring(0,150),extractedTextLastChars:At.substring(Math.max(0,At.length-150)),wordCount:At.split(/\s+/).filter(Yt=>Yt.length>0).length}),!At.trim()){console.log("[URL Parse] No text content extracted from HTML"),G("No readable text content found on this page. The page may require JavaScript to load content."),U(!1);return}const Ft=At.split(/\s+/).filter(Yt=>Yt.length>0).length;console.log("[URL Parse] Setting extracted text and resetting reader",{extractedTextLength:At.length,wordCount:Ft,extractedTextPreview:At.substring(0,400),paragraphCount:At.split(/\n\n/).length}),t(At),Ms(At),E(!0)}else{if(console.log("[URL Parse] Non-HTML content, using as plain text",{htmlLength:se.length}),!se.trim()){console.log("[URL Parse] Empty text content"),G("No text content found at this URL."),U(!1);return}t(se),Ms(se),E(!0),console.log("[URL Parse] Plain text content loaded",{textLength:se.length,wordCount:se.split(/\s+/).length})}U(!1),console.log("[URL Parse] URL submission completed successfully")}catch(xt){console.error("[URL Parse] ===== ERROR CAUGHT IN OUTER CATCH =====",xt),console.log("[URL Parse] Error details",{error:xt,errorType:(Vt=xt==null?void 0:xt.constructor)==null?void 0:Vt.name,errorMessage:xt instanceof Error?xt.message:String(xt),errorString:String(xt),errorStack:xt instanceof Error?xt.stack:void 0});const Gt=xt instanceof Error?xt:new Error(String(xt));let Ce;Gt.message.includes("All proxy services failed")?Ce="Failed to fetch URL: All proxy services are unavailable. The URL may be blocked or inaccessible.":Gt instanceof TypeError&&Gt.message.includes("Failed to fetch")?Ce="Network error: Unable to connect. Please check your internet connection and try again.":Ce=`Failed to fetch URL: ${Gt.message}. The URL may be inaccessible or blocked.`,console.log("[URL Parse] Error handling complete",{errorMessage:Ce,errorType:Gt.constructor.name,errorMessageDetail:Gt.message}),G(Ce),U(!1),E(!1)}},Tg=async Y=>{if(Y){P(!0),D(null),E(!1);try{const W=await Y.arrayBuffer(),gt=await yE({data:W}).promise,Nt=gt.numPages,Vt=[];for(let Gt=1;Gt<=Nt;Gt++){const se=(await(await gt.getPage(Gt)).getTextContent()).items.map(At=>At.str).join(" ");Vt.push(se)}const xt=Vt.join(`

`);if(!xt.trim()){D("No text content found in PDF. The PDF may be image-based or encrypted."),P(!1);return}t(xt),Ms(xt),E(!0),P(!1)}catch(W){console.error("Failed to parse PDF:",W),D(W instanceof Error?`Failed to parse PDF: ${W.message}`:"Failed to parse PDF. The file may be corrupted or encrypted."),P(!1),E(!1)}}},c0=async Y=>{var gt;const W=((gt=Y.target.files)==null?void 0:gt[0])??null;if(W)if(W.type==="application/pdf"||W.name.toLowerCase().endsWith(".pdf"))await Tg(W);else if(W.type.startsWith("text/")){const Nt=await W.text();t(Nt),Ms(Nt)}else{const Nt=await W.text().catch(()=>"");Nt&&(t(Nt),Ms(Nt))}};return tt.jsxs("div",{className:"app-shell",children:[tt.jsx("header",{className:"app-header",children:tt.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[tt.jsxs("div",{children:[tt.jsx("div",{className:"app-title",children:"Speed Reader"}),tt.jsx("div",{className:"app-subtitle",children:"One word at a time, with a red pivot letter to keep your eyes anchored."})]}),tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>T(!k),style:{marginTop:"4px"},children:" Settings"})]})}),k&&tt.jsxs("section",{className:"card settings-panel",style:{marginBottom:"20px"},children:[tt.jsxs("div",{className:"card-header",children:[tt.jsx("div",{className:"card-title",children:"Settings"}),tt.jsx("button",{className:"btn btn-ghost btn-icon",type:"button",onClick:()=>T(!1),children:""})]}),tt.jsxs("div",{className:"settings-content",children:[tt.jsxs("div",{className:"setting-group",children:[tt.jsx("label",{className:"setting-label",children:"Font Family"}),tt.jsx("div",{className:"font-grid",children:dt.map(Y=>tt.jsx("button",{type:"button",className:`font-option ${nt===Y.value?"active":""}`,onClick:()=>et(Y.value),children:tt.jsx("div",{className:"font-preview",style:{fontFamily:Y.value},children:Y.label})},Y.value))})]}),tt.jsxs("div",{className:"setting-group",children:[tt.jsxs("label",{className:"setting-label",children:["Letter Spacing: ",Ct]}),tt.jsxs("div",{className:"setting-slider-group",children:[tt.jsx("input",{className:"slider range-input",type:"range",min:0,max:10,step:1,value:Ct,onChange:Y=>_t(Number(Y.target.value))}),tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>_t(5),style:{fontSize:"0.8rem",padding:"4px 8px"},children:"Reset"})]})]}),tt.jsxs("div",{className:"setting-group",children:[tt.jsx("label",{className:"setting-label",children:"Pivot Letter Color"}),tt.jsxs("div",{className:"setting-color-group",children:[tt.jsx("input",{className:"setting-color-input",type:"color",value:wt,onChange:Y=>kt(Y.target.value)}),tt.jsx("input",{className:"setting-color-text",type:"text",value:wt,onChange:Y=>kt(Y.target.value),placeholder:"#ff4e4e"}),tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>kt("#ff4e4e"),style:{fontSize:"0.8rem",padding:"4px 8px"},children:"Reset"})]})]})]})]}),tt.jsxs("main",{className:"layout",children:[tt.jsxs("section",{className:"card",children:[tt.jsxs("div",{className:"card-header",children:[tt.jsx("div",{className:"card-title",children:"Reader"}),tt.jsx("div",{className:"card-badge",children:Et?`${p+1} / ${r.length} words`:"Idle"})]}),tt.jsxs("div",{className:"reader-screen",children:[tt.jsx("div",{className:"word-display",style:{fontFamily:nt,letterSpacing:`${V(Ct)}em`},children:Et?tt.jsxs("div",{className:"word-line",style:{transform:`translateX(${Mt}px)`},children:[tt.jsx("span",{ref:H,className:"word-left",children:Uo.left}),tt.jsx("span",{ref:lt,className:"pivot-letter",style:{color:wt},children:Uo.pivot}),tt.jsx("span",{ref:Tt,className:"word-right",children:Uo.right})]}):tt.jsx("span",{className:"muted",children:"Paste text, choose a file, or load a URL to begin."})}),tt.jsx("div",{className:"pivot-guide"}),tt.jsxs("div",{className:"controls-row",children:[tt.jsxs("div",{className:"wpm-group",children:[tt.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>ad(-1),disabled:!Et||p===0,type:"button",children:""}),tt.jsx("button",{className:"btn btn-primary",onClick:od,disabled:!Et,type:"button",children:h?"Pause":"Play"}),tt.jsx("button",{className:"btn btn-icon btn-ghost",onClick:()=>ad(1),disabled:!Et||p>=r.length-1,type:"button",children:""}),tt.jsx("button",{className:"btn btn-ghost",onClick:Cg,disabled:!Et,type:"button",children:"Restart"})]}),tt.jsxs("div",{className:"wpm-group",children:[tt.jsxs("span",{className:"wpm-value",children:[l," wpm"]}),tt.jsx("input",{className:"slider range-input",type:"range",min:150,max:900,step:10,value:l,onChange:Y=>u(Number(Y.target.value))})]})]}),tt.jsxs("div",{className:"controls-row",children:[tt.jsxs("div",{className:"wpm-group",children:[tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>ld(-1),disabled:!Et,children:" Paragraph"}),tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>ld(1),disabled:!Et,children:" Paragraph"})]}),tt.jsx("div",{className:"wpm-group",children:tt.jsx("button",{className:"btn btn-ghost",type:"button",onClick:()=>S(Y=>!Y),disabled:!Et,children:v?"Hide context":"Show paragraph"})})]})]})]}),tt.jsxs("section",{className:"card",children:[tt.jsx("div",{className:"card-header",children:tt.jsx("div",{className:"card-title",children:"Input"})}),tt.jsx(tt.Fragment,{children:C?tt.jsxs("div",{style:{padding:"20px 0",textAlign:"center"},children:[tt.jsx("p",{className:"input-hint",style:{marginBottom:"12px"},children:"Content loaded. Ready to read."}),tt.jsx("button",{className:"btn btn-primary",type:"button",onClick:jo,children:"New Input"})]}):tt.jsxs(tt.Fragment,{children:[I?tt.jsx("div",{style:{padding:"12px 0",textAlign:"center"},children:tt.jsx("p",{className:"input-hint",children:"Fetching and parsing URL content... This may take a moment."})}):null,L?tt.jsx("div",{style:{padding:"12px 0",textAlign:"center"},children:tt.jsx("p",{className:"input-hint",children:"Processing PDF... This may take a moment for large files."})}):null,$?tt.jsx("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c33"},children:$}):null,M?tt.jsx("div",{style:{padding:"12px",marginBottom:"12px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"4px",color:"#c33"},children:M}):null,tt.jsx("textarea",{ref:bt,className:"text-input",placeholder:"Paste book text, chapter, or article content here (or paste a URL by itself to auto-load)",value:g,onChange:Y=>t(Y.target.value),onBlur:_g,onPaste:cd,disabled:L||I}),tt.jsxs("div",{className:"input-footer",children:[tt.jsx("span",{className:"input-hint",children:"Paste text to automatically update the reader. If you paste a URL by itself, it will be fetched and parsed automatically."}),tt.jsxs("label",{className:"file-input",children:[tt.jsx("span",{children:"Or open a text / PDF file "}),tt.jsx("input",{type:"file",accept:".txt,application/pdf",onChange:c0,disabled:L||I})]})]})]})}),v&&zo&&tt.jsxs("div",{style:{marginTop:14},children:[tt.jsxs("div",{className:"paragraph-context",children:[tt.jsxs("span",{children:[zo.before," "]}),tt.jsx("strong",{children:zo.active}),tt.jsxs("span",{children:[" ",zo.after]})]}),tt.jsxs("div",{className:"context-meta",children:[tt.jsxs("span",{children:["Paragraph ",zo.paragraphIndex+1," of"," ",e.length]}),tt.jsxs("span",{children:["Word ",p+1," of ",r.length]})]})]})]})]})]})};pk.createRoot(document.getElementById("root")).render(tt.jsx(ak.StrictMode,{children:tt.jsx(SP,{})}));
